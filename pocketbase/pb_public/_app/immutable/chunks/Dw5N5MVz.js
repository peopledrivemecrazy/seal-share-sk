/*! OpenPGP.js v6.1.0 - 2025-01-30 - this is LGPL licensed code, see LICENSE/our website https://openpgpjs.org/ for more information. */const Lt=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function R3(i,t){return t.forEach(function(e){e&&typeof e!="string"&&!Array.isArray(e)&&Object.keys(e).forEach(function(r){if(r!=="default"&&!(r in i)){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(i,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})}),Object.freeze(i)}const qr=Symbol("doneWritingPromise"),B1=Symbol("doneWritingResolve"),I1=Symbol("doneWritingReject"),fi=Symbol("readingIndex");class ie extends Array{constructor(){super(),Object.setPrototypeOf(this,ie.prototype),this[qr]=new Promise((t,e)=>{this[B1]=t,this[I1]=e}),this[qr].catch(()=>{})}}function vt(i){return i&&i.getReader&&Array.isArray(i)}function ki(i){if(!vt(i)){const t=i.getWriter(),e=t.releaseLock;return t.releaseLock=()=>{t.closed.catch(function(){}),e.call(t)},t}this.stream=i}function Zt(i){if(vt(i))return"array";if(Lt.ReadableStream&&Lt.ReadableStream.prototype.isPrototypeOf(i))return"web";if(i&&!(Lt.ReadableStream&&i instanceof Lt.ReadableStream)&&typeof i._read=="function"&&typeof i._readableState=="object")throw Error("Native Node streams are no longer supported: please manually convert the stream to a WebStream, using e.g. `stream.Readable.toWeb`");return!(!i||!i.getReader)&&"web-like"}function Nn(i){return Uint8Array.prototype.isPrototypeOf(i)}function S1(i){if(i.length===1)return i[0];let t=0;for(let n=0;n<i.length;n++){if(!Nn(i[n]))throw Error("concatUint8Array: Data must be in the form of a Uint8Array");t+=i[n].length}const e=new Uint8Array(t);let r=0;return i.forEach(function(n){e.set(n,r),r+=n.length}),e}ie.prototype.getReader=function(){return this[fi]===void 0&&(this[fi]=0),{read:async()=>(await this[qr],this[fi]===this.length?{value:void 0,done:!0}:{value:this[this[fi]++],done:!1})}},ie.prototype.readToEnd=async function(i){await this[qr];const t=i(this.slice(this[fi]));return this.length=0,t},ie.prototype.clone=function(){const i=new ie;return i[qr]=this[qr].then(()=>{i.push(...this)}),i},ki.prototype.write=async function(i){this.stream.push(i)},ki.prototype.close=async function(){this.stream[B1]()},ki.prototype.abort=async function(i){return this.stream[I1](i),i},ki.prototype.releaseLock=function(){},typeof Lt.process=="object"&&Lt.process.versions;const Ya=new WeakSet,ut=Symbol("externalBuffer");function de(i){if(this.stream=i,i[ut]&&(this[ut]=i[ut].slice()),vt(i)){const e=i.getReader();return this._read=e.read.bind(e),this._releaseLock=()=>{},void(this._cancel=()=>{})}if(Zt(i)){const e=i.getReader();return this._read=e.read.bind(e),this._releaseLock=()=>{e.closed.catch(function(){}),e.releaseLock()},void(this._cancel=e.cancel.bind(e))}let t=!1;this._read=async()=>t||Ya.has(i)?{value:void 0,done:!0}:(t=!0,{value:i,done:!1}),this._releaseLock=()=>{if(t)try{Ya.add(i)}catch{}}}function Aa(i){return Zt(i)?i:new ReadableStream({start(t){t.enqueue(i),t.close()}})}function C1(i){if(Zt(i))return i;const t=new ie;return(async()=>{const e=Xt(t);await e.write(i),await e.close()})(),t}function qt(i){return i.some(t=>Zt(t)&&!vt(t))?function(t){t=t.map(Aa);const e=U1(async function(s){await Promise.all(n.map(a=>Ms(a,s)))});let r=Promise.resolve();const n=t.map((s,a)=>pr(s,(o,c)=>(r=r.then(()=>Cr(o,e.writable,{preventClose:a!==t.length-1})),r)));return e.readable}(i):i.some(t=>vt(t))?function(t){const e=new ie;let r=Promise.resolve();return t.forEach((n,s)=>(r=r.then(()=>Cr(n,e,{preventClose:s!==t.length-1})),r)),e}(i):typeof i[0]=="string"?i.join(""):S1(i)}async function Cr(i,t,{preventClose:e=!1,preventAbort:r=!1,preventCancel:n=!1}={}){if(Zt(i)&&!vt(i)){i=Aa(i);try{if(i[ut]){const o=Xt(t);for(let c=0;c<i[ut].length;c++)await o.ready,await o.write(i[ut][c]);o.releaseLock()}await i.pipeTo(t,{preventClose:e,preventAbort:r,preventCancel:n})}catch{}return}const s=_e(i=C1(i)),a=Xt(t);try{for(;;){await a.ready;const{done:o,value:c}=await s.read();if(o){e||await a.close();break}await a.write(c)}}catch(o){r||await a.abort(o)}finally{s.releaseLock(),a.releaseLock()}}function K1(i,t){const e=new TransformStream(t);return Cr(i,e.writable),e.readable}function U1(i){let t,e,r,n=!1,s=!1;return{readable:new ReadableStream({start(a){r=a},pull(){t?t():n=!0},async cancel(a){s=!0,i&&await i(a),e&&e(a)}},{highWaterMark:0}),writable:new WritableStream({write:async function(a){if(s)throw Error("Stream is cancelled");r.enqueue(a),n?n=!1:(await new Promise((o,c)=>{t=o,e=c}),t=null,e=null)},close:r.close.bind(r),abort:r.error.bind(r)})}}function At(i,t=()=>{},e=()=>{}){if(vt(i)){const s=new ie;return(async()=>{const a=Xt(s);try{const o=await It(i),c=t(o),u=e();let h;h=c!==void 0&&u!==void 0?qt([c,u]):c!==void 0?c:u,await a.write(h),await a.close()}catch(o){await a.abort(o)}})(),s}if(Zt(i))return K1(i,{async transform(s,a){try{const o=await t(s);o!==void 0&&a.enqueue(o)}catch(o){a.error(o)}},async flush(s){try{const a=await e();a!==void 0&&s.enqueue(a)}catch(a){s.error(a)}}});const r=t(i),n=e();return r!==void 0&&n!==void 0?qt([r,n]):r!==void 0?r:n}function pr(i,t){if(Zt(i)&&!vt(i)){let r;const n=new TransformStream({start(o){r=o}}),s=Cr(i,n.writable),a=U1(async function(o){r.error(o),await s,await new Promise(setTimeout)});return t(n.readable,a.writable),a.readable}i=C1(i);const e=new ie;return t(i,e),e}function On(i,t){let e;const r=pr(i,(n,s)=>{const a=_e(n);a.remainder=()=>(a.releaseLock(),Cr(n,s),r),e=t(a)});return e}function Kr(i){if(vt(i))return i.clone();if(Zt(i)){const t=function(e){if(vt(e))throw Error("ArrayStream cannot be tee()d, use clone() instead");if(Zt(e)){const r=Aa(e).tee();return r[0][ut]=r[1][ut]=e[ut],r}return[Qt(e),Qt(e)]}(i);return D1(i,t[0]),t[1]}return Qt(i)}function Qi(i){return vt(i)?Kr(i):Zt(i)?new ReadableStream({start(t){const e=pr(i,async(r,n)=>{const s=_e(r),a=Xt(n);try{for(;;){await a.ready;const{done:o,value:c}=await s.read();if(o){try{t.close()}catch{}return void await a.close()}try{t.enqueue(c)}catch{}await a.write(c)}}catch(o){t.error(o),await a.abort(o)}});D1(i,e)}}):Qt(i)}function D1(i,t){Object.entries(Object.getOwnPropertyDescriptors(i.constructor.prototype)).forEach(([e,r])=>{e!=="constructor"&&(r.value?r.value=r.value.bind(t):r.get=r.get.bind(t),Object.defineProperty(i,e,r))})}function Qt(i,t=0,e=1/0){if(vt(i))throw Error("Not implemented");if(Zt(i)){if(t>=0&&e>=0){let r=0;return K1(i,{transform(n,s){r<e?(r+n.length>=t&&s.enqueue(Qt(n,Math.max(t-r,0),e-r)),r+=n.length):s.terminate()}})}if(t<0&&(e<0||e===1/0)){let r=[];return At(i,n=>{n.length>=-t?r=[n]:r.push(n)},()=>Qt(qt(r),t,e))}if(t===0&&e<0){let r;return At(i,n=>{const s=r?qt([r,n]):n;if(s.length>=-e)return r=Qt(s,e),Qt(s,t,e);r=s})}return console.warn(`stream.slice(input, ${t}, ${e}) not implemented efficiently.`),dr(async()=>Qt(await It(i),t,e))}return i[ut]&&(i=qt(i[ut].concat([i]))),Nn(i)?i.subarray(t,e===1/0?i.length:e):i.slice(t,e)}async function It(i,t=qt){return vt(i)?i.readToEnd(t):Zt(i)?_e(i).readToEnd(t):i}async function Ms(i,t){if(Zt(i)){if(i.cancel){const e=await i.cancel(t);return await new Promise(setTimeout),e}if(i.destroy)return i.destroy(t),await new Promise(setTimeout),t}}function dr(i){const t=new ie;return(async()=>{const e=Xt(t);try{await e.write(await i()),await e.close()}catch(r){await e.abort(r)}})(),t}function _e(i){return new de(i)}function Xt(i){return new ki(i)}de.prototype.read=async function(){return this[ut]&&this[ut].length?{done:!1,value:this[ut].shift()}:this._read()},de.prototype.releaseLock=function(){this[ut]&&(this.stream[ut]=this[ut]),this._releaseLock()},de.prototype.cancel=function(i){return this._cancel(i)},de.prototype.readLine=async function(){let i,t=[];for(;!i;){let{done:e,value:r}=await this.read();if(r+="",e)return t.length?qt(t):void 0;const n=r.indexOf(`
`)+1;n&&(i=qt(t.concat(r.substr(0,n))),t=[]),n!==r.length&&t.push(r.substr(n))}return this.unshift(...t),i},de.prototype.readByte=async function(){const{done:i,value:t}=await this.read();if(i)return;const e=t[0];return this.unshift(Qt(t,1)),e},de.prototype.readBytes=async function(i){const t=[];let e=0;for(;;){const{done:r,value:n}=await this.read();if(r)return t.length?qt(t):void 0;if(t.push(n),e+=n.length,e>=i){const s=qt(t);return this.unshift(Qt(s,i)),Qt(s,0,i)}}},de.prototype.peekBytes=async function(i){const t=await this.readBytes(i);return this.unshift(t),t},de.prototype.unshift=function(...i){this[ut]||(this[ut]=[]),i.length===1&&Nn(i[0])&&this[ut].length&&i[0].length&&this[ut][0].byteOffset>=i[0].length?this[ut][0]=new Uint8Array(this[ut][0].buffer,this[ut][0].byteOffset-i[0].length,this[ut][0].byteLength+i[0].length):this[ut].unshift(...i.filter(t=>t&&t.length))},de.prototype.readToEnd=async function(i=qt){const t=[];for(;;){const{done:e,value:r}=await this.read();if(e)break;t.push(r)}return i(t)};const yi=Symbol("byValue");var l={curve:{nistP256:"nistP256",p256:"nistP256",nistP384:"nistP384",p384:"nistP384",nistP521:"nistP521",p521:"nistP521",secp256k1:"secp256k1",ed25519Legacy:"ed25519Legacy",ed25519:"ed25519Legacy",curve25519Legacy:"curve25519Legacy",curve25519:"curve25519Legacy",brainpoolP256r1:"brainpoolP256r1",brainpoolP384r1:"brainpoolP384r1",brainpoolP512r1:"brainpoolP512r1"},s2k:{simple:0,salted:1,iterated:3,argon2:4,gnu:101},publicKey:{rsaEncryptSign:1,rsaEncrypt:2,rsaSign:3,elgamal:16,dsa:17,ecdh:18,ecdsa:19,eddsaLegacy:22,aedh:23,aedsa:24,x25519:25,x448:26,ed25519:27,ed448:28},symmetric:{idea:1,tripledes:2,cast5:3,blowfish:4,aes128:7,aes192:8,aes256:9,twofish:10},compression:{uncompressed:0,zip:1,zlib:2,bzip2:3},hash:{md5:1,sha1:2,ripemd:3,sha256:8,sha384:9,sha512:10,sha224:11,sha3_256:12,sha3_512:14},webHash:{"SHA-1":2,"SHA-256":8,"SHA-384":9,"SHA-512":10},aead:{eax:1,ocb:2,gcm:3,experimentalGCM:100},packet:{publicKeyEncryptedSessionKey:1,signature:2,symEncryptedSessionKey:3,onePassSignature:4,secretKey:5,publicKey:6,secretSubkey:7,compressedData:8,symmetricallyEncryptedData:9,marker:10,literalData:11,trust:12,userID:13,publicSubkey:14,userAttribute:17,symEncryptedIntegrityProtectedData:18,modificationDetectionCode:19,aeadEncryptedData:20,padding:21},literal:{binary:98,text:116,utf8:117,mime:109},signature:{binary:0,text:1,standalone:2,certGeneric:16,certPersona:17,certCasual:18,certPositive:19,certRevocation:48,subkeyBinding:24,keyBinding:25,key:31,keyRevocation:32,subkeyRevocation:40,timestamp:64,thirdParty:80},signatureSubpacket:{signatureCreationTime:2,signatureExpirationTime:3,exportableCertification:4,trustSignature:5,regularExpression:6,revocable:7,keyExpirationTime:9,placeholderBackwardsCompatibility:10,preferredSymmetricAlgorithms:11,revocationKey:12,issuerKeyID:16,notationData:20,preferredHashAlgorithms:21,preferredCompressionAlgorithms:22,keyServerPreferences:23,preferredKeyServer:24,primaryUserID:25,policyURI:26,keyFlags:27,signersUserID:28,reasonForRevocation:29,features:30,signatureTarget:31,embeddedSignature:32,issuerFingerprint:33,preferredAEADAlgorithms:34,preferredCipherSuites:39},keyFlags:{certifyKeys:1,signData:2,encryptCommunication:4,encryptStorage:8,splitPrivateKey:16,authentication:32,sharedPrivateKey:128},armor:{multipartSection:0,multipartLast:1,signed:2,message:3,publicKey:4,privateKey:5,signature:6},reasonForRevocation:{noReason:0,keySuperseded:1,keyCompromised:2,keyRetired:3,userIDInvalid:32},features:{modificationDetection:1,aead:2,v5Keys:4,seipdv2:8},write:function(i,t){if(typeof t=="number"&&(t=this.read(i,t)),i[t]!==void 0)return i[t];throw Error("Invalid enum value.")},read:function(i,t){if(i[yi]||(i[yi]=[],Object.entries(i).forEach(([e,r])=>{i[yi][r]=e})),i[yi][t]!==void 0)return i[yi][t];throw Error("Invalid enum value.")}},O={preferredHashAlgorithm:l.hash.sha512,preferredSymmetricAlgorithm:l.symmetric.aes256,preferredCompressionAlgorithm:l.compression.uncompressed,aeadProtect:!1,parseAEADEncryptedV4KeysAsLegacy:!1,preferredAEADAlgorithm:l.aead.gcm,aeadChunkSizeByte:12,v6Keys:!1,enableParsingV5Entities:!1,s2kType:l.s2k.iterated,s2kIterationCountByte:224,s2kArgon2Params:{passes:3,parallelism:4,memoryExponent:16},allowUnauthenticatedMessages:!1,allowUnauthenticatedStream:!1,minRSABits:2047,passwordCollisionCheck:!1,allowInsecureDecryptionWithSigningKeys:!1,allowInsecureVerificationWithReformattedKeys:!1,allowMissingKeyFlags:!1,constantTimePKCS1Decryption:!1,constantTimePKCS1DecryptionSupportedSymmetricAlgorithms:new Set([l.symmetric.aes128,l.symmetric.aes192,l.symmetric.aes256]),ignoreUnsupportedPackets:!0,ignoreMalformedPackets:!1,additionalAllowedPackets:[],showVersion:!1,showComment:!1,versionString:"OpenPGP.js 6.1.0",commentString:"https://openpgpjs.org",maxUserIDLength:5120,knownNotations:[],nonDeterministicSignaturesViaNotation:!0,useEllipticFallback:!0,rejectHashAlgorithms:new Set([l.hash.md5,l.hash.ripemd]),rejectMessageHashAlgorithms:new Set([l.hash.md5,l.hash.ripemd,l.hash.sha1]),rejectPublicKeyAlgorithms:new Set([l.publicKey.elgamal,l.publicKey.dsa]),rejectCurves:new Set([l.curve.secp256k1])};const Za=(()=>{try{return!1}catch{}return!1})(),p={isString:function(i){return typeof i=="string"||i instanceof String},nodeRequire:()=>{},isArray:function(i){return i instanceof Array},isUint8Array:Nn,isStream:Zt,getNobleCurve:async(i,t)=>{if(!O.useEllipticFallback)throw Error("This curve is only supported in the full build of OpenPGP.js");const{nobleCurves:e}=await Promise.resolve().then(function(){return k2});switch(i){case l.publicKey.ecdh:case l.publicKey.ecdsa:{const r=e.get(t);if(!r)throw Error("Unsupported curve");return r}case l.publicKey.x448:return e.get("x448");case l.publicKey.ed448:return e.get("ed448");default:throw Error("Unsupported curve")}},readNumber:function(i){let t=0;for(let e=0;e<i.length;e++)t+=256**e*i[i.length-1-e];return t},writeNumber:function(i,t){const e=new Uint8Array(t);for(let r=0;r<t;r++)e[r]=i>>8*(t-r-1)&255;return e},readDate:function(i){const t=p.readNumber(i);return new Date(1e3*t)},writeDate:function(i){const t=Math.floor(i.getTime()/1e3);return p.writeNumber(t,4)},normalizeDate:function(i=Date.now()){return i===null||i===1/0?i:new Date(1e3*Math.floor(+i/1e3))},readMPI:function(i){const t=(i[0]<<8|i[1])+7>>>3;return p.readExactSubarray(i,2,2+t)},readExactSubarray:function(i,t,e){if(i.length<e-t)throw Error("Input array too short");return i.subarray(t,e)},leftPad(i,t){if(i.length>t)throw Error("Input array too long");const e=new Uint8Array(t),r=t-i.length;return e.set(i,r),e},uint8ArrayToMPI:function(i){const t=p.uint8ArrayBitLength(i);if(t===0)throw Error("Zero MPI");const e=i.subarray(i.length-Math.ceil(t/8)),r=new Uint8Array([(65280&t)>>8,255&t]);return p.concatUint8Array([r,e])},uint8ArrayBitLength:function(i){let t;for(t=0;t<i.length&&i[t]===0;t++);if(t===i.length)return 0;const e=i.subarray(t);return 8*(e.length-1)+p.nbits(e[0])},hexToUint8Array:function(i){const t=new Uint8Array(i.length>>1);for(let e=0;e<i.length>>1;e++)t[e]=parseInt(i.substr(e<<1,2),16);return t},uint8ArrayToHex:function(i){const t="0123456789abcdef";let e="";return i.forEach(r=>{e+=t[r>>4]+t[15&r]}),e},stringToUint8Array:function(i){return At(i,t=>{if(!p.isString(t))throw Error("stringToUint8Array: Data must be in the form of a string");const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e})},uint8ArrayToString:function(i){const t=[],r=(i=new Uint8Array(i)).length;for(let n=0;n<r;n+=16384)t.push(String.fromCharCode.apply(String,i.subarray(n,n+16384<r?n+16384:r)));return t.join("")},encodeUTF8:function(i){const t=new TextEncoder("utf-8");function e(r,n=!1){return t.encode(r,{stream:!n})}return At(i,e,()=>e("",!0))},decodeUTF8:function(i){const t=new TextDecoder("utf-8");function e(r,n=!1){return t.decode(r,{stream:!n})}return At(i,e,()=>e(new Uint8Array,!0))},concat:qt,concatUint8Array:S1,equalsUint8Array:function(i,t){if(!p.isUint8Array(i)||!p.isUint8Array(t))throw Error("Data must be in the form of a Uint8Array");if(i.length!==t.length)return!1;for(let e=0;e<i.length;e++)if(i[e]!==t[e])return!1;return!0},writeChecksum:function(i){let t=0;for(let e=0;e<i.length;e++)t=t+i[e]&65535;return p.writeNumber(t,2)},printDebug:function(i){Za&&console.log("[OpenPGP.js debug]",i)},printDebugError:function(i){Za&&console.error("[OpenPGP.js debug]",i)},nbits:function(i){let t=1,e=i>>>16;return e!==0&&(i=e,t+=16),e=i>>8,e!==0&&(i=e,t+=8),e=i>>4,e!==0&&(i=e,t+=4),e=i>>2,e!==0&&(i=e,t+=2),e=i>>1,e!==0&&(i=e,t+=1),t},double:function(i){const t=new Uint8Array(i.length),e=i.length-1;for(let r=0;r<e;r++)t[r]=i[r]<<1^i[r+1]>>7;return t[e]=i[e]<<1^135*(i[0]>>7),t},shiftRight:function(i,t){if(t)for(let e=i.length-1;e>=0;e--)i[e]>>=t,e>0&&(i[e]|=i[e-1]<<8-t);return i},getWebCrypto:function(){var t;const i=Lt!==void 0&&Lt.crypto&&Lt.crypto.subtle||((t=this.getNodeCrypto())==null?void 0:t.webcrypto.subtle);if(!i)throw Error("The WebCrypto API is not available");return i},getNodeCrypto:function(){return this.nodeRequire("crypto")},getNodeZlib:function(){return this.nodeRequire("zlib")},getNodeBuffer:function(){return(this.nodeRequire("buffer")||{}).Buffer},getHardwareConcurrency:function(){return typeof navigator<"u"?navigator.hardwareConcurrency||1:this.nodeRequire("os").cpus().length},isEmailAddress:function(i){return p.isString(i)?/^[^\p{C}\p{Z}@<>\\]+@[^\p{C}\p{Z}@<>\\]+[^\p{C}\p{Z}\p{P}]$/u.test(i):!1},canonicalizeEOL:function(i){let t=!1;return At(i,e=>{let r;t&&(e=p.concatUint8Array([new Uint8Array([13]),e])),e[e.length-1]===13?(t=!0,e=e.subarray(0,-1)):t=!1;const n=[];for(let o=0;r=e.indexOf(10,o)+1,r;o=r)e[r-2]!==13&&n.push(r);if(!n.length)return e;const s=new Uint8Array(e.length+n.length);let a=0;for(let o=0;o<n.length;o++){const c=e.subarray(n[o-1]||0,n[o]);s.set(c,a),a+=c.length,s[a-1]=13,s[a]=10,a++}return s.set(e.subarray(n[n.length-1]||0),a),s},()=>t?new Uint8Array([13]):void 0)},nativeEOL:function(i){let t=!1;return At(i,e=>{let r;(e=t&&e[0]!==10?p.concatUint8Array([new Uint8Array([13]),e]):new Uint8Array(e))[e.length-1]===13?(t=!0,e=e.subarray(0,-1)):t=!1;let n=0;for(let s=0;s!==e.length;s=r){r=e.indexOf(13,s)+1,r||(r=e.length);const a=r-(e[r]===10?1:0);s&&e.copyWithin(n,s,a),n+=a-s}return e.subarray(0,n)},()=>t?new Uint8Array([13]):void 0)},removeTrailingSpaces:function(i){return i.split(`
`).map(t=>{let e=t.length-1;for(;e>=0&&(t[e]===" "||t[e]==="	"||t[e]==="\r");e--);return t.substr(0,e+1)}).join(`
`)},wrapError:function(i,t){if(!t)return Error(i);try{t.message=i+": "+t.message}catch{}return t},constructAllowedPackets:function(i){const t={};return i.forEach(e=>{if(!e.tag)throw Error("Invalid input: expected a packet class");t[e.tag]=e}),t},anyPromise:function(i){return new Promise(async(t,e)=>{let r;await Promise.all(i.map(async n=>{try{t(await n)}catch(s){r=s}})),e(r)})},selectUint8Array:function(i,t,e){const r=Math.max(t.length,e.length),n=new Uint8Array(r);let s=0;for(let a=0;a<n.length;a++)n[a]=t[a]&256-i|e[a]&255+i,s+=i&a<t.length|1-i&a<e.length;return n.subarray(0,s)},selectUint8:function(i,t,e){return t&256-i|e&255+i},isAES:function(i){return i===l.symmetric.aes128||i===l.symmetric.aes192||i===l.symmetric.aes256}},ss=p.getNodeBuffer();let bn,kn;function Me(i){let t=new Uint8Array;return At(i,e=>{t=p.concatUint8Array([t,e]);const r=[],n=Math.floor(t.length/45),s=45*n,a=bn(t.subarray(0,s));for(let o=0;o<n;o++)r.push(a.substr(60*o,60)),r.push(`
`);return t=t.subarray(s),r.join("")},()=>t.length?bn(t)+`
`:"")}function P1(i){let t="";return At(i,e=>{t+=e;let r=0;const n=[" ","	","\r",`
`];for(let o=0;o<n.length;o++){const c=n[o];for(let u=t.indexOf(c);u!==-1;u=t.indexOf(c,u+1))r++}let s=t.length;for(;s>0&&(s-r)%4!=0;s--)n.includes(t[s])&&r--;const a=kn(t.substr(0,s));return t=t.substr(s),a},()=>kn(t))}function fe(i){return P1(i.replace(/-/g,"+").replace(/_/g,"/"))}function Nt(i,t){let e=Me(i).replace(/[\r\n]/g,"");return e=e.replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/[=]/g,""),e}function T3(i){const t=i.match(/^-----BEGIN PGP (MESSAGE, PART \d+\/\d+|MESSAGE, PART \d+|SIGNED MESSAGE|MESSAGE|PUBLIC KEY BLOCK|PRIVATE KEY BLOCK|SIGNATURE)-----$/m);if(!t)throw Error("Unknown ASCII armor type");return/MESSAGE, PART \d+\/\d+/.test(t[1])?l.armor.multipartSection:/MESSAGE, PART \d+/.test(t[1])?l.armor.multipartLast:/SIGNED MESSAGE/.test(t[1])?l.armor.signed:/MESSAGE/.test(t[1])?l.armor.message:/PUBLIC KEY BLOCK/.test(t[1])?l.armor.publicKey:/PRIVATE KEY BLOCK/.test(t[1])?l.armor.privateKey:/SIGNATURE/.test(t[1])?l.armor.signature:void 0}function Ar(i,t){let e="";return t.showVersion&&(e+="Version: "+t.versionString+`
`),t.showComment&&(e+="Comment: "+t.commentString+`
`),i&&(e+="Comment: "+i+`
`),e+=`
`,e}function wr(i){const t=function(e){let r=13501623;return At(e,n=>{const s=L3?Math.floor(n.length/4):0,a=new Uint32Array(n.buffer,n.byteOffset,s);for(let o=0;o<s;o++)r^=a[o],r=Kt[0][r>>24&255]^Kt[1][r>>16&255]^Kt[2][r>>8&255]^Kt[3][255&r];for(let o=4*s;o<n.length;o++)r=r>>8^Kt[0][255&r^n[o]]},()=>new Uint8Array([r,r>>8,r>>16]))}(i);return Me(t)}ss?(bn=i=>ss.from(i).toString("base64"),kn=i=>{const t=ss.from(i,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}):(bn=i=>btoa(p.uint8ArrayToString(i)),kn=i=>p.stringToUint8Array(atob(i)));const Kt=[Array(255),Array(255),Array(255),Array(255)];for(let i=0;i<=255;i++){let t=i<<16;for(let e=0;e<8;e++)t=t<<1^(8388608&t?8801531:0);Kt[0][i]=(16711680&t)>>16|65280&t|(255&t)<<16}for(let i=0;i<=255;i++)Kt[1][i]=Kt[0][i]>>8^Kt[0][255&Kt[0][i]];for(let i=0;i<=255;i++)Kt[2][i]=Kt[1][i]>>8^Kt[0][255&Kt[1][i]];for(let i=0;i<=255;i++)Kt[3][i]=Kt[2][i]>>8^Kt[0][255&Kt[2][i]];const L3=function(){const i=new ArrayBuffer(2);return new DataView(i).setInt16(0,255,!0),new Int16Array(i)[0]===255}();function Wa(i){for(let t=0;t<i.length;t++)/^([^\s:]|[^\s:][^:]*[^\s:]): .+$/.test(i[t])||p.printDebugError(Error("Improperly formatted armor header: "+i[t])),/^(Version|Comment|MessageID|Hash|Charset): .+$/.test(i[t])||p.printDebugError(Error("Unknown header: "+i[t]))}function M3(i){let t=i;const e=i.lastIndexOf("=");return e>=0&&e!==i.length-1&&(t=i.slice(0,e)),t}function _i(i){return new Promise(async(t,e)=>{try{const r=/^-----[^-]+-----$/m,n=/^[ \f\r\t\u00a0\u2000-\u200a\u202f\u205f\u3000]*$/;let s;const a=[];let o,c,u=a,h=[];const f=P1(pr(i,async(y,g)=>{const A=_e(y);try{for(;;){let w=await A.readLine();if(w===void 0)throw Error("Misformed armored text");if(w=p.removeTrailingSpaces(w.replace(/[\r\n]/g,"")),s)if(o)c||s!==l.armor.signed||(r.test(w)?(h=h.join(`\r
`),c=!0,Wa(u),u=[],o=!1):h.push(w.replace(/^- /,"")));else if(r.test(w)&&e(Error("Mandatory blank line missing between armor headers and armor data")),n.test(w)){if(Wa(u),o=!0,c||s!==l.armor.signed){t({text:h,data:f,headers:a,type:s});break}}else u.push(w);else r.test(w)&&(s=T3(w))}}catch(w){return void e(w)}const d=Xt(g);try{for(;;){await d.ready;const{done:w,value:k}=await A.read();if(w)throw Error("Misformed armored text");const v=k+"";if(v.indexOf("=")!==-1||v.indexOf("-")!==-1){let b=await A.readToEnd();b.length||(b=""),b=v+b,b=p.removeTrailingSpaces(b.replace(/\r/g,""));const E=b.split(r);if(E.length===1)throw Error("Misformed armored text");const U=M3(E[0].slice(0,-1));await d.write(U);break}await d.write(v)}await d.ready,await d.close()}catch(w){await d.abort(w)}}))}catch(r){e(r)}}).then(async t=>(vt(t.data)&&(t.data=await It(t.data)),t))}function ji(i,t,e,r,n,s=!1,a=O){let o,c;i===l.armor.signed&&(o=t.text,c=t.hash,t=t.data);const u=s&&Qi(t),h=[];switch(i){case l.armor.multipartSection:h.push("-----BEGIN PGP MESSAGE, PART "+e+"/"+r+`-----
`),h.push(Ar(n,a)),h.push(Me(t)),u&&h.push("=",wr(u)),h.push("-----END PGP MESSAGE, PART "+e+"/"+r+`-----
`);break;case l.armor.multipartLast:h.push("-----BEGIN PGP MESSAGE, PART "+e+`-----
`),h.push(Ar(n,a)),h.push(Me(t)),u&&h.push("=",wr(u)),h.push("-----END PGP MESSAGE, PART "+e+`-----
`);break;case l.armor.signed:h.push(`-----BEGIN PGP SIGNED MESSAGE-----
`),h.push(c?`Hash: ${c}

`:`
`),h.push(o.replace(/^-/gm,"- -")),h.push(`
-----BEGIN PGP SIGNATURE-----
`),h.push(Ar(n,a)),h.push(Me(t)),u&&h.push("=",wr(u)),h.push(`-----END PGP SIGNATURE-----
`);break;case l.armor.message:h.push(`-----BEGIN PGP MESSAGE-----
`),h.push(Ar(n,a)),h.push(Me(t)),u&&h.push("=",wr(u)),h.push(`-----END PGP MESSAGE-----
`);break;case l.armor.publicKey:h.push(`-----BEGIN PGP PUBLIC KEY BLOCK-----
`),h.push(Ar(n,a)),h.push(Me(t)),u&&h.push("=",wr(u)),h.push(`-----END PGP PUBLIC KEY BLOCK-----
`);break;case l.armor.privateKey:h.push(`-----BEGIN PGP PRIVATE KEY BLOCK-----
`),h.push(Ar(n,a)),h.push(Me(t)),u&&h.push("=",wr(u)),h.push(`-----END PGP PRIVATE KEY BLOCK-----
`);break;case l.armor.signature:h.push(`-----BEGIN PGP SIGNATURE-----
`),h.push(Ar(n,a)),h.push(Me(t)),u&&h.push("=",wr(u)),h.push(`-----END PGP SIGNATURE-----
`)}return p.concat(h)}const Jt=BigInt(0),Zr=BigInt(1);function V(i){const t="0123456789ABCDEF";let e="";return i.forEach(r=>{e+=t[r>>4]+t[15&r]}),BigInt("0x0"+e)}function tt(i,t){const e=i%t;return e<Jt?e+t:e}function Ut(i,t,e){if(e===Jt)throw Error("Modulo cannot be zero");if(e===Zr)return BigInt(0);if(t<Jt)throw Error("Unsopported negative exponent");let r=t,n=i;n%=e;let s=BigInt(1);for(;r>Jt;){const a=r&Zr;r>>=Zr,s=a?s*n%e:s,n=n*n%e}return s}function $a(i){return i>=Jt?i:-i}function ti(i,t){const{gcd:e,x:r}=function(n,s){let a=BigInt(0),o=BigInt(1),c=BigInt(1),u=BigInt(0),h=$a(n),f=$a(s);const y=n<Jt,g=s<Jt;for(;f!==Jt;){const A=h/f;let d=a;a=c-A*a,c=d,d=o,o=u-A*o,u=d,d=f,f=h%f,h=d}return{x:y?-c:c,y:g?-u:u,gcd:h}}(i,t);if(e!==Zr)throw Error("Inverse does not exist");return tt(r+t,t)}function Fs(i){const t=Number(i);if(t>Number.MAX_SAFE_INTEGER)throw Error("Number can only safely store up to 53 bits");return t}function F3(i,t){return(i>>BigInt(t)&Zr)===Jt?0:1}function Wr(i){const t=i<Jt?BigInt(-1):Jt;let e=1,r=i;for(;(r>>=Zr)!==t;)e++;return e}function Yt(i){const t=i<Jt?BigInt(-1):Jt,e=BigInt(8);let r=1,n=i;for(;(n>>=e)!==t;)r++;return r}function kt(i,t="be",e){let r=i.toString(16);r.length%2==1&&(r="0"+r);const n=r.length/2,s=new Uint8Array(e||n),a=e?e-n:0;let o=0;for(;o<n;)s[o+a]=parseInt(r.slice(2*o,2*o+2),16),o++;return t!=="be"&&s.reverse(),s}const as=p.getNodeCrypto();function Dt(i){const t=typeof crypto<"u"?crypto:as==null?void 0:as.webcrypto;if(t!=null&&t.getRandomValues){const e=new Uint8Array(i);return t.getRandomValues(e)}throw Error("No secure random number generator available.")}function ur(i,t){if(t<i)throw Error("Illegal parameter value: max <= min");const e=t-i;return tt(V(Dt(Yt(e)+8)),e)+i}const Ae=BigInt(1);function Xa(i,t,e){const r=BigInt(30),n=Ae<<BigInt(i-1),s=[1,6,5,4,3,2,1,4,3,2,1,2,1,4,3,2,1,2,1,4,3,2,1,6,5,4,3,2,1,2];let a=ur(n,n<<Ae),o=Fs(tt(a,r));do a+=BigInt(s[o]),o=(o+s[o])%s.length,Wr(a)>i&&(a=tt(a,n<<Ae),a+=n,o=Fs(tt(a,r)));while(!x1(a,t,e));return a}function x1(i,t,e){return(!t||function(r,n){let s=r,a=n;for(;a!==Jt;){const o=a;a=s%a,s=o}return s}(i-Ae,t)===Ae)&&!!function(r){const n=BigInt(0);return N3.every(s=>tt(r,s)!==n)}(i)&&!!function(r,n=BigInt(2)){return Ut(n,r-Ae,r)===Ae}(i)&&!!function(r,n){const s=Wr(r);n||(n=Math.max(1,s/48|0));const a=r-Ae;let o=0;for(;!F3(a,o);)o++;const c=r>>BigInt(o);for(;n>0;n--){let u,h=Ut(ur(BigInt(2),a),c,r);if(h!==Ae&&h!==a){for(u=1;u<o;u++){if(h=tt(h*h,r),h===Ae)return!1;if(h===a)break}if(u===o)return!1}}return!0}(i,e)}const N3=[7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999].map(i=>BigInt(i)),to=p.getWebCrypto(),En=p.getNodeCrypto(),O3=En&&En.getHashes();function je(i){if(En&&O3.includes(i))return async function(t){const e=En.createHash(i);return At(t,r=>{e.update(r)},()=>new Uint8Array(e.digest()))}}function Ve(i,t){const e=async()=>{const{nobleHashes:r}=await Promise.resolve().then(function(){return T2}),n=r.get(i);if(!n)throw Error("Unsupported hash");return n};return async function(r){if(vt(r)&&(r=await It(r)),p.isStream(r)){const n=(await e()).create();return At(r,s=>{n.update(s)},()=>n.digest())}return to&&t?new Uint8Array(await to.digest(t,r)):(await e())(r)}}const H3=je("md5")||Ve("md5"),z3=je("sha1")||Ve("sha1","SHA-1"),G3=je("sha224")||Ve("sha224"),q3=je("sha256")||Ve("sha256","SHA-256"),_3=je("sha384")||Ve("sha384","SHA-384"),j3=je("sha512")||Ve("sha512","SHA-512"),V3=je("ripemd160")||Ve("ripemd160"),J3=je("sha3-256")||Ve("sha3_256"),Y3=je("sha3-512")||Ve("sha3_512");function Ue(i,t){switch(i){case l.hash.md5:return H3(t);case l.hash.sha1:return z3(t);case l.hash.ripemd:return V3(t);case l.hash.sha256:return q3(t);case l.hash.sha384:return _3(t);case l.hash.sha512:return j3(t);case l.hash.sha224:return G3(t);case l.hash.sha3_256:return J3(t);case l.hash.sha3_512:return Y3(t);default:throw Error("Unsupported hash function")}}function Bt(i){switch(i){case l.hash.md5:return 16;case l.hash.sha1:case l.hash.ripemd:return 20;case l.hash.sha256:return 32;case l.hash.sha384:return 48;case l.hash.sha512:return 64;case l.hash.sha224:return 28;case l.hash.sha3_256:return 32;case l.hash.sha3_512:return 64;default:throw Error("Invalid hash algorithm.")}}const we=[];function Q1(i,t){const e=i.length;if(e>t-11)throw Error("Message too long");const r=function(s){const a=new Uint8Array(s);let o=0;for(;o<s;){const c=Dt(s-o);for(let u=0;u<c.length;u++)c[u]!==0&&(a[o++]=c[u])}return a}(t-e-3),n=new Uint8Array(t);return n[1]=2,n.set(r,2),n.set(i,t-e),n}function R1(i,t){let e=2,r=1;for(let o=e;o<i.length;o++)r&=i[o]!==0,e+=r;const n=e-2,s=i.subarray(e+1),a=i[0]===0&i[1]===2&n>=8&!r;if(t)return p.selectUint8Array(a,s,t);if(a)return s;throw Error("Decryption error")}function T1(i,t,e){let r;if(t.length!==Bt(i))throw Error("Invalid hash length");const n=new Uint8Array(we[i].length);for(r=0;r<we[i].length;r++)n[r]=we[i][r];const s=n.length+t.length;if(e<s+11)throw Error("Intended encoded message length too short");const a=new Uint8Array(e-s-3).fill(255),o=new Uint8Array(e);return o[1]=1,o.set(a,2),o.set(n,e-s),o.set(t,e-t.length),o}we[1]=[48,32,48,12,6,8,42,134,72,134,247,13,2,5,5,0,4,16],we[2]=[48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],we[3]=[48,33,48,9,6,5,43,36,3,2,1,5,0,4,20],we[8]=[48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32],we[9]=[48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48],we[10]=[48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64],we[11]=[48,45,48,13,6,9,96,134,72,1,101,3,4,2,4,5,0,4,28];const ei=p.getWebCrypto(),Ur=p.getNodeCrypto(),fr=BigInt(1);async function Z3(i,t,e,r,n,s,a,o,c){if(Bt(i)>=e.length)throw Error("Digest size cannot exceed key modulus size");if(t&&!p.isStream(t)){if(p.getWebCrypto())try{return await async function(u,h,f,y,g,A,d,w){const k=await Ns(f,y,g,A,d,w),v={name:"RSASSA-PKCS1-v1_5",hash:{name:u}},b=await ei.importKey("jwk",k,v,!1,["sign"]);return new Uint8Array(await ei.sign("RSASSA-PKCS1-v1_5",b,h))}(l.read(l.webHash,i),t,e,r,n,s,a,o)}catch(u){p.printDebugError(u)}else if(p.getNodeCrypto())return async function(u,h,f,y,g,A,d,w){const k=Ur.createSign(l.read(l.hash,u));k.write(h),k.end();const v=await Ns(f,y,g,A,d,w);return new Uint8Array(k.sign({key:v,format:"jwk",type:"pkcs1"}))}(i,t,e,r,n,s,a,o)}return async function(u,h,f,y){h=V(h);const g=V(T1(u,y,Yt(h)));return f=V(f),kt(Ut(g,f,h),"be",Yt(h))}(i,e,n,c)}async function W3(i,t,e,r,n,s){if(t&&!p.isStream(t)){if(p.getWebCrypto())try{return await async function(a,o,c,u,h){const f=Os(u,h),y=await ei.importKey("jwk",f,{name:"RSASSA-PKCS1-v1_5",hash:{name:a}},!1,["verify"]);return ei.verify("RSASSA-PKCS1-v1_5",y,c,o)}(l.read(l.webHash,i),t,e,r,n)}catch(a){p.printDebugError(a)}else if(p.getNodeCrypto())return async function(a,o,c,u,h){const f=Os(u,h),y={key:f,format:"jwk",type:"pkcs1"},g=Ur.createVerify(l.read(l.hash,a));g.write(o),g.end();try{return g.verify(y,c)}catch{return!1}}(i,t,e,r,n)}return async function(a,o,c,u,h){if(c=V(c),o=V(o),u=V(u),o>=c)throw Error("Signature size cannot exceed modulus size");const f=kt(Ut(o,u,c),"be",Yt(c)),y=T1(a,h,Yt(c));return p.equalsUint8Array(f,y)}(i,e,r,n,s)}async function $3(i,t,e){return p.getNodeCrypto()?async function(r,n,s){const a=Os(n,s),o={key:a,format:"jwk",type:"pkcs1",padding:Ur.constants.RSA_PKCS1_PADDING};return new Uint8Array(Ur.publicEncrypt(o,r))}(i,t,e):async function(r,n,s){if(n=V(n),r=V(Q1(r,Yt(n))),s=V(s),r>=n)throw Error("Message size cannot exceed modulus size");return kt(Ut(r,s,n),"be",Yt(n))}(i,t,e)}async function X3(i,t,e,r,n,s,a,o){if(p.getNodeCrypto()&&!o)try{return await async function(c,u,h,f,y,g,A){const d=await Ns(u,h,f,y,g,A),w={key:d,format:"jwk",type:"pkcs1",padding:Ur.constants.RSA_PKCS1_PADDING};try{return new Uint8Array(Ur.privateDecrypt(w,c))}catch{throw Error("Decryption error")}}(i,t,e,r,n,s,a)}catch(c){p.printDebugError(c)}return async function(c,u,h,f,y,g,A,d){if(c=V(c),u=V(u),h=V(h),f=V(f),y=V(y),g=V(g),A=V(A),c>=u)throw Error("Data too large.");const w=tt(f,g-fr),k=tt(f,y-fr),v=ur(BigInt(2),u),b=Ut(ti(v,u),h,u);c=tt(c*b,u);const E=Ut(c,k,y),U=Ut(c,w,g);let x=tt(A*(U-E),g)*y+E;return x=tt(x*v,u),R1(kt(x,"be",Yt(u)),d)}(i,t,e,r,n,s,a,o)}async function Ns(i,t,e,r,n,s){const a=V(r),o=V(n),c=V(e);let u=tt(c,o-fr),h=tt(c,a-fr);return h=kt(h),u=kt(u),{kty:"RSA",n:Nt(i),e:Nt(t),d:Nt(e),p:Nt(n),q:Nt(r),dp:Nt(u),dq:Nt(h),qi:Nt(s),ext:!0}}function Os(i,t){return{kty:"RSA",n:Nt(i),e:Nt(t),ext:!0}}function eo(i,t){return{n:fe(i.n),e:kt(t),d:fe(i.d),p:fe(i.q),q:fe(i.p),u:fe(i.qi)}}const rr=BigInt(1),os=typeof Lt=="object"&&"crypto"in Lt?Lt.crypto:void 0,yt={};var j=function(i){var t,e=new Float64Array(16);if(i)for(t=0;t<i.length;t++)e[t]=i[t];return e},Hs=function(){throw Error("no PRNG")},L1=new Uint8Array(32);L1[0]=9;var zs=j(),vn=j([1]),t0=j([56129,1]),e0=j([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),r0=j([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),ro=j([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),io=j([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),i0=j([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function no(i,t,e,r){i[t]=e>>24&255,i[t+1]=e>>16&255,i[t+2]=e>>8&255,i[t+3]=255&e,i[t+4]=r>>24&255,i[t+5]=r>>16&255,i[t+6]=r>>8&255,i[t+7]=255&r}function M1(i,t,e,r){return function(n,s,a,o,c){var u,h=0;for(u=0;u<c;u++)h|=n[s+u]^a[o+u];return(1&h-1>>>8)-1}(i,t,e,r,32)}function nr(i,t){var e;for(e=0;e<16;e++)i[e]=0|t[e]}function cs(i){var t,e,r=1;for(t=0;t<16;t++)e=i[t]+r+65535,r=Math.floor(e/65536),i[t]=e-65536*r;i[0]+=r-1+37*(r-1)}function _r(i,t,e){for(var r,n=~(e-1),s=0;s<16;s++)r=n&(i[s]^t[s]),i[s]^=r,t[s]^=r}function Li(i,t){var e,r,n,s=j(),a=j();for(e=0;e<16;e++)a[e]=t[e];for(cs(a),cs(a),cs(a),r=0;r<2;r++){for(s[0]=a[0]-65517,e=1;e<15;e++)s[e]=a[e]-65535-(s[e-1]>>16&1),s[e-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),n=s[15]>>16&1,s[14]&=65535,_r(a,s,1-n)}for(e=0;e<16;e++)i[2*e]=255&a[e],i[2*e+1]=a[e]>>8}function so(i,t){var e=new Uint8Array(32),r=new Uint8Array(32);return Li(e,i),Li(r,t),M1(e,0,r,0)}function F1(i){var t=new Uint8Array(32);return Li(t,i),1&t[0]}function N1(i,t){var e;for(e=0;e<16;e++)i[e]=t[2*e]+(t[2*e+1]<<8);i[15]&=32767}function be(i,t,e){for(var r=0;r<16;r++)i[r]=t[r]+e[r]}function Ee(i,t,e){for(var r=0;r<16;r++)i[r]=t[r]-e[r]}function et(i,t,e){var r,n,s=0,a=0,o=0,c=0,u=0,h=0,f=0,y=0,g=0,A=0,d=0,w=0,k=0,v=0,b=0,E=0,U=0,D=0,x=0,I=0,m=0,K=0,C=0,S=0,B=0,P=0,Q=0,R=0,L=0,q=0,G=0,M=e[0],F=e[1],T=e[2],H=e[3],N=e[4],_=e[5],z=e[6],Y=e[7],J=e[8],X=e[9],W=e[10],rt=e[11],st=e[12],dt=e[13],wt=e[14],mt=e[15];s+=(r=t[0])*M,a+=r*F,o+=r*T,c+=r*H,u+=r*N,h+=r*_,f+=r*z,y+=r*Y,g+=r*J,A+=r*X,d+=r*W,w+=r*rt,k+=r*st,v+=r*dt,b+=r*wt,E+=r*mt,a+=(r=t[1])*M,o+=r*F,c+=r*T,u+=r*H,h+=r*N,f+=r*_,y+=r*z,g+=r*Y,A+=r*J,d+=r*X,w+=r*W,k+=r*rt,v+=r*st,b+=r*dt,E+=r*wt,U+=r*mt,o+=(r=t[2])*M,c+=r*F,u+=r*T,h+=r*H,f+=r*N,y+=r*_,g+=r*z,A+=r*Y,d+=r*J,w+=r*X,k+=r*W,v+=r*rt,b+=r*st,E+=r*dt,U+=r*wt,D+=r*mt,c+=(r=t[3])*M,u+=r*F,h+=r*T,f+=r*H,y+=r*N,g+=r*_,A+=r*z,d+=r*Y,w+=r*J,k+=r*X,v+=r*W,b+=r*rt,E+=r*st,U+=r*dt,D+=r*wt,x+=r*mt,u+=(r=t[4])*M,h+=r*F,f+=r*T,y+=r*H,g+=r*N,A+=r*_,d+=r*z,w+=r*Y,k+=r*J,v+=r*X,b+=r*W,E+=r*rt,U+=r*st,D+=r*dt,x+=r*wt,I+=r*mt,h+=(r=t[5])*M,f+=r*F,y+=r*T,g+=r*H,A+=r*N,d+=r*_,w+=r*z,k+=r*Y,v+=r*J,b+=r*X,E+=r*W,U+=r*rt,D+=r*st,x+=r*dt,I+=r*wt,m+=r*mt,f+=(r=t[6])*M,y+=r*F,g+=r*T,A+=r*H,d+=r*N,w+=r*_,k+=r*z,v+=r*Y,b+=r*J,E+=r*X,U+=r*W,D+=r*rt,x+=r*st,I+=r*dt,m+=r*wt,K+=r*mt,y+=(r=t[7])*M,g+=r*F,A+=r*T,d+=r*H,w+=r*N,k+=r*_,v+=r*z,b+=r*Y,E+=r*J,U+=r*X,D+=r*W,x+=r*rt,I+=r*st,m+=r*dt,K+=r*wt,C+=r*mt,g+=(r=t[8])*M,A+=r*F,d+=r*T,w+=r*H,k+=r*N,v+=r*_,b+=r*z,E+=r*Y,U+=r*J,D+=r*X,x+=r*W,I+=r*rt,m+=r*st,K+=r*dt,C+=r*wt,S+=r*mt,A+=(r=t[9])*M,d+=r*F,w+=r*T,k+=r*H,v+=r*N,b+=r*_,E+=r*z,U+=r*Y,D+=r*J,x+=r*X,I+=r*W,m+=r*rt,K+=r*st,C+=r*dt,S+=r*wt,B+=r*mt,d+=(r=t[10])*M,w+=r*F,k+=r*T,v+=r*H,b+=r*N,E+=r*_,U+=r*z,D+=r*Y,x+=r*J,I+=r*X,m+=r*W,K+=r*rt,C+=r*st,S+=r*dt,B+=r*wt,P+=r*mt,w+=(r=t[11])*M,k+=r*F,v+=r*T,b+=r*H,E+=r*N,U+=r*_,D+=r*z,x+=r*Y,I+=r*J,m+=r*X,K+=r*W,C+=r*rt,S+=r*st,B+=r*dt,P+=r*wt,Q+=r*mt,k+=(r=t[12])*M,v+=r*F,b+=r*T,E+=r*H,U+=r*N,D+=r*_,x+=r*z,I+=r*Y,m+=r*J,K+=r*X,C+=r*W,S+=r*rt,B+=r*st,P+=r*dt,Q+=r*wt,R+=r*mt,v+=(r=t[13])*M,b+=r*F,E+=r*T,U+=r*H,D+=r*N,x+=r*_,I+=r*z,m+=r*Y,K+=r*J,C+=r*X,S+=r*W,B+=r*rt,P+=r*st,Q+=r*dt,R+=r*wt,L+=r*mt,b+=(r=t[14])*M,E+=r*F,U+=r*T,D+=r*H,x+=r*N,I+=r*_,m+=r*z,K+=r*Y,C+=r*J,S+=r*X,B+=r*W,P+=r*rt,Q+=r*st,R+=r*dt,L+=r*wt,q+=r*mt,E+=(r=t[15])*M,a+=38*(D+=r*T),o+=38*(x+=r*H),c+=38*(I+=r*N),u+=38*(m+=r*_),h+=38*(K+=r*z),f+=38*(C+=r*Y),y+=38*(S+=r*J),g+=38*(B+=r*X),A+=38*(P+=r*W),d+=38*(Q+=r*rt),w+=38*(R+=r*st),k+=38*(L+=r*dt),v+=38*(q+=r*wt),b+=38*(G+=r*mt),s=(r=(s+=38*(U+=r*F))+(n=1)+65535)-65536*(n=Math.floor(r/65536)),a=(r=a+n+65535)-65536*(n=Math.floor(r/65536)),o=(r=o+n+65535)-65536*(n=Math.floor(r/65536)),c=(r=c+n+65535)-65536*(n=Math.floor(r/65536)),u=(r=u+n+65535)-65536*(n=Math.floor(r/65536)),h=(r=h+n+65535)-65536*(n=Math.floor(r/65536)),f=(r=f+n+65535)-65536*(n=Math.floor(r/65536)),y=(r=y+n+65535)-65536*(n=Math.floor(r/65536)),g=(r=g+n+65535)-65536*(n=Math.floor(r/65536)),A=(r=A+n+65535)-65536*(n=Math.floor(r/65536)),d=(r=d+n+65535)-65536*(n=Math.floor(r/65536)),w=(r=w+n+65535)-65536*(n=Math.floor(r/65536)),k=(r=k+n+65535)-65536*(n=Math.floor(r/65536)),v=(r=v+n+65535)-65536*(n=Math.floor(r/65536)),b=(r=b+n+65535)-65536*(n=Math.floor(r/65536)),E=(r=E+n+65535)-65536*(n=Math.floor(r/65536)),s=(r=(s+=n-1+37*(n-1))+(n=1)+65535)-65536*(n=Math.floor(r/65536)),a=(r=a+n+65535)-65536*(n=Math.floor(r/65536)),o=(r=o+n+65535)-65536*(n=Math.floor(r/65536)),c=(r=c+n+65535)-65536*(n=Math.floor(r/65536)),u=(r=u+n+65535)-65536*(n=Math.floor(r/65536)),h=(r=h+n+65535)-65536*(n=Math.floor(r/65536)),f=(r=f+n+65535)-65536*(n=Math.floor(r/65536)),y=(r=y+n+65535)-65536*(n=Math.floor(r/65536)),g=(r=g+n+65535)-65536*(n=Math.floor(r/65536)),A=(r=A+n+65535)-65536*(n=Math.floor(r/65536)),d=(r=d+n+65535)-65536*(n=Math.floor(r/65536)),w=(r=w+n+65535)-65536*(n=Math.floor(r/65536)),k=(r=k+n+65535)-65536*(n=Math.floor(r/65536)),v=(r=v+n+65535)-65536*(n=Math.floor(r/65536)),b=(r=b+n+65535)-65536*(n=Math.floor(r/65536)),E=(r=E+n+65535)-65536*(n=Math.floor(r/65536)),s+=n-1+37*(n-1),i[0]=s,i[1]=a,i[2]=o,i[3]=c,i[4]=u,i[5]=h,i[6]=f,i[7]=y,i[8]=g,i[9]=A,i[10]=d,i[11]=w,i[12]=k,i[13]=v,i[14]=b,i[15]=E}function le(i,t){et(i,t,t)}function O1(i,t){var e,r=j();for(e=0;e<16;e++)r[e]=t[e];for(e=253;e>=0;e--)le(r,r),e!==2&&e!==4&&et(r,r,t);for(e=0;e<16;e++)i[e]=r[e]}function H1(i,t,e){var r,n,s=new Uint8Array(32),a=new Float64Array(80),o=j(),c=j(),u=j(),h=j(),f=j(),y=j();for(n=0;n<31;n++)s[n]=t[n];for(s[31]=127&t[31]|64,s[0]&=248,N1(a,e),n=0;n<16;n++)c[n]=a[n],h[n]=o[n]=u[n]=0;for(o[0]=h[0]=1,n=254;n>=0;--n)_r(o,c,r=s[n>>>3]>>>(7&n)&1),_r(u,h,r),be(f,o,u),Ee(o,o,u),be(u,c,h),Ee(c,c,h),le(h,f),le(y,o),et(o,u,o),et(u,c,f),be(f,o,u),Ee(o,o,u),le(c,o),Ee(u,h,y),et(o,u,t0),be(o,o,h),et(u,u,o),et(o,h,y),et(h,c,a),le(c,f),_r(o,c,r),_r(u,h,r);for(n=0;n<16;n++)a[n+16]=o[n],a[n+32]=u[n],a[n+48]=c[n],a[n+64]=h[n];var g=a.subarray(32),A=a.subarray(16);return O1(g,g),et(A,A,g),Li(i,A),0}function ao(i,t){return H1(i,t,L1)}var oo=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function co(i,t,e,r){for(var n,s,a,o,c,u,h,f,y,g,A,d,w,k,v,b,E,U,D,x,I,m,K,C,S,B,P=new Int32Array(16),Q=new Int32Array(16),R=i[0],L=i[1],q=i[2],G=i[3],M=i[4],F=i[5],T=i[6],H=i[7],N=t[0],_=t[1],z=t[2],Y=t[3],J=t[4],X=t[5],W=t[6],rt=t[7],st=0;r>=128;){for(D=0;D<16;D++)x=8*D+st,P[D]=e[x+0]<<24|e[x+1]<<16|e[x+2]<<8|e[x+3],Q[D]=e[x+4]<<24|e[x+5]<<16|e[x+6]<<8|e[x+7];for(D=0;D<80;D++)if(n=R,s=L,a=q,o=G,c=M,u=F,h=T,y=N,g=_,A=z,d=Y,w=J,k=X,v=W,K=65535&(m=rt),C=m>>>16,S=65535&(I=H),B=I>>>16,K+=65535&(m=(J>>>14|M<<18)^(J>>>18|M<<14)^(M>>>9|J<<23)),C+=m>>>16,S+=65535&(I=(M>>>14|J<<18)^(M>>>18|J<<14)^(J>>>9|M<<23)),B+=I>>>16,K+=65535&(m=J&X^~J&W),C+=m>>>16,S+=65535&(I=M&F^~M&T),B+=I>>>16,I=oo[2*D],K+=65535&(m=oo[2*D+1]),C+=m>>>16,S+=65535&I,B+=I>>>16,I=P[D%16],C+=(m=Q[D%16])>>>16,S+=65535&I,B+=I>>>16,S+=(C+=(K+=65535&m)>>>16)>>>16,K=65535&(m=U=65535&K|C<<16),C=m>>>16,S=65535&(I=E=65535&S|(B+=S>>>16)<<16),B=I>>>16,K+=65535&(m=(N>>>28|R<<4)^(R>>>2|N<<30)^(R>>>7|N<<25)),C+=m>>>16,S+=65535&(I=(R>>>28|N<<4)^(N>>>2|R<<30)^(N>>>7|R<<25)),B+=I>>>16,C+=(m=N&_^N&z^_&z)>>>16,S+=65535&(I=R&L^R&q^L&q),B+=I>>>16,f=65535&(S+=(C+=(K+=65535&m)>>>16)>>>16)|(B+=S>>>16)<<16,b=65535&K|C<<16,K=65535&(m=d),C=m>>>16,S=65535&(I=o),B=I>>>16,C+=(m=U)>>>16,S+=65535&(I=E),B+=I>>>16,L=n,q=s,G=a,M=o=65535&(S+=(C+=(K+=65535&m)>>>16)>>>16)|(B+=S>>>16)<<16,F=c,T=u,H=h,R=f,_=y,z=g,Y=A,J=d=65535&K|C<<16,X=w,W=k,rt=v,N=b,D%16==15)for(x=0;x<16;x++)I=P[x],K=65535&(m=Q[x]),C=m>>>16,S=65535&I,B=I>>>16,I=P[(x+9)%16],K+=65535&(m=Q[(x+9)%16]),C+=m>>>16,S+=65535&I,B+=I>>>16,E=P[(x+1)%16],K+=65535&(m=((U=Q[(x+1)%16])>>>1|E<<31)^(U>>>8|E<<24)^(U>>>7|E<<25)),C+=m>>>16,S+=65535&(I=(E>>>1|U<<31)^(E>>>8|U<<24)^E>>>7),B+=I>>>16,E=P[(x+14)%16],C+=(m=((U=Q[(x+14)%16])>>>19|E<<13)^(E>>>29|U<<3)^(U>>>6|E<<26))>>>16,S+=65535&(I=(E>>>19|U<<13)^(U>>>29|E<<3)^E>>>6),B+=I>>>16,B+=(S+=(C+=(K+=65535&m)>>>16)>>>16)>>>16,P[x]=65535&S|B<<16,Q[x]=65535&K|C<<16;K=65535&(m=N),C=m>>>16,S=65535&(I=R),B=I>>>16,I=i[0],C+=(m=t[0])>>>16,S+=65535&I,B+=I>>>16,B+=(S+=(C+=(K+=65535&m)>>>16)>>>16)>>>16,i[0]=R=65535&S|B<<16,t[0]=N=65535&K|C<<16,K=65535&(m=_),C=m>>>16,S=65535&(I=L),B=I>>>16,I=i[1],C+=(m=t[1])>>>16,S+=65535&I,B+=I>>>16,B+=(S+=(C+=(K+=65535&m)>>>16)>>>16)>>>16,i[1]=L=65535&S|B<<16,t[1]=_=65535&K|C<<16,K=65535&(m=z),C=m>>>16,S=65535&(I=q),B=I>>>16,I=i[2],C+=(m=t[2])>>>16,S+=65535&I,B+=I>>>16,B+=(S+=(C+=(K+=65535&m)>>>16)>>>16)>>>16,i[2]=q=65535&S|B<<16,t[2]=z=65535&K|C<<16,K=65535&(m=Y),C=m>>>16,S=65535&(I=G),B=I>>>16,I=i[3],C+=(m=t[3])>>>16,S+=65535&I,B+=I>>>16,B+=(S+=(C+=(K+=65535&m)>>>16)>>>16)>>>16,i[3]=G=65535&S|B<<16,t[3]=Y=65535&K|C<<16,K=65535&(m=J),C=m>>>16,S=65535&(I=M),B=I>>>16,I=i[4],C+=(m=t[4])>>>16,S+=65535&I,B+=I>>>16,B+=(S+=(C+=(K+=65535&m)>>>16)>>>16)>>>16,i[4]=M=65535&S|B<<16,t[4]=J=65535&K|C<<16,K=65535&(m=X),C=m>>>16,S=65535&(I=F),B=I>>>16,I=i[5],C+=(m=t[5])>>>16,S+=65535&I,B+=I>>>16,B+=(S+=(C+=(K+=65535&m)>>>16)>>>16)>>>16,i[5]=F=65535&S|B<<16,t[5]=X=65535&K|C<<16,K=65535&(m=W),C=m>>>16,S=65535&(I=T),B=I>>>16,I=i[6],C+=(m=t[6])>>>16,S+=65535&I,B+=I>>>16,B+=(S+=(C+=(K+=65535&m)>>>16)>>>16)>>>16,i[6]=T=65535&S|B<<16,t[6]=W=65535&K|C<<16,K=65535&(m=rt),C=m>>>16,S=65535&(I=H),B=I>>>16,I=i[7],C+=(m=t[7])>>>16,S+=65535&I,B+=I>>>16,B+=(S+=(C+=(K+=65535&m)>>>16)>>>16)>>>16,i[7]=H=65535&S|B<<16,t[7]=rt=65535&K|C<<16,st+=128,r-=128}return r}function Ei(i,t,e){var r,n=new Int32Array(8),s=new Int32Array(8),a=new Uint8Array(256),o=e;for(n[0]=1779033703,n[1]=3144134277,n[2]=1013904242,n[3]=2773480762,n[4]=1359893119,n[5]=2600822924,n[6]=528734635,n[7]=1541459225,s[0]=4089235720,s[1]=2227873595,s[2]=4271175723,s[3]=1595750129,s[4]=2917565137,s[5]=725511199,s[6]=4215389547,s[7]=327033209,co(n,s,t,e),e%=128,r=0;r<e;r++)a[r]=t[o-e+r];for(a[e]=128,a[(e=256-128*(e<112?1:0))-9]=0,no(a,e-8,o/536870912|0,o<<3),co(n,s,a,e),r=0;r<8;r++)no(i,8*r,n[r],s[r]);return 0}function Gs(i,t){var e=j(),r=j(),n=j(),s=j(),a=j(),o=j(),c=j(),u=j(),h=j();Ee(e,i[1],i[0]),Ee(h,t[1],t[0]),et(e,e,h),be(r,i[0],i[1]),be(h,t[0],t[1]),et(r,r,h),et(n,i[3],t[3]),et(n,n,r0),et(s,i[2],t[2]),be(s,s,s),Ee(a,r,e),Ee(o,s,n),be(c,s,n),be(u,r,e),et(i[0],a,o),et(i[1],u,c),et(i[2],c,o),et(i[3],a,u)}function uo(i,t,e){var r;for(r=0;r<4;r++)_r(i[r],t[r],e)}function qs(i,t){var e=j(),r=j(),n=j();O1(n,t[2]),et(e,t[0],n),et(r,t[1],n),Li(i,r),i[31]^=F1(e)<<7}function z1(i,t,e){var r,n;for(nr(i[0],zs),nr(i[1],vn),nr(i[2],vn),nr(i[3],zs),n=255;n>=0;--n)uo(i,t,r=e[n/8|0]>>(7&n)&1),Gs(t,i),Gs(i,i),uo(i,t,r)}function _s(i,t){var e=[j(),j(),j(),j()];nr(e[0],ro),nr(e[1],io),nr(e[2],vn),et(e[3],ro,io),z1(i,e,t)}function ho(i,t,e){var r,n=new Uint8Array(64),s=[j(),j(),j(),j()];for(e||Hs(t,32),Ei(n,t,32),n[0]&=248,n[31]&=127,n[31]|=64,_s(s,n),qs(i,s),r=0;r<32;r++)t[r+32]=i[r];return 0}var us=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function G1(i,t){var e,r,n,s;for(r=63;r>=32;--r){for(e=0,n=r-32,s=r-12;n<s;++n)t[n]+=e-16*t[r]*us[n-(r-32)],e=Math.floor((t[n]+128)/256),t[n]-=256*e;t[n]+=e,t[r]=0}for(e=0,n=0;n<32;n++)t[n]+=e-(t[31]>>4)*us[n],e=t[n]>>8,t[n]&=255;for(n=0;n<32;n++)t[n]-=e*us[n];for(r=0;r<32;r++)t[r+1]+=t[r]>>8,i[r]=255&t[r]}function hs(i){var t,e=new Float64Array(64);for(t=0;t<64;t++)e[t]=i[t];for(t=0;t<64;t++)i[t]=0;G1(i,e)}function n0(i,t){var e=j(),r=j(),n=j(),s=j(),a=j(),o=j(),c=j();return nr(i[2],vn),N1(i[1],t),le(n,i[1]),et(s,n,e0),Ee(n,n,i[2]),be(s,i[2],s),le(a,s),le(o,a),et(c,o,a),et(e,c,n),et(e,e,s),function(u,h){var f,y=j();for(f=0;f<16;f++)y[f]=h[f];for(f=250;f>=0;f--)le(y,y),f!==1&&et(y,y,h);for(f=0;f<16;f++)u[f]=y[f]}(e,e),et(e,e,n),et(e,e,s),et(e,e,s),et(i[0],e,s),le(r,i[0]),et(r,r,s),so(r,n)&&et(i[0],i[0],i0),le(r,i[0]),et(r,r,s),so(r,n)?-1:(F1(i[0])===t[31]>>7&&Ee(i[0],zs,i[0]),et(i[3],i[0],i[1]),0)}var mr=64;function Fr(){for(var i=0;i<arguments.length;i++)if(!(arguments[i]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}yt.scalarMult=function(i,t){if(Fr(i,t),i.length!==32)throw Error("bad n size");if(t.length!==32)throw Error("bad p size");var e=new Uint8Array(32);return H1(e,i,t),e},yt.box={},yt.box.keyPair=function(){var i=new Uint8Array(32),t=new Uint8Array(32);return function(e,r){Hs(r,32),ao(e,r)}(i,t),{publicKey:i,secretKey:t}},yt.box.keyPair.fromSecretKey=function(i){if(Fr(i),i.length!==32)throw Error("bad secret key size");var t=new Uint8Array(32);return ao(t,i),{publicKey:t,secretKey:new Uint8Array(i)}},yt.sign=function(i,t){if(Fr(i,t),t.length!==64)throw Error("bad secret key size");var e=new Uint8Array(mr+i.length);return function(r,n,s,a){var o,c,u=new Uint8Array(64),h=new Uint8Array(64),f=new Uint8Array(64),y=new Float64Array(64),g=[j(),j(),j(),j()];for(Ei(u,a,32),u[0]&=248,u[31]&=127,u[31]|=64,o=0;o<s;o++)r[64+o]=n[o];for(o=0;o<32;o++)r[32+o]=u[32+o];for(Ei(f,r.subarray(32),s+32),hs(f),_s(g,f),qs(r,g),o=32;o<64;o++)r[o]=a[o];for(Ei(h,r,s+64),hs(h),o=0;o<64;o++)y[o]=0;for(o=0;o<32;o++)y[o]=f[o];for(o=0;o<32;o++)for(c=0;c<32;c++)y[o+c]+=h[o]*u[c];G1(r.subarray(32),y)}(e,i,i.length,t),e},yt.sign.detached=function(i,t){for(var e=yt.sign(i,t),r=new Uint8Array(mr),n=0;n<r.length;n++)r[n]=e[n];return r},yt.sign.detached.verify=function(i,t,e){if(Fr(i,t,e),t.length!==mr)throw Error("bad signature size");if(e.length!==32)throw Error("bad public key size");var r,n=new Uint8Array(mr+i.length),s=new Uint8Array(mr+i.length);for(r=0;r<mr;r++)n[r]=t[r];for(r=0;r<i.length;r++)n[r+mr]=i[r];return function(a,o,c,u){var h,f=new Uint8Array(32),y=new Uint8Array(64),g=[j(),j(),j(),j()],A=[j(),j(),j(),j()];if(c<64||n0(A,u))return-1;for(h=0;h<c;h++)a[h]=o[h];for(h=0;h<32;h++)a[h+32]=u[h];if(Ei(y,a,c),hs(y),z1(g,A,y),_s(A,o.subarray(32)),Gs(g,A),qs(f,g),c-=64,M1(o,0,f,0)){for(h=0;h<c;h++)a[h]=0;return-1}for(h=0;h<c;h++)a[h]=o[h+64];return c}(s,n,n.length,e)>=0},yt.sign.keyPair=function(){var i=new Uint8Array(32),t=new Uint8Array(64);return ho(i,t),{publicKey:i,secretKey:t}},yt.sign.keyPair.fromSecretKey=function(i){if(Fr(i),i.length!==64)throw Error("bad secret key size");for(var t=new Uint8Array(32),e=0;e<t.length;e++)t[e]=i[32+e];return{publicKey:t,secretKey:new Uint8Array(i)}},yt.sign.keyPair.fromSeed=function(i){if(Fr(i),i.length!==32)throw Error("bad seed size");for(var t=new Uint8Array(32),e=new Uint8Array(64),r=0;r<32;r++)e[r]=i[r];return ho(t,e,!0),{publicKey:t,secretKey:e}},yt.setPRNG=function(i){Hs=i},function(){os&&os.getRandomValues&&yt.setPRNG(function(i,t){var e,r=new Uint8Array(t);for(e=0;e<t;e+=65536)os.getRandomValues(r.subarray(e,e+Math.min(t-e,65536)));for(e=0;e<t;e++)i[e]=r[e];(function(n){for(var s=0;s<n.length;s++)n[s]=0})(r)})}();const s0={"2a8648ce3d030107":l.curve.nistP256,"2b81040022":l.curve.nistP384,"2b81040023":l.curve.nistP521,"2b8104000a":l.curve.secp256k1,"2b06010401da470f01":l.curve.ed25519Legacy,"2b060104019755010501":l.curve.curve25519Legacy,"2b2403030208010107":l.curve.brainpoolP256r1,"2b240303020801010b":l.curve.brainpoolP384r1,"2b240303020801010d":l.curve.brainpoolP512r1};class He{constructor(t){if(t instanceof He)this.oid=t.oid;else if(p.isArray(t)||p.isUint8Array(t)){if((t=new Uint8Array(t))[0]===6){if(t[1]!==t.length-2)throw Error("Length mismatch in DER encoded oid");t=t.subarray(2)}this.oid=t}else this.oid=""}read(t){if(t.length>=1){const e=t[0];if(t.length>=1+e)return this.oid=t.subarray(1,1+e),1+this.oid.length}throw Error("Invalid oid")}write(){return p.concatUint8Array([new Uint8Array([this.oid.length]),this.oid])}toHex(){return p.uint8ArrayToHex(this.oid)}getName(){const t=s0[this.toHex()];if(!t)throw Error("Unknown curve object identifier.");return t}}function q1(i){let t,e=0;const r=i[0];return r<192?([e]=i,t=1):r<255?(e=(i[0]-192<<8)+i[1]+192,t=2):r===255&&(e=p.readNumber(i.subarray(1,5)),t=5),{len:e,offset:t}}function Hn(i){return i<192?new Uint8Array([i]):i>191&&i<8384?new Uint8Array([192+(i-192>>8),i-192&255]):p.concatUint8Array([new Uint8Array([255]),p.writeNumber(i,4)])}function a0(i){if(i<0||i>30)throw Error("Partial Length power must be between 1 and 30");return new Uint8Array([224+i])}function Bn(i){return new Uint8Array([192|i])}function lo(i,t){return p.concatUint8Array([Bn(i),Hn(t)])}function fn(i){return[l.packet.literalData,l.packet.compressedData,l.packet.symmetricallyEncryptedData,l.packet.symEncryptedIntegrityProtectedData,l.packet.aeadEncryptedData].includes(i)}async function o0(i,t){const e=_e(i);let r,n;try{const s=await e.peekBytes(2);if(!s||s.length<2||!(128&s[0]))throw Error("Error during parsing. This message / key probably does not conform to a valid OpenPGP format.");const a=await e.readByte();let o,c,u=-1,h=-1;h=0,64&a&&(h=1),h?u=63&a:(u=(63&a)>>2,c=3&a);const f=fn(u);let y,g=null;if(f){if(p.isStream(i)==="array"){const d=new ie;r=Xt(d),g=d}else{const d=new TransformStream;r=Xt(d.writable),g=d.readable}n=t({tag:u,packet:g})}else g=[];do{if(h){const d=await e.readByte();if(y=!1,d<192)o=d;else if(d>=192&&d<224)o=(d-192<<8)+await e.readByte()+192;else if(d>223&&d<255){if(o=1<<(31&d),y=!0,!f)throw new TypeError("This packet type does not support partial lengths.")}else o=await e.readByte()<<24|await e.readByte()<<16|await e.readByte()<<8|await e.readByte()}else switch(c){case 0:o=await e.readByte();break;case 1:o=await e.readByte()<<8|await e.readByte();break;case 2:o=await e.readByte()<<24|await e.readByte()<<16|await e.readByte()<<8|await e.readByte();break;default:o=1/0}if(o>0){let d=0;for(;;){r&&await r.ready;const{done:w,value:k}=await e.read();if(w){if(o===1/0)break;throw Error("Unexpected end of packet")}const v=o===1/0?k:k.subarray(0,o-d);if(r?await r.write(v):g.push(v),d+=k.length,d>=o){e.unshift(k.subarray(o-d+k.length));break}}}}while(y);const A=await e.peekBytes(f?1/0:2);return r?(await r.ready,await r.close()):(g=p.concatUint8Array(g),await t({tag:u,packet:g})),!A||!A.length}catch(s){if(r)return await r.abort(s),!0;throw s}finally{r&&await n,e.releaseLock()}}class ot extends Error{constructor(...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,ot),this.name="UnsupportedError"}}class _1 extends ot{constructor(...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,ot),this.name="UnknownPacketError"}}class js{constructor(t,e){this.tag=t,this.rawContent=e}write(){return this.rawContent}}async function wa(i){switch(i){case l.publicKey.ed25519:try{const t=p.getWebCrypto(),e=await t.generateKey("Ed25519",!0,["sign","verify"]),r=await t.exportKey("jwk",e.privateKey),n=await t.exportKey("jwk",e.publicKey);return{A:new Uint8Array(fe(n.x)),seed:fe(r.d)}}catch(t){if(t.name!=="NotSupportedError"&&t.name!=="OperationError")throw t;const e=Dt(zn(i)),{publicKey:r}=yt.sign.keyPair.fromSeed(e);return{A:r,seed:e}}case l.publicKey.ed448:{const t=await p.getNobleCurve(l.publicKey.ed448),e=t.utils.randomPrivateKey();return{A:t.getPublicKey(e),seed:e}}default:throw Error("Unsupported EdDSA algorithm")}}async function ma(i,t,e,r,n,s){if(Bt(t)<Bt(Gn(i)))throw Error("Hash algorithm too weak for EdDSA.");switch(i){case l.publicKey.ed25519:try{const a=p.getWebCrypto(),o=c0(i,r,n),c=await a.importKey("jwk",o,"Ed25519",!1,["sign"]);return{RS:new Uint8Array(await a.sign("Ed25519",c,s))}}catch(a){if(a.name!=="NotSupportedError")throw a;const o=p.concatUint8Array([n,r]);return{RS:yt.sign.detached(s,o)}}case l.publicKey.ed448:return{RS:(await p.getNobleCurve(l.publicKey.ed448)).sign(s,n)};default:throw Error("Unsupported EdDSA algorithm")}}async function ba(i,t,{RS:e},r,n,s){if(Bt(t)<Bt(Gn(i)))throw Error("Hash algorithm too weak for EdDSA.");switch(i){case l.publicKey.ed25519:try{const a=p.getWebCrypto(),o=V1(i,n),c=await a.importKey("jwk",o,"Ed25519",!1,["verify"]);return await a.verify("Ed25519",c,e,s)}catch(a){if(a.name!=="NotSupportedError")throw a;return yt.sign.detached.verify(s,e,n)}case l.publicKey.ed448:return(await p.getNobleCurve(l.publicKey.ed448)).verify(e,s,n);default:throw Error("Unsupported EdDSA algorithm")}}async function j1(i,t,e){switch(i){case l.publicKey.ed25519:{const{publicKey:r}=yt.sign.keyPair.fromSeed(e);return p.equalsUint8Array(t,r)}case l.publicKey.ed448:{const r=(await p.getNobleCurve(l.publicKey.ed448)).getPublicKey(e);return p.equalsUint8Array(t,r)}default:return!1}}function zn(i){switch(i){case l.publicKey.ed25519:return 32;case l.publicKey.ed448:return 57;default:throw Error("Unsupported EdDSA algorithm")}}function Gn(i){switch(i){case l.publicKey.ed25519:return l.hash.sha256;case l.publicKey.ed448:return l.hash.sha512;default:throw Error("Unknown EdDSA algo")}}const V1=(i,t)=>{if(i===l.publicKey.ed25519)return{kty:"OKP",crv:"Ed25519",x:Nt(t),ext:!0};throw Error("Unsupported EdDSA algorithm")},c0=(i,t,e)=>{if(i===l.publicKey.ed25519){const r=V1(i,t);return r.d=Nt(e),r}throw Error("Unsupported EdDSA algorithm")};var u0=Object.freeze({__proto__:null,generate:wa,getPayloadSize:zn,getPreferredHashAlgo:Gn,sign:ma,validateParams:j1,verify:ba});function J1(i){return i instanceof Uint8Array||i!=null&&typeof i=="object"&&i.constructor.name==="Uint8Array"}function nt(i,...t){if(!J1(i))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(i.length))throw Error(`Uint8Array expected of length ${t}, not of length=${i.length}`)}function In(i,t=!0){if(i.destroyed)throw Error("Hash instance has been destroyed");if(t&&i.finished)throw Error("Hash#digest() has already been called")}function Y1(i,t){nt(i);const e=t.outputLen;if(i.length<e)throw Error("digestInto() expects output buffer of length at least "+e)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const ka=i=>new Uint8Array(i.buffer,i.byteOffset,i.byteLength),ht=i=>new Uint32Array(i.buffer,i.byteOffset,Math.floor(i.byteLength/4)),Sn=i=>new DataView(i.buffer,i.byteOffset,i.byteLength);if(new Uint8Array(new Uint32Array([287454020]).buffer)[0]!==68)throw Error("Non little-endian hardware is not supported");function Mi(i){if(typeof i=="string")i=function(t){if(typeof t!="string")throw Error("string expected, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}(i);else{if(!J1(i))throw Error("Uint8Array expected, got "+typeof i);i=jt(i)}return i}function Z1(i,t){if(i.length!==t.length)return!1;let e=0;for(let r=0;r<i.length;r++)e|=i[r]^t[r];return e===0}const Vi=(i,t)=>(Object.assign(t,i),t);function ls(i,t,e,r){if(typeof i.setBigUint64=="function")return i.setBigUint64(t,e,r);const n=BigInt(32),s=BigInt(4294967295),a=Number(e>>n&s),o=Number(e&s);i.setUint32(t+0,a,r),i.setUint32(t+4,o,r)}function ne(i){return i.byteOffset%4==0}function jt(i){return Uint8Array.from(i)}function Mt(...i){for(let t=0;t<i.length;t++)i[t].fill(0)}const Fe=16,Ea=new Uint8Array(16),ke=ht(Ea),ee=i=>(i>>>0&255)<<24|(i>>>8&255)<<16|(i>>>16&255)<<8|i>>>24&255;class W1{constructor(t,e){this.blockLen=Fe,this.outputLen=Fe,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,nt(t=Mi(t),16);const r=Sn(t);let n=r.getUint32(0,!1),s=r.getUint32(4,!1),a=r.getUint32(8,!1),o=r.getUint32(12,!1);const c=[];for(let k=0;k<128;k++)c.push({s0:ee(n),s1:ee(s),s2:ee(a),s3:ee(o)}),{s0:n,s1:s,s2:a,s3:o}={s3:(f=a)<<31|(y=o)>>>1,s2:(h=s)<<31|f>>>1,s1:(u=n)<<31|h>>>1,s0:u>>>1^225<<24&-(1&y)};var u,h,f,y;const g=(k=>k>65536?8:k>1024?4:2)(e||1024);if(![1,2,4,8].includes(g))throw Error(`ghash: wrong window size=${g}, should be 2, 4 or 8`);this.W=g;const A=128/g,d=this.windowSize=2**g,w=[];for(let k=0;k<A;k++)for(let v=0;v<d;v++){let b=0,E=0,U=0,D=0;for(let x=0;x<g;x++){if(!(v>>>g-x-1&1))continue;const{s0:I,s1:m,s2:K,s3:C}=c[g*k+x];b^=I,E^=m,U^=K,D^=C}w.push({s0:b,s1:E,s2:U,s3:D})}this.t=w}_updateBlock(t,e,r,n){t^=this.s0,e^=this.s1,r^=this.s2,n^=this.s3;const{W:s,t:a,windowSize:o}=this;let c=0,u=0,h=0,f=0;const y=(1<<s)-1;let g=0;for(const A of[t,e,r,n])for(let d=0;d<4;d++){const w=A>>>8*d&255;for(let k=8/s-1;k>=0;k--){const v=w>>>s*k&y,{s0:b,s1:E,s2:U,s3:D}=a[g*o+v];c^=b,u^=E,h^=U,f^=D,g+=1}}this.s0=c,this.s1=u,this.s2=h,this.s3=f}update(t){t=Mi(t),In(this);const e=ht(t),r=Math.floor(t.length/Fe),n=t.length%Fe;for(let s=0;s<r;s++)this._updateBlock(e[4*s+0],e[4*s+1],e[4*s+2],e[4*s+3]);return n&&(Ea.set(t.subarray(r*Fe)),this._updateBlock(ke[0],ke[1],ke[2],ke[3]),Mt(ke)),this}destroy(){const{t}=this;for(const e of t)e.s0=0,e.s1=0,e.s2=0,e.s3=0}digestInto(t){In(this),Y1(t,this),this.finished=!0;const{s0:e,s1:r,s2:n,s3:s}=this,a=ht(t);return a[0]=e,a[1]=r,a[2]=n,a[3]=s,t}digest(){const t=new Uint8Array(Fe);return this.digestInto(t),this.destroy(),t}}class h0 extends W1{constructor(t,e){const r=function(n){n.reverse();const s=1&n[15];let a=0;for(let o=0;o<n.length;o++){const c=n[o];n[o]=c>>>1|a,a=(1&c)<<7}return n[0]^=225&-s,n}(jt(t=Mi(t)));super(r,e),Mt(r)}update(t){t=Mi(t),In(this);const e=ht(t),r=t.length%Fe,n=Math.floor(t.length/Fe);for(let s=0;s<n;s++)this._updateBlock(ee(e[4*s+3]),ee(e[4*s+2]),ee(e[4*s+1]),ee(e[4*s+0]));return r&&(Ea.set(t.subarray(n*Fe)),this._updateBlock(ee(ke[3]),ee(ke[2]),ee(ke[1]),ee(ke[0])),Mt(ke)),this}digestInto(t){In(this),Y1(t,this),this.finished=!0;const{s0:e,s1:r,s2:n,s3:s}=this,a=ht(t);return a[0]=e,a[1]=r,a[2]=n,a[3]=s,t.reverse()}}function $1(i){const t=(r,n)=>i(n,r.length).update(Mi(r)).digest(),e=i(new Uint8Array(16),0);return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=(r,n)=>i(r,n),t}const fo=$1((i,t)=>new W1(i,t));$1((i,t)=>new h0(i,t));const Gt=16,tn=new Uint8Array(Gt),l0=283;function va(i){return i<<1^l0&-(i>>7)}function jr(i,t){let e=0;for(;t>0;t>>=1)e^=i&-(1&t),i=va(i);return e}const Vs=(()=>{const i=new Uint8Array(256);for(let e=0,r=1;e<256;e++,r^=va(r))i[e]=r;const t=new Uint8Array(256);t[0]=99;for(let e=0;e<255;e++){let r=i[255-e];r|=r<<8,t[i[e]]=255&(r^r>>4^r>>5^r>>6^r>>7^99)}return Mt(i),t})(),f0=Vs.map((i,t)=>Vs.indexOf(t)),y0=i=>i<<24|i>>>8,fs=i=>i<<8|i>>>24,yo=i=>i<<24&4278190080|i<<8&16711680|i>>>8&65280|i>>>24&255;function X1(i,t){if(i.length!==256)throw Error("Wrong sbox length");const e=new Uint32Array(256).map((u,h)=>t(i[h])),r=e.map(fs),n=r.map(fs),s=n.map(fs),a=new Uint32Array(65536),o=new Uint32Array(65536),c=new Uint16Array(65536);for(let u=0;u<256;u++)for(let h=0;h<256;h++){const f=256*u+h;a[f]=e[u]^r[h],o[f]=n[u]^s[h],c[f]=i[u]<<8|i[h]}return{sbox:i,sbox2:c,T0:e,T1:r,T2:n,T3:s,T01:a,T23:o}}const Ba=X1(Vs,i=>jr(i,3)<<24|i<<16|i<<8|jr(i,2)),tc=X1(f0,i=>jr(i,11)<<24|jr(i,13)<<16|jr(i,9)<<8|jr(i,14)),g0=(()=>{const i=new Uint8Array(16);for(let t=0,e=1;t<16;t++,e=va(e))i[t]=e;return i})();function Tr(i){nt(i);const t=i.length;if(![16,24,32].includes(t))throw Error("aes: wrong key size: should be 16, 24 or 32, got: "+t);const{sbox2:e}=Ba,r=[];ne(i)||r.push(i=jt(i));const n=ht(i),s=n.length,a=c=>ve(e,c,c,c,c),o=new Uint32Array(t+28);o.set(n);for(let c=s;c<o.length;c++){let u=o[c-1];c%s==0?u=a(y0(u))^g0[c/s-1]:s>6&&c%s==4&&(u=a(u)),o[c]=o[c-s]^u}return Mt(...r),o}function Ia(i){const t=Tr(i),e=t.slice(),r=t.length,{sbox2:n}=Ba,{T0:s,T1:a,T2:o,T3:c}=tc;for(let u=0;u<r;u+=4)for(let h=0;h<4;h++)e[u+h]=t[r-u-4+h];Mt(t);for(let u=4;u<r-4;u++){const h=e[u],f=ve(n,h,h,h,h);e[u]=s[255&f]^a[f>>>8&255]^o[f>>>16&255]^c[f>>>24]}return e}function sr(i,t,e,r,n,s){return i[e<<8&65280|r>>>8&255]^t[n>>>8&65280|s>>>24&255]}function ve(i,t,e,r,n){return i[255&t|65280&e]|i[r>>>16&255|n>>>16&65280]<<16}function ye(i,t,e,r,n){const{sbox2:s,T01:a,T23:o}=Ba;let c=0;t^=i[c++],e^=i[c++],r^=i[c++],n^=i[c++];const u=i.length/4-2;for(let h=0;h<u;h++){const f=i[c++]^sr(a,o,t,e,r,n),y=i[c++]^sr(a,o,e,r,n,t),g=i[c++]^sr(a,o,r,n,t,e),A=i[c++]^sr(a,o,n,t,e,r);t=f,e=y,r=g,n=A}return{s0:i[c++]^ve(s,t,e,r,n),s1:i[c++]^ve(s,e,r,n,t),s2:i[c++]^ve(s,r,n,t,e),s3:i[c++]^ve(s,n,t,e,r)}}function qn(i,t,e,r,n){const{sbox2:s,T01:a,T23:o}=tc;let c=0;t^=i[c++],e^=i[c++],r^=i[c++],n^=i[c++];const u=i.length/4-2;for(let h=0;h<u;h++){const f=i[c++]^sr(a,o,t,n,r,e),y=i[c++]^sr(a,o,e,t,n,r),g=i[c++]^sr(a,o,r,e,t,n),A=i[c++]^sr(a,o,n,r,e,t);t=f,e=y,r=g,n=A}return{s0:i[c++]^ve(s,t,n,r,e),s1:i[c++]^ve(s,e,t,n,r),s2:i[c++]^ve(s,r,e,t,n),s3:i[c++]^ve(s,n,r,e,t)}}function Fi(i,t){if(t===void 0)return new Uint8Array(i);if(nt(t),t.length<i)throw Error(`aes: wrong destination length, expected at least ${i}, got: ${t.length}`);if(!ne(t))throw Error("unaligned dst");return t}function ec(i,t,e,r){nt(t,Gt),nt(e);const n=e.length;r=Fi(n,r);const s=t,a=ht(s);let{s0:o,s1:c,s2:u,s3:h}=ye(i,a[0],a[1],a[2],a[3]);const f=ht(e),y=ht(r);for(let A=0;A+4<=f.length;A+=4){y[A+0]=f[A+0]^o,y[A+1]=f[A+1]^c,y[A+2]=f[A+2]^u,y[A+3]=f[A+3]^h;let d=1;for(let w=s.length-1;w>=0;w--)d=d+(255&s[w])|0,s[w]=255&d,d>>>=8;({s0:o,s1:c,s2:u,s3:h}=ye(i,a[0],a[1],a[2],a[3]))}const g=Gt*Math.floor(f.length/4);if(g<n){const A=new Uint32Array([o,c,u,h]),d=ka(A);for(let w=g,k=0;w<n;w++,k++)r[w]=e[w]^d[k];Mt(A)}return r}function vi(i,t,e,r,n){nt(e,Gt),nt(r),n=Fi(r.length,n);const s=e,a=ht(s),o=Sn(s),c=ht(r),u=ht(n),h=t?0:12,f=r.length;let y=o.getUint32(h,t),{s0:g,s1:A,s2:d,s3:w}=ye(i,a[0],a[1],a[2],a[3]);for(let v=0;v+4<=c.length;v+=4)u[v+0]=c[v+0]^g,u[v+1]=c[v+1]^A,u[v+2]=c[v+2]^d,u[v+3]=c[v+3]^w,y=y+1>>>0,o.setUint32(h,y,t),{s0:g,s1:A,s2:d,s3:w}=ye(i,a[0],a[1],a[2],a[3]);const k=Gt*Math.floor(c.length/4);if(k<f){const v=new Uint32Array([g,A,d,w]),b=ka(v);for(let E=k,U=0;E<f;E++,U++)n[E]=r[E]^b[U];Mt(v)}return n}const p0=Vi({blockSize:16,nonceLength:16},function(i,t){function e(r,n){if(nt(r),n!==void 0&&(nt(n),!ne(n)))throw Error("unaligned destination");const s=Tr(i),a=jt(t),o=[s,a];ne(r)||o.push(r=jt(r));const c=ec(s,a,r,n);return Mt(...o),c}return nt(i),nt(t,Gt),{encrypt:(r,n)=>e(r,n),decrypt:(r,n)=>e(r,n)}}),rc=Vi({blockSize:16,nonceLength:16},function(i,t,e={}){nt(i),nt(t,16);const r=!e.disablePadding;return{encrypt(n,s){const a=Tr(i),{b:o,o:c,out:u}=function(v,b,E){nt(v);let U=v.length;const D=U%Gt;if(!b&&D!==0)throw Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");ne(v)||(v=jt(v));const x=ht(v);if(b){let m=Gt-D;m||(m=Gt),U+=m}const I=Fi(U,E);return{b:x,o:ht(I),out:I}}(n,r,s);let h=t;const f=[a];ne(h)||f.push(h=jt(h));const y=ht(h);let g=y[0],A=y[1],d=y[2],w=y[3],k=0;for(;k+4<=o.length;)g^=o[k+0],A^=o[k+1],d^=o[k+2],w^=o[k+3],{s0:g,s1:A,s2:d,s3:w}=ye(a,g,A,d,w),c[k++]=g,c[k++]=A,c[k++]=d,c[k++]=w;if(r){const v=function(b){const E=new Uint8Array(16),U=ht(E);E.set(b);const D=Gt-b.length;for(let x=Gt-D;x<Gt;x++)E[x]=D;return U}(n.subarray(4*k));g^=v[0],A^=v[1],d^=v[2],w^=v[3],{s0:g,s1:A,s2:d,s3:w}=ye(a,g,A,d,w),c[k++]=g,c[k++]=A,c[k++]=d,c[k++]=w}return Mt(...f),u},decrypt(n,s){(function(k){if(nt(k),k.length%Gt!=0)throw Error("aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size 16")})(n);const a=Ia(i);let o=t;const c=[a];ne(o)||c.push(o=jt(o));const u=ht(o),h=Fi(n.length,s);ne(n)||c.push(n=jt(n));const f=ht(n),y=ht(h);let g=u[0],A=u[1],d=u[2],w=u[3];for(let k=0;k+4<=f.length;){const v=g,b=A,E=d,U=w;g=f[k+0],A=f[k+1],d=f[k+2],w=f[k+3];const{s0:D,s1:x,s2:I,s3:m}=qn(a,g,A,d,w);y[k++]=D^v,y[k++]=x^b,y[k++]=I^E,y[k++]=m^U}return Mt(...c),function(k,v){if(!v)return k;const b=k.length;if(!b)throw Error("aes/pcks5: empty ciphertext not allowed");const E=k[b-1];if(E<=0||E>16)throw Error("aes/pcks5: wrong padding");const U=k.subarray(0,-E);for(let D=0;D<E;D++)if(k[b-D-1]!==E)throw Error("aes/pcks5: wrong padding");return U}(h,r)}}}),ic=Vi({blockSize:16,nonceLength:16},function(i,t){function e(r,n,s){nt(r);const a=r.length;s=Fi(a,s);const o=Tr(i);let c=t;const u=[o];ne(c)||u.push(c=jt(c)),ne(r)||u.push(r=jt(r));const h=ht(r),f=ht(s),y=n?f:h,g=ht(c);let A=g[0],d=g[1],w=g[2],k=g[3];for(let b=0;b+4<=h.length;){const{s0:E,s1:U,s2:D,s3:x}=ye(o,A,d,w,k);f[b+0]=h[b+0]^E,f[b+1]=h[b+1]^U,f[b+2]=h[b+2]^D,f[b+3]=h[b+3]^x,A=y[b++],d=y[b++],w=y[b++],k=y[b++]}const v=Gt*Math.floor(h.length/4);if(v<a){({s0:A,s1:d,s2:w,s3:k}=ye(o,A,d,w,k));const b=ka(new Uint32Array([A,d,w,k]));for(let E=v,U=0;E<a;E++,U++)s[E]=r[E]^b[U];Mt(b)}return Mt(...u),s}return nt(i),nt(t,16),{encrypt:(r,n)=>e(r,!0,n),decrypt:(r,n)=>e(r,!1,n)}}),en=Vi({blockSize:16,nonceLength:12,tagLength:16},function(i,t,e){if(nt(i),nt(t),e!==void 0&&nt(e),t.length<8)throw Error("aes/gcm: invalid nonce length");const r=16;function n(a,o,c){const u=function(h,f,y,g,A){const d=A==null?0:A.length,w=h.create(y,g.length+d);A&&w.update(A),w.update(g);const k=new Uint8Array(16),v=Sn(k);A&&ls(v,0,BigInt(8*d),f),ls(v,8,BigInt(8*g.length),f),w.update(k);const b=w.digest();return Mt(k),b}(fo,!1,a,c,e);for(let h=0;h<o.length;h++)u[h]^=o[h];return u}function s(){const a=Tr(i),o=tn.slice(),c=tn.slice();if(vi(a,!1,c,c,o),t.length===12)c.set(t);else{const u=tn.slice();ls(Sn(u),8,BigInt(8*t.length),!1);const h=fo.create(o).update(t).update(u);h.digestInto(c),h.destroy()}return{xk:a,authKey:o,counter:c,tagMask:vi(a,!1,c,tn)}}return{encrypt(a){nt(a);const{xk:o,authKey:c,counter:u,tagMask:h}=s(),f=new Uint8Array(a.length+r),y=[o,c,u,h];ne(a)||y.push(a=jt(a)),vi(o,!1,u,a,f);const g=n(c,h,f.subarray(0,f.length-r));return y.push(g),f.set(g,a.length),Mt(...y),f},decrypt(a){if(nt(a),a.length<r)throw Error("aes/gcm: ciphertext less than tagLen (16)");const{xk:o,authKey:c,counter:u,tagMask:h}=s(),f=[o,c,h,u];ne(a)||f.push(a=jt(a));const y=a.subarray(0,-16),g=a.subarray(-16),A=n(c,h,y);if(f.push(A),!Z1(A,g))throw Error("aes/gcm: invalid ghash tag");const d=vi(o,!1,u,y);return Mt(...f),d}}});function nc(i){return i!=null&&typeof i=="object"&&(i instanceof Uint32Array||i.constructor.name==="Uint32Array")}function sc(i,t){if(nt(t,16),!nc(i))throw Error("_encryptBlock accepts result of expandKeyLE");const e=ht(t);let{s0:r,s1:n,s2:s,s3:a}=ye(i,e[0],e[1],e[2],e[3]);return e[0]=r,e[1]=n,e[2]=s,e[3]=a,t}function ac(i,t){if(nt(t,16),!nc(i))throw Error("_decryptBlock accepts result of expandKeyLE");const e=ht(t);let{s0:r,s1:n,s2:s,s3:a}=qn(i,e[0],e[1],e[2],e[3]);return e[0]=r,e[1]=n,e[2]=s,e[3]=a,t}const go={encrypt(i,t){if(t.length>=2**32)throw Error("plaintext should be less than 4gb");const e=Tr(i);if(t.length===16)sc(e,t);else{const r=ht(t);let n=r[0],s=r[1];for(let a=0,o=1;a<6;a++)for(let c=2;c<r.length;c+=2,o++){const{s0:u,s1:h,s2:f,s3:y}=ye(e,n,s,r[c],r[c+1]);n=u,s=h^yo(o),r[c]=f,r[c+1]=y}r[0]=n,r[1]=s}e.fill(0)},decrypt(i,t){if(t.length-8>=2**32)throw Error("ciphertext should be less than 4gb");const e=Ia(i),r=t.length/8-1;if(r===1)ac(e,t);else{const n=ht(t);let s=n[0],a=n[1];for(let o=0,c=6*r;o<6;o++)for(let u=2*r;u>=1;u-=2,c--){a^=yo(c);const{s0:h,s1:f,s2:y,s3:g}=qn(e,s,a,n[u],n[u+1]);s=h,a=f,n[u]=y,n[u+1]=g}n[0]=s,n[1]=a}e.fill(0)}},po=new Uint8Array(8).fill(166),oc=Vi({blockSize:8},i=>({encrypt(t){if(nt(t),!t.length||t.length%8!=0)throw Error("invalid plaintext length");if(t.length===8)throw Error("8-byte keys not allowed in AESKW, use AESKWP instead");const e=function(...r){let n=0;for(let a=0;a<r.length;a++){const o=r[a];nt(o),n+=o.length}const s=new Uint8Array(n);for(let a=0,o=0;a<r.length;a++){const c=r[a];s.set(c,o),o+=c.length}return s}(po,t);return go.encrypt(i,e),e},decrypt(t){if(nt(t),t.length%8!=0||t.length<24)throw Error("invalid ciphertext length");const e=jt(t);if(go.decrypt(i,e),!Z1(e.subarray(0,8),po))throw Error("integrity check failed");return e.subarray(0,8).fill(0),e.subarray(8)}})),Ao={expandKeyLE:Tr,expandKeyDecLE:Ia,encrypt:ye,decrypt:qn,encryptBlock:sc,decryptBlock:ac,ctrCounter:ec,ctr32:vi};async function cc(i){switch(i){case l.symmetric.aes128:case l.symmetric.aes192:case l.symmetric.aes256:throw Error("Not a legacy cipher");case l.symmetric.cast5:case l.symmetric.blowfish:case l.symmetric.twofish:case l.symmetric.tripledes:{const{legacyCiphers:t}=await Promise.resolve().then(function(){return F2}),e=l.read(l.symmetric,i),r=t.get(e);if(!r)throw Error("Unsupported cipher algorithm");return r}default:throw Error("Unsupported cipher algorithm")}}function d0(i){switch(i){case l.symmetric.aes128:case l.symmetric.aes192:case l.symmetric.aes256:case l.symmetric.twofish:return 16;case l.symmetric.blowfish:case l.symmetric.cast5:case l.symmetric.tripledes:return 8;default:throw Error("Unsupported cipher")}}function A0(i){switch(i){case l.symmetric.aes128:case l.symmetric.blowfish:case l.symmetric.cast5:return 16;case l.symmetric.aes192:case l.symmetric.tripledes:return 24;case l.symmetric.aes256:case l.symmetric.twofish:return 32;default:throw Error("Unsupported cipher")}}function ct(i){return{keySize:A0(i),blockSize:d0(i)}}const $r=p.getWebCrypto();async function Js(i,t,e){const{keySize:r}=ct(i);if(!p.isAES(i)||t.length!==r)throw Error("Unexpected algorithm or key size");try{const n=await $r.importKey("raw",t,{name:"AES-KW"},!1,["wrapKey"]),s=await $r.importKey("raw",e,{name:"HMAC",hash:"SHA-256"},!0,["sign"]),a=await $r.wrapKey("raw",s,n,{name:"AES-KW"});return new Uint8Array(a)}catch(n){if(n.name!=="NotSupportedError"&&(t.length!==24||n.name!=="OperationError"))throw n;p.printDebugError("Browser did not support operation: "+n.message)}return oc(t).encrypt(e)}async function Ys(i,t,e){const{keySize:r}=ct(i);if(!p.isAES(i)||t.length!==r)throw Error("Unexpected algorithm or key size");let n;try{n=await $r.importKey("raw",t,{name:"AES-KW"},!1,["unwrapKey"])}catch(s){if(s.name!=="NotSupportedError"&&(t.length!==24||s.name!=="OperationError"))throw s;return p.printDebugError("Browser did not support operation: "+s.message),oc(t).decrypt(e)}try{const s=await $r.unwrapKey("raw",e,n,{name:"AES-KW"},{name:"HMAC",hash:"SHA-256"},!0,["sign"]);return new Uint8Array(await $r.exportKey("raw",s))}catch(s){throw s.name==="OperationError"?Error("Key Data Integrity failed"):s}}const wo=p.getWebCrypto();async function yr(i,t,e,r,n){const s=l.read(l.webHash,i);if(!s)throw Error("Hash algo not supported with HKDF");const a=await wo.importKey("raw",t,"HKDF",!1,["deriveBits"]),o=await wo.deriveBits({name:"HKDF",hash:s,salt:e,info:r},a,8*n);return new Uint8Array(o)}const Cn={x25519:p.encodeUTF8("OpenPGP X25519"),x448:p.encodeUTF8("OpenPGP X448")};async function Sa(i){switch(i){case l.publicKey.x25519:{const t=Dt(32),{publicKey:e}=yt.box.keyPair.fromSecretKey(t);return{A:e,k:t}}case l.publicKey.x448:{const t=await p.getNobleCurve(l.publicKey.x448),e=t.utils.randomPrivateKey();return{A:t.getPublicKey(e),k:e}}default:throw Error("Unsupported ECDH algorithm")}}async function uc(i,t,e){switch(i){case l.publicKey.x25519:{const{publicKey:r}=yt.box.keyPair.fromSecretKey(e);return p.equalsUint8Array(t,r)}case l.publicKey.x448:{const r=(await p.getNobleCurve(l.publicKey.x448)).getPublicKey(e);return p.equalsUint8Array(t,r)}default:return!1}}async function hc(i,t,e){const{ephemeralPublicKey:r,sharedSecret:n}=await Ka(i,e),s=p.concatUint8Array([r,e,n]);switch(i){case l.publicKey.x25519:{const a=l.symmetric.aes128,{keySize:o}=ct(a),c=await yr(l.hash.sha256,s,new Uint8Array,Cn.x25519,o);return{ephemeralPublicKey:r,wrappedKey:await Js(a,c,t)}}case l.publicKey.x448:{const a=l.symmetric.aes256,{keySize:o}=ct(l.symmetric.aes256),c=await yr(l.hash.sha512,s,new Uint8Array,Cn.x448,o);return{ephemeralPublicKey:r,wrappedKey:await Js(a,c,t)}}default:throw Error("Unsupported ECDH algorithm")}}async function lc(i,t,e,r,n){const s=await Ua(i,t,r,n),a=p.concatUint8Array([t,r,s]);switch(i){case l.publicKey.x25519:{const o=l.symmetric.aes128,{keySize:c}=ct(o);return Ys(o,await yr(l.hash.sha256,a,new Uint8Array,Cn.x25519,c),e)}case l.publicKey.x448:{const o=l.symmetric.aes256,{keySize:c}=ct(l.symmetric.aes256);return Ys(o,await yr(l.hash.sha512,a,new Uint8Array,Cn.x448,c),e)}default:throw Error("Unsupported ECDH algorithm")}}function Ca(i){switch(i){case l.publicKey.x25519:return 32;case l.publicKey.x448:return 56;default:throw Error("Unsupported ECDH algorithm")}}async function Ka(i,t){switch(i){case l.publicKey.x25519:{const e=Dt(Ca(i)),r=yt.scalarMult(e,t);Kn(r);const{publicKey:n}=yt.box.keyPair.fromSecretKey(e);return{ephemeralPublicKey:n,sharedSecret:r}}case l.publicKey.x448:{const e=await p.getNobleCurve(l.publicKey.x448),r=e.utils.randomPrivateKey(),n=e.getSharedSecret(r,t);return Kn(n),{ephemeralPublicKey:e.getPublicKey(r),sharedSecret:n}}default:throw Error("Unsupported ECDH algorithm")}}async function Ua(i,t,e,r){switch(i){case l.publicKey.x25519:{const n=yt.scalarMult(r,t);return Kn(n),n}case l.publicKey.x448:{const n=(await p.getNobleCurve(l.publicKey.x448)).getSharedSecret(r,t);return Kn(n),n}default:throw Error("Unsupported ECDH algorithm")}}function Kn(i){let t=0;for(let e=0;e<i.length;e++)t|=i[e];if(t===0)throw Error("Unexpected low order point")}var w0=Object.freeze({__proto__:null,decrypt:lc,encrypt:hc,generate:Sa,generateEphemeralEncryptionMaterial:Ka,getPayloadSize:Ca,recomputeSharedSecret:Ua,validateParams:uc});const ys=p.getWebCrypto(),Un=p.getNodeCrypto(),Ie={[l.curve.nistP256]:"P-256",[l.curve.nistP384]:"P-384",[l.curve.nistP521]:"P-521"},xe=Un?Un.getCurves():[],me=Un?{[l.curve.secp256k1]:xe.includes("secp256k1")?"secp256k1":void 0,[l.curve.nistP256]:xe.includes("prime256v1")?"prime256v1":void 0,[l.curve.nistP384]:xe.includes("secp384r1")?"secp384r1":void 0,[l.curve.nistP521]:xe.includes("secp521r1")?"secp521r1":void 0,[l.curve.ed25519Legacy]:xe.includes("ED25519")?"ED25519":void 0,[l.curve.curve25519Legacy]:xe.includes("X25519")?"X25519":void 0,[l.curve.brainpoolP256r1]:xe.includes("brainpoolP256r1")?"brainpoolP256r1":void 0,[l.curve.brainpoolP384r1]:xe.includes("brainpoolP384r1")?"brainpoolP384r1":void 0,[l.curve.brainpoolP512r1]:xe.includes("brainpoolP512r1")?"brainpoolP512r1":void 0}:{},fc={[l.curve.nistP256]:{oid:[6,8,42,134,72,206,61,3,1,7],keyType:l.publicKey.ecdsa,hash:l.hash.sha256,cipher:l.symmetric.aes128,node:me[l.curve.nistP256],web:Ie[l.curve.nistP256],payloadSize:32,sharedSize:256,wireFormatLeadingByte:4},[l.curve.nistP384]:{oid:[6,5,43,129,4,0,34],keyType:l.publicKey.ecdsa,hash:l.hash.sha384,cipher:l.symmetric.aes192,node:me[l.curve.nistP384],web:Ie[l.curve.nistP384],payloadSize:48,sharedSize:384,wireFormatLeadingByte:4},[l.curve.nistP521]:{oid:[6,5,43,129,4,0,35],keyType:l.publicKey.ecdsa,hash:l.hash.sha512,cipher:l.symmetric.aes256,node:me[l.curve.nistP521],web:Ie[l.curve.nistP521],payloadSize:66,sharedSize:528,wireFormatLeadingByte:4},[l.curve.secp256k1]:{oid:[6,5,43,129,4,0,10],keyType:l.publicKey.ecdsa,hash:l.hash.sha256,cipher:l.symmetric.aes128,node:me[l.curve.secp256k1],payloadSize:32,wireFormatLeadingByte:4},[l.curve.ed25519Legacy]:{oid:[6,9,43,6,1,4,1,218,71,15,1],keyType:l.publicKey.eddsaLegacy,hash:l.hash.sha512,node:!1,payloadSize:32,wireFormatLeadingByte:64},[l.curve.curve25519Legacy]:{oid:[6,10,43,6,1,4,1,151,85,1,5,1],keyType:l.publicKey.ecdh,hash:l.hash.sha256,cipher:l.symmetric.aes128,node:!1,payloadSize:32,wireFormatLeadingByte:64},[l.curve.brainpoolP256r1]:{oid:[6,9,43,36,3,3,2,8,1,1,7],keyType:l.publicKey.ecdsa,hash:l.hash.sha256,cipher:l.symmetric.aes128,node:me[l.curve.brainpoolP256r1],payloadSize:32,wireFormatLeadingByte:4},[l.curve.brainpoolP384r1]:{oid:[6,9,43,36,3,3,2,8,1,1,11],keyType:l.publicKey.ecdsa,hash:l.hash.sha384,cipher:l.symmetric.aes192,node:me[l.curve.brainpoolP384r1],payloadSize:48,wireFormatLeadingByte:4},[l.curve.brainpoolP512r1]:{oid:[6,9,43,36,3,3,2,8,1,1,13],keyType:l.publicKey.ecdsa,hash:l.hash.sha512,cipher:l.symmetric.aes256,node:me[l.curve.brainpoolP512r1],payloadSize:64,wireFormatLeadingByte:4}};class ae{constructor(t){try{this.name=t instanceof He?t.getName():l.write(l.curve,t)}catch{throw new ot("Unknown curve")}const e=fc[this.name];this.keyType=e.keyType,this.oid=e.oid,this.hash=e.hash,this.cipher=e.cipher,this.node=e.node,this.web=e.web,this.payloadSize=e.payloadSize,this.sharedSize=e.sharedSize,this.wireFormatLeadingByte=e.wireFormatLeadingByte,this.web&&p.getWebCrypto()?this.type="web":this.node&&p.getNodeCrypto()?this.type="node":this.name===l.curve.curve25519Legacy?this.type="curve25519Legacy":this.name===l.curve.ed25519Legacy&&(this.type="ed25519Legacy")}async genKeyPair(){switch(this.type){case"web":try{return await async function(t,e){const r=await ys.generateKey({name:"ECDSA",namedCurve:Ie[t]},!0,["sign","verify"]),n=await ys.exportKey("jwk",r.privateKey);return{publicKey:pc(await ys.exportKey("jwk",r.publicKey),e),privateKey:fe(n.d)}}(this.name,this.wireFormatLeadingByte)}catch(t){return p.printDebugError("Browser did not support generating ec key "+t.message),mo(this.name)}case"node":return async function(t){const e=Un.createECDH(me[t]);return await e.generateKeys(),{publicKey:new Uint8Array(e.getPublicKey()),privateKey:new Uint8Array(e.getPrivateKey())}}(this.name);case"curve25519Legacy":{const{k:t,A:e}=await Sa(l.publicKey.x25519),r=t.slice().reverse();return r[0]=127&r[0]|64,r[31]&=248,{publicKey:p.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),e]),privateKey:r}}case"ed25519Legacy":{const{seed:t,A:e}=await wa(l.publicKey.ed25519);return{publicKey:p.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),e]),privateKey:t}}default:return mo(this.name)}}}async function yn(i){const t=new ae(i),{oid:e,hash:r,cipher:n}=t,s=await t.genKeyPair();return{oid:e,Q:s.publicKey,secret:p.leftPad(s.privateKey,t.payloadSize),hash:r,cipher:n}}function yc(i){return fc[i.getName()].hash}async function gc(i,t,e,r){const n={[l.curve.nistP256]:!0,[l.curve.nistP384]:!0,[l.curve.nistP521]:!0,[l.curve.secp256k1]:!0,[l.curve.curve25519Legacy]:i===l.publicKey.ecdh,[l.curve.brainpoolP256r1]:!0,[l.curve.brainpoolP384r1]:!0,[l.curve.brainpoolP512r1]:!0},s=t.getName();if(!n[s])return!1;if(s===l.curve.curve25519Legacy){r=r.slice().reverse();const{publicKey:o}=yt.box.keyPair.fromSecretKey(r);e=new Uint8Array(e);const c=new Uint8Array([64,...o]);return!!p.equalsUint8Array(c,e)}const a=(await p.getNobleCurve(l.publicKey.ecdsa,s)).getPublicKey(r,!1);return!!p.equalsUint8Array(a,e)}function Dr(i,t){const{payloadSize:e,wireFormatLeadingByte:r,name:n}=i,s=n===l.curve.curve25519Legacy||n===l.curve.ed25519Legacy?e:2*e;if(t[0]!==r||t.length!==s+1)throw Error("Invalid point encoding")}async function mo(i){const t=await p.getNobleCurve(l.publicKey.ecdsa,i),e=t.utils.randomPrivateKey();return{publicKey:t.getPublicKey(e,!1),privateKey:e}}function pc(i,t){const e=fe(i.x),r=fe(i.y),n=new Uint8Array(e.length+r.length+1);return n[0]=t,n.set(e,1),n.set(r,e.length+1),n}function _n(i,t,e){const r=i,n=e.slice(1,r+1),s=e.slice(r+1,2*r+1);return{kty:"EC",crv:t,x:Nt(n),y:Nt(s),ext:!0}}function dc(i,t,e,r){const n=_n(i,t,e);return n.d=Nt(r),n}const Dn=p.getWebCrypto(),Ac=p.getNodeCrypto();async function Zs(i,t,e,r,n,s){const a=new ae(i);if(Dr(a,r),e&&!p.isStream(e)){const c={publicKey:r,privateKey:n};switch(a.type){case"web":try{return await async function(u,h,f,y){const g=u.payloadSize,A=dc(u.payloadSize,Ie[u.name],y.publicKey,y.privateKey),d=await Dn.importKey("jwk",A,{name:"ECDSA",namedCurve:Ie[u.name],hash:{name:l.read(l.webHash,u.hash)}},!1,["sign"]),w=new Uint8Array(await Dn.sign({name:"ECDSA",namedCurve:Ie[u.name],hash:{name:l.read(l.webHash,h)}},d,f));return{r:w.slice(0,g),s:w.slice(g,g<<1)}}(a,t,e,c)}catch(u){if(a.name!=="nistP521"&&(u.name==="DataError"||u.name==="OperationError"))throw u;p.printDebugError("Browser did not support signing: "+u.message)}break;case"node":return async function(u,h,f,y){const g=p.nodeRequire("eckey-utils"),A=p.getNodeBuffer(),{privateKey:d}=g.generateDer({curveName:me[u.name],privateKey:A.from(y)}),w=Ac.createSign(l.read(l.hash,h));w.write(f),w.end();const k=new Uint8Array(w.sign({key:d,format:"der",type:"sec1",dsaEncoding:"ieee-p1363"})),v=u.payloadSize;return{r:k.subarray(0,v),s:k.subarray(v,v<<1)}}(a,t,e,n)}}const o=(await p.getNobleCurve(l.publicKey.ecdsa,a.name)).sign(s,n,{lowS:!1});return{r:kt(o.r,"be",a.payloadSize),s:kt(o.s,"be",a.payloadSize)}}async function Ws(i,t,e,r,n,s){const a=new ae(i);Dr(a,n);const o=async()=>s[0]===0&&bo(a,e,s.subarray(1),n);if(r&&!p.isStream(r))switch(a.type){case"web":try{return await async function(u,h,{r:f,s:y},g,A){const d=_n(u.payloadSize,Ie[u.name],A),w=await Dn.importKey("jwk",d,{name:"ECDSA",namedCurve:Ie[u.name],hash:{name:l.read(l.webHash,u.hash)}},!1,["verify"]),k=p.concatUint8Array([f,y]).buffer;return Dn.verify({name:"ECDSA",namedCurve:Ie[u.name],hash:{name:l.read(l.webHash,h)}},w,k,g)}(a,t,e,r,n)||o()}catch(c){if(a.name!=="nistP521"&&(c.name==="DataError"||c.name==="OperationError"))throw c;p.printDebugError("Browser did not support verifying: "+c.message)}break;case"node":return await async function(u,h,{r:f,s:y},g,A){const d=p.nodeRequire("eckey-utils"),w=p.getNodeBuffer(),{publicKey:k}=d.generateDer({curveName:me[u.name],publicKey:w.from(A)}),v=Ac.createVerify(l.read(l.hash,h));v.write(g),v.end();const b=p.concatUint8Array([f,y]);try{return v.verify({key:k,format:"der",type:"spki",dsaEncoding:"ieee-p1363"},b)}catch{return!1}}(a,t,e,r,n)||o()}return await bo(a,e,s,n)||o()}async function bo(i,t,e,r){return(await p.getNobleCurve(l.publicKey.ecdsa,i.name)).verify(p.concatUint8Array([t.r,t.s]),e,r,{lowS:!1})}var m0=Object.freeze({__proto__:null,sign:Zs,validateParams:async function(i,t,e){const r=new ae(i);if(r.keyType!==l.publicKey.ecdsa)return!1;switch(r.type){case"web":case"node":{const n=Dt(8),s=l.hash.sha256,a=await Ue(s,n);try{const o=await Zs(i,s,n,t,e,a);return await Ws(i,s,o,n,t,a)}catch{return!1}}default:return gc(l.publicKey.ecdsa,i,t,e)}},verify:Ws});async function wc(i,t,e,r,n,s){if(Dr(new ae(i),r),Bt(t)<Bt(l.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const{RS:a}=await ma(l.publicKey.ed25519,t,0,r.subarray(1),n,s);return{r:a.subarray(0,32),s:a.subarray(32)}}async function mc(i,t,{r:e,s:r},n,s,a){if(Dr(new ae(i),s),Bt(t)<Bt(l.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const o=p.concatUint8Array([e,r]);return ba(l.publicKey.ed25519,t,{RS:o},0,s.subarray(1),a)}async function bc(i,t,e){if(i.getName()!==l.curve.ed25519Legacy)return!1;const{publicKey:r}=yt.sign.keyPair.fromSeed(e),n=new Uint8Array([64,...r]);return p.equalsUint8Array(t,n)}var b0=Object.freeze({__proto__:null,sign:wc,validateParams:bc,verify:mc});function k0(i){const t=i.length;if(t>0){const e=i[t-1];if(e>=1){const r=i.subarray(t-e),n=new Uint8Array(e).fill(e);if(p.equalsUint8Array(r,n))return i.subarray(0,t-e)}}throw Error("Invalid padding")}const ar=p.getWebCrypto(),kc=p.getNodeCrypto();function Ec(i,t,e,r){return p.concatUint8Array([t.write(),new Uint8Array([i]),e.write(),p.stringToUint8Array("Anonymous Sender    "),r])}async function vc(i,t,e,r,n=!1,s=!1){let a;if(n){for(a=0;a<t.length&&t[a]===0;a++);t=t.subarray(a)}if(s){for(a=t.length-1;a>=0&&t[a]===0;a--);t=t.subarray(0,a+1)}return(await Ue(i,p.concatUint8Array([new Uint8Array([0,0,0,1]),t,r]))).subarray(0,e)}async function E0(i,t){switch(i.type){case"curve25519Legacy":{const{sharedSecret:e,ephemeralPublicKey:r}=await Ka(l.publicKey.x25519,t.subarray(1));return{publicKey:p.concatUint8Array([new Uint8Array([i.wireFormatLeadingByte]),r]),sharedKey:e}}case"web":if(i.web&&p.getWebCrypto())try{return await async function(e,r){const n=_n(e.payloadSize,e.web,r);let s=ar.generateKey({name:"ECDH",namedCurve:e.web},!0,["deriveKey","deriveBits"]),a=ar.importKey("jwk",n,{name:"ECDH",namedCurve:e.web},!1,[]);[s,a]=await Promise.all([s,a]);let o=ar.deriveBits({name:"ECDH",namedCurve:e.web,public:a},s.privateKey,e.sharedSize),c=ar.exportKey("jwk",s.publicKey);[o,c]=await Promise.all([o,c]);const u=new Uint8Array(o);return{publicKey:new Uint8Array(pc(c,e.wireFormatLeadingByte)),sharedKey:u}}(i,t)}catch(e){return p.printDebugError(e),Eo(i,t)}break;case"node":return async function(e,r){const n=kc.createECDH(e.node);n.generateKeys();const s=new Uint8Array(n.computeSecret(r));return{publicKey:new Uint8Array(n.getPublicKey()),sharedKey:s}}(i,t);default:return Eo(i,t)}}async function Bc(i,t,e,r,n){const s=function(y){const g=8-y.length%8,A=new Uint8Array(y.length+g).fill(g);return A.set(y),A}(e),a=new ae(i);Dr(a,r);const{publicKey:o,sharedKey:c}=await E0(a,r),u=Ec(l.publicKey.ecdh,i,t,n),{keySize:h}=ct(t.cipher),f=await vc(t.hash,c,h,u);return{publicKey:o,wrappedKey:await Js(t.cipher,f,s)}}async function v0(i,t,e,r){if(r.length!==i.payloadSize){const n=new Uint8Array(i.payloadSize);n.set(r,i.payloadSize-r.length),r=n}switch(i.type){case"curve25519Legacy":{const n=r.slice().reverse();return{secretKey:n,sharedKey:await Ua(l.publicKey.x25519,t.subarray(1),e.subarray(1),n)}}case"web":if(i.web&&p.getWebCrypto())try{return await async function(n,s,a,o){const c=dc(n.payloadSize,n.web,a,o);let u=ar.importKey("jwk",c,{name:"ECDH",namedCurve:n.web},!0,["deriveKey","deriveBits"]);const h=_n(n.payloadSize,n.web,s);let f=ar.importKey("jwk",h,{name:"ECDH",namedCurve:n.web},!0,[]);[u,f]=await Promise.all([u,f]);let y=ar.deriveBits({name:"ECDH",namedCurve:n.web,public:f},u,n.sharedSize),g=ar.exportKey("jwk",u);[y,g]=await Promise.all([y,g]);const A=new Uint8Array(y);return{secretKey:fe(g.d),sharedKey:A}}(i,t,e,r)}catch(n){return p.printDebugError(n),ko(i,t,r)}break;case"node":return async function(n,s,a){const o=kc.createECDH(n.node);o.setPrivateKey(a);const c=new Uint8Array(o.computeSecret(s));return{secretKey:new Uint8Array(o.getPrivateKey()),sharedKey:c}}(i,t,r);default:return ko(i,t,r)}}async function Ic(i,t,e,r,n,s,a){const o=new ae(i);Dr(o,n),Dr(o,e);const{sharedKey:c}=await v0(o,e,n,s),u=Ec(l.publicKey.ecdh,i,t,a),{keySize:h}=ct(t.cipher);let f;for(let y=0;y<3;y++)try{const g=await vc(t.hash,c,h,u,y===1,y===2);return k0(await Ys(t.cipher,g,r))}catch(g){f=g}throw f}async function ko(i,t,e){return{secretKey:e,sharedKey:(await p.getNobleCurve(l.publicKey.ecdh,i.name)).getSharedSecret(e,t).subarray(1)}}async function Eo(i,t){const e=await p.getNobleCurve(l.publicKey.ecdh,i.name),{publicKey:r,privateKey:n}=await i.genKeyPair();return{publicKey:r,sharedKey:e.getSharedSecret(n,t).subarray(1)}}var B0=Object.freeze({__proto__:null,CurveWithOID:ae,ecdh:Object.freeze({__proto__:null,decrypt:Ic,encrypt:Bc,validateParams:async function(i,t,e){return gc(l.publicKey.ecdh,i,t,e)}}),ecdhX:w0,ecdsa:m0,eddsa:u0,eddsaLegacy:b0,generate:yn,getPreferredHashAlgo:yc});const gn=BigInt(0),Bi=BigInt(1);class Sc{constructor(t){t&&(this.data=t)}read(t){if(t.length>=1){const e=t[0];if(t.length>=1+e)return this.data=t.subarray(1,1+e),1+this.data.length}throw Error("Invalid symmetric key")}write(){return p.concatUint8Array([new Uint8Array([this.data.length]),this.data])}}class Cc{constructor(t){if(t){const{hash:e,cipher:r}=t;this.hash=e,this.cipher=r}else this.hash=null,this.cipher=null}read(t){if(t.length<4||t[0]!==3||t[1]!==1)throw new ot("Cannot read KDFParams");return this.hash=t[2],this.cipher=t[3],4}write(){return new Uint8Array([3,1,this.hash,this.cipher])}}class jn{static fromObject({wrappedKey:t,algorithm:e}){const r=new jn;return r.wrappedKey=t,r.algorithm=e,r}read(t){let e=0,r=t[e++];this.algorithm=r%2?t[e++]:null,r-=r%2,this.wrappedKey=p.readExactSubarray(t,e,e+r),e+=r}write(){return p.concatUint8Array([this.algorithm?new Uint8Array([this.wrappedKey.length+1,this.algorithm]):new Uint8Array([this.wrappedKey.length]),this.wrappedKey])}}async function I0(i,t,e,r,n){switch(i){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:{const{n:s,e:a}=e;return{c:await $3(r,s,a)}}case l.publicKey.elgamal:{const{p:s,g:a,y:o}=e;return async function(c,u,h,f){u=V(u),h=V(h),f=V(f);const y=V(Q1(c,Yt(u))),g=ur(rr,u-rr);return{c1:kt(Ut(h,g,u)),c2:kt(tt(Ut(f,g,u)*y,u))}}(r,s,a,o)}case l.publicKey.ecdh:{const{oid:s,Q:a,kdfParams:o}=e,{publicKey:c,wrappedKey:u}=await Bc(s,o,r,a,n);return{V:c,C:new Sc(u)}}case l.publicKey.x25519:case l.publicKey.x448:{if(t&&!p.isAES(t))throw Error("X25519 and X448 keys can only encrypt AES session keys");const{A:s}=e,{ephemeralPublicKey:a,wrappedKey:o}=await hc(i,r,s);return{ephemeralPublicKey:a,C:jn.fromObject({algorithm:t,wrappedKey:o})}}default:return[]}}async function S0(i,t,e,r,n,s){switch(i){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:{const{c:a}=r,{n:o,e:c}=t,{d:u,p:h,q:f,u:y}=e;return X3(a,o,c,u,h,f,y,s)}case l.publicKey.elgamal:{const{c1:a,c2:o}=r;return async function(c,u,h,f,y){return c=V(c),u=V(u),h=V(h),R1(kt(tt(ti(Ut(c,f=V(f),h),h)*u,h),"be",Yt(h)),y)}(a,o,t.p,e.x,s)}case l.publicKey.ecdh:{const{oid:a,Q:o,kdfParams:c}=t,{d:u}=e,{V:h,C:f}=r;return Ic(a,c,h,f.data,o,u,n)}case l.publicKey.x25519:case l.publicKey.x448:{const{A:a}=t,{k:o}=e,{ephemeralPublicKey:c,C:u}=r;if(u.algorithm!==null&&!p.isAES(u.algorithm))throw Error("AES session key expected");return lc(i,c,u.wrappedKey,a,o)}default:throw Error("Unknown public key encryption algorithm.")}}function vo(i,t,e){let r=0;switch(i){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:{const n=p.readMPI(t.subarray(r));r+=n.length+2;const s=p.readMPI(t.subarray(r));r+=s.length+2;const a=p.readMPI(t.subarray(r));r+=a.length+2;const o=p.readMPI(t.subarray(r));return r+=o.length+2,{read:r,privateParams:{d:n,p:s,q:a,u:o}}}case l.publicKey.dsa:case l.publicKey.elgamal:{const n=p.readMPI(t.subarray(r));return r+=n.length+2,{read:r,privateParams:{x:n}}}case l.publicKey.ecdsa:case l.publicKey.ecdh:{const n=Vr(i,e.oid);let s=p.readMPI(t.subarray(r));return r+=s.length+2,s=p.leftPad(s,n),{read:r,privateParams:{d:s}}}case l.publicKey.eddsaLegacy:{const n=Vr(i,e.oid);if(e.oid.getName()!==l.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let s=p.readMPI(t.subarray(r));return r+=s.length+2,s=p.leftPad(s,n),{read:r,privateParams:{seed:s}}}case l.publicKey.ed25519:case l.publicKey.ed448:{const n=Vr(i),s=p.readExactSubarray(t,r,r+n);return r+=s.length,{read:r,privateParams:{seed:s}}}case l.publicKey.x25519:case l.publicKey.x448:{const n=Vr(i),s=p.readExactSubarray(t,r,r+n);return r+=s.length,{read:r,privateParams:{k:s}}}default:throw new ot("Unknown public key encryption algorithm.")}}function ri(i,t){const e=new Set([l.publicKey.ed25519,l.publicKey.x25519,l.publicKey.ed448,l.publicKey.x448]),r=Object.keys(t).map(n=>{const s=t[n];return p.isUint8Array(s)?e.has(i)?s:p.uint8ArrayToMPI(s):s.write()});return p.concatUint8Array(r)}function C0(i,t,e){switch(i){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:return async function(r,n){if(n=BigInt(n),p.getWebCrypto()){const u={name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:kt(n),hash:{name:"SHA-1"}},h=await ei.generateKey(u,!0,["sign","verify"]);return eo(await ei.exportKey("jwk",h.privateKey),n)}if(p.getNodeCrypto()){const u={modulusLength:r,publicExponent:Fs(n),publicKeyEncoding:{type:"pkcs1",format:"jwk"},privateKeyEncoding:{type:"pkcs1",format:"jwk"}},h=await new Promise((f,y)=>{Ur.generateKeyPair("rsa",u,(g,A,d)=>{g?y(g):f(d)})});return eo(h,n)}let s,a,o;do a=Xa(r-(r>>1),n,40),s=Xa(r>>1,n,40),o=s*a;while(Wr(o)!==r);const c=(s-fr)*(a-fr);return a<s&&([s,a]=[a,s]),{n:kt(o),e:kt(n),d:kt(ti(n,c)),p:kt(s),q:kt(a),u:kt(ti(s,a))}}(t,65537).then(({n:r,e:n,d:s,p:a,q:o,u:c})=>({privateParams:{d:s,p:a,q:o,u:c},publicParams:{n:r,e:n}}));case l.publicKey.ecdsa:return yn(e).then(({oid:r,Q:n,secret:s})=>({privateParams:{d:s},publicParams:{oid:new He(r),Q:n}}));case l.publicKey.eddsaLegacy:return yn(e).then(({oid:r,Q:n,secret:s})=>({privateParams:{seed:s},publicParams:{oid:new He(r),Q:n}}));case l.publicKey.ecdh:return yn(e).then(({oid:r,Q:n,secret:s,hash:a,cipher:o})=>({privateParams:{d:s},publicParams:{oid:new He(r),Q:n,kdfParams:new Cc({hash:a,cipher:o})}}));case l.publicKey.ed25519:case l.publicKey.ed448:return wa(i).then(({A:r,seed:n})=>({privateParams:{seed:n},publicParams:{A:r}}));case l.publicKey.x25519:case l.publicKey.x448:return Sa(i).then(({A:r,k:n})=>({privateParams:{k:n},publicParams:{A:r}}));case l.publicKey.dsa:case l.publicKey.elgamal:throw Error("Unsupported algorithm for key generation.");default:throw Error("Unknown public key algorithm.")}}async function K0(i,t,e){if(!t||!e)throw Error("Missing key parameters");switch(i){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:{const{n:r,e:n}=t,{d:s,p:a,q:o,u:c}=e;return async function(u,h,f,y,g,A){if(u=V(u),(y=V(y))*(g=V(g))!==u)return!1;const d=BigInt(2);if(tt(y*(A=V(A)),g)!==BigInt(1))return!1;h=V(h),f=V(f);const w=ur(d,d<<BigInt(Math.floor(Wr(u)/3))),k=w*f*h;return!(tt(k,y-fr)!==w||tt(k,g-fr)!==w)}(r,n,s,a,o,c)}case l.publicKey.dsa:{const{p:r,q:n,g:s,y:a}=t,{x:o}=e;return async function(c,u,h,f,y){if(c=V(c),u=V(u),h=V(h),f=V(f),h<=Bi||h>=c||tt(c-Bi,u)!==gn||Ut(h,u,c)!==Bi)return!1;const g=BigInt(Wr(u));if(g<BigInt(150)||!x1(u,null,32))return!1;y=V(y);const A=BigInt(2);return f===Ut(h,u*ur(A<<g-Bi,A<<g)+y,c)}(r,n,s,a,o)}case l.publicKey.elgamal:{const{p:r,g:n,y:s}=t,{x:a}=e;return async function(o,c,u,h){if(o=V(o),c=V(c),u=V(u),c<=rr||c>=o)return!1;const f=BigInt(Wr(o));if(f<BigInt(1023)||Ut(c,o-rr,o)!==rr)return!1;let y=c,g=BigInt(1);const A=BigInt(2),d=A<<BigInt(17);for(;g<d;){if(y=tt(y*c,o),y===rr)return!1;g++}h=V(h);const w=ur(A<<f-rr,A<<f);return u===Ut(c,(o-rr)*w+h,o)}(r,n,s,a)}case l.publicKey.ecdsa:case l.publicKey.ecdh:{const r=B0[l.read(l.publicKey,i)],{oid:n,Q:s}=t,{d:a}=e;return r.validateParams(n,s,a)}case l.publicKey.eddsaLegacy:{const{Q:r,oid:n}=t,{seed:s}=e;return bc(n,r,s)}case l.publicKey.ed25519:case l.publicKey.ed448:{const{A:r}=t,{seed:n}=e;return j1(i,r,n)}case l.publicKey.x25519:case l.publicKey.x448:{const{A:r}=t,{k:n}=e;return uc(i,r,n)}default:throw Error("Unknown public key algorithm.")}}function $s(i){const{keySize:t}=ct(i);return Dt(t)}function gs(i){try{i.getName()}catch{throw new ot("Unknown curve OID")}}function Vr(i,t){switch(i){case l.publicKey.ecdsa:case l.publicKey.ecdh:case l.publicKey.eddsaLegacy:return new ae(t).payloadSize;case l.publicKey.ed25519:case l.publicKey.ed448:return zn(i);case l.publicKey.x25519:case l.publicKey.x448:return Ca(i);default:throw Error("Unknown elliptic algo")}}const pn=p.getWebCrypto(),Ni=p.getNodeCrypto(),br=Ni?Ni.getCiphers():[],Pn={idea:br.includes("idea-cfb")?"idea-cfb":void 0,tripledes:br.includes("des-ede3-cfb")?"des-ede3-cfb":void 0,cast5:br.includes("cast5-cfb")?"cast5-cfb":void 0,blowfish:br.includes("bf-cfb")?"bf-cfb":void 0,aes128:br.includes("aes-128-cfb")?"aes-128-cfb":void 0,aes192:br.includes("aes-192-cfb")?"aes-192-cfb":void 0,aes256:br.includes("aes-256-cfb")?"aes-256-cfb":void 0};async function Kc(i){const{blockSize:t}=ct(i),e=await Dt(t),r=new Uint8Array([e[e.length-2],e[e.length-1]]);return p.concat([e,r])}async function Oi(i,t,e,r,n){const s=l.read(l.symmetric,i);if(p.getNodeCrypto()&&Pn[s])return function(f,y,g,A){const d=l.read(l.symmetric,f),w=new Ni.createCipheriv(Pn[d],y,A);return At(g,k=>new Uint8Array(w.update(k)))}(i,t,e,r);if(p.isAES(i))return async function(f,y,g,A){if(pn&&await Bo.isSupported(f)){const d=new Bo(f,y,A);return p.isStream(g)?At(g,w=>d.encryptChunk(w),()=>d.finish()):d.encrypt(g)}if(p.isStream(g)){const d=new Uc(!0,f,y,A);return At(g,w=>d.processChunk(w),()=>d.finish())}return ic(y,A).encrypt(g)}(i,t,e,r);const a=new(await cc(i))(t),o=a.blockSize,c=r.slice();let u=new Uint8Array;const h=f=>{f&&(u=p.concatUint8Array([u,f]));const y=new Uint8Array(u.length);let g,A=0;for(;f?u.length>=o:u.length;){const d=a.encrypt(c);for(g=0;g<o;g++)c[g]=u[g]^d[g],y[A++]=c[g];u=u.subarray(o)}return y.subarray(0,A)};return At(e,h,h)}async function Vn(i,t,e,r){const n=l.read(l.symmetric,i);if(Ni&&Pn[n])return function(h,f,y,g){const A=l.read(l.symmetric,h),d=new Ni.createDecipheriv(Pn[A],f,g);return At(y,w=>new Uint8Array(d.update(w)))}(i,t,e,r);if(p.isAES(i))return async function(h,f,y,g){if(p.isStream(y)){const A=new Uc(!1,h,f,g);return At(y,d=>A.processChunk(d),()=>A.finish())}return ic(f,g).decrypt(y)}(i,t,e,r);const s=new(await cc(i))(t),a=s.blockSize;let o=r,c=new Uint8Array;const u=h=>{h&&(c=p.concatUint8Array([c,h]));const f=new Uint8Array(c.length);let y,g=0;for(;h?c.length>=a:c.length;){const A=s.encrypt(o);for(o=c.subarray(0,a),y=0;y<a;y++)f[g++]=o[y]^A[y];c=c.subarray(a)}return f.subarray(0,g)};return At(e,u,u)}class Bo{constructor(t,e,r){const{blockSize:n}=ct(t);this.key=e,this.prevBlock=r,this.nextBlock=new Uint8Array(n),this.i=0,this.blockSize=n,this.zeroBlock=new Uint8Array(this.blockSize)}static async isSupported(t){const{keySize:e}=ct(t);return pn.importKey("raw",new Uint8Array(e),"aes-cbc",!1,["encrypt"]).then(()=>!0,()=>!1)}async _runCBC(t,e){const r="AES-CBC";this.keyRef=this.keyRef||await pn.importKey("raw",this.key,r,!1,["encrypt"]);const n=await pn.encrypt({name:r,iv:e||this.zeroBlock},this.keyRef,t);return new Uint8Array(n).subarray(0,t.length)}async encryptChunk(t){const e=this.nextBlock.length-this.i,r=t.subarray(0,e);if(this.nextBlock.set(r,this.i),this.i+t.length>=2*this.blockSize){const s=(t.length-e)%this.blockSize,a=p.concatUint8Array([this.nextBlock,t.subarray(e,t.length-s)]),o=p.concatUint8Array([this.prevBlock,a.subarray(0,a.length-this.blockSize)]),c=await this._runCBC(o);return rn(c,a),this.prevBlock=c.slice(-this.blockSize),s>0&&this.nextBlock.set(t.subarray(-s)),this.i=s,c}let n;if(this.i+=r.length,this.i===this.nextBlock.length){const s=this.nextBlock;n=await this._runCBC(this.prevBlock),rn(n,s),this.prevBlock=n.slice(),this.i=0;const a=t.subarray(r.length);this.nextBlock.set(a,this.i),this.i+=a.length}else n=new Uint8Array;return n}async finish(){let t;if(this.i===0)t=new Uint8Array;else{this.nextBlock=this.nextBlock.subarray(0,this.i);const e=this.nextBlock,r=await this._runCBC(this.prevBlock);rn(r,e),t=r.subarray(0,e.length)}return this.clearSensitiveData(),t}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.keyRef=null,this.key=null}async encrypt(t){const e=(await this._runCBC(p.concatUint8Array([new Uint8Array(this.blockSize),t]),this.iv)).subarray(0,t.length);return rn(e,t),this.clearSensitiveData(),e}}class Uc{constructor(t,e,r,n){this.forEncryption=t;const{blockSize:s}=ct(e);this.key=Ao.expandKeyLE(r),n.byteOffset%4!=0&&(n=n.slice()),this.prevBlock=ps(n),this.nextBlock=new Uint8Array(s),this.i=0,this.blockSize=s}_runCFB(t){const e=ps(t),r=new Uint8Array(t.length),n=ps(r);for(let s=0;s+4<=n.length;s+=4){const{s0:a,s1:o,s2:c,s3:u}=Ao.encrypt(this.key,this.prevBlock[0],this.prevBlock[1],this.prevBlock[2],this.prevBlock[3]);n[s+0]=e[s+0]^a,n[s+1]=e[s+1]^o,n[s+2]=e[s+2]^c,n[s+3]=e[s+3]^u,this.prevBlock=(this.forEncryption?n:e).slice(s,s+4)}return r}async processChunk(t){const e=this.nextBlock.length-this.i,r=t.subarray(0,e);if(this.nextBlock.set(r,this.i),this.i+t.length>=2*this.blockSize){const s=(t.length-e)%this.blockSize,a=p.concatUint8Array([this.nextBlock,t.subarray(e,t.length-s)]),o=this._runCFB(a);return s>0&&this.nextBlock.set(t.subarray(-s)),this.i=s,o}let n;if(this.i+=r.length,this.i===this.nextBlock.length){n=this._runCFB(this.nextBlock),this.i=0;const s=t.subarray(r.length);this.nextBlock.set(s,this.i),this.i+=s.length}else n=new Uint8Array;return n}async finish(){let t;return this.i===0?t=new Uint8Array:t=this._runCFB(this.nextBlock).subarray(0,this.i),this.clearSensitiveData(),t}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.key.fill(0)}}function rn(i,t){const e=Math.min(i.length,t.length);for(let r=0;r<e;r++)i[r]=i[r]^t[r]}const ps=i=>new Uint32Array(i.buffer,i.byteOffset,Math.floor(i.byteLength/4)),Io=p.getWebCrypto(),U0=p.getNodeCrypto(),hr=16;function So(i,t){const e=i.length-hr;for(let r=0;r<hr;r++)i[r+e]^=t[r];return i}const dn=new Uint8Array(hr);async function D0(i){const t=await P0(i),e=p.double(await t(dn)),r=p.double(e);return async function(n){return(await t(function(s,a,o){if(s.length&&s.length%hr==0)return So(s,a);const c=new Uint8Array(s.length+(hr-s.length%hr));return c.set(s),c[s.length]=128,So(c,o)}(n,e,r))).subarray(-16)}}async function P0(i){if(p.getNodeCrypto())return async function(t){const e=new U0.createCipheriv("aes-"+8*i.length+"-cbc",i,dn).update(t);return new Uint8Array(e)};if(p.getWebCrypto())try{return i=await Io.importKey("raw",i,{name:"AES-CBC",length:8*i.length},!1,["encrypt"]),async function(t){const e=await Io.encrypt({name:"AES-CBC",iv:dn,length:8*hr},i,t);return new Uint8Array(e).subarray(0,e.byteLength-hr)}}catch(t){if(t.name!=="NotSupportedError"&&(i.length!==24||t.name!=="OperationError"))throw t;p.printDebugError("Browser did not support operation: "+t.message)}return async function(t){return rc(i,dn,{disablePadding:!0}).encrypt(t)}}const Co=p.getWebCrypto(),x0=p.getNodeCrypto(),Q0=p.getNodeBuffer(),qe=16,R0=qe,An=qe,Ko=new Uint8Array(qe),Xs=new Uint8Array(qe);Xs[qe-1]=1;const ta=new Uint8Array(qe);async function T0(i){const t=await D0(i);return function(e,r){return t(p.concatUint8Array([e,r]))}}async function L0(i){if(p.getNodeCrypto())return async function(t,e){const r=new x0.createCipheriv("aes-"+8*i.length+"-ctr",i,e),n=Q0.concat([r.update(t),r.final()]);return new Uint8Array(n)};if(p.getWebCrypto())try{const t=await Co.importKey("raw",i,{name:"AES-CTR",length:8*i.length},!1,["encrypt"]);return async function(e,r){const n=await Co.encrypt({name:"AES-CTR",counter:r,length:8*qe},t,e);return new Uint8Array(n)}}catch(t){if(t.name!=="NotSupportedError"&&(i.length!==24||t.name!=="OperationError"))throw t;p.printDebugError("Browser did not support operation: "+t.message)}return async function(t,e){return p0(i,e).encrypt(t)}}async function Ii(i,t){if(i!==l.symmetric.aes128&&i!==l.symmetric.aes192&&i!==l.symmetric.aes256)throw Error("EAX mode supports only AES cipher");const[e,r]=await Promise.all([T0(t),L0(t)]);return{encrypt:async function(n,s,a){const[o,c]=await Promise.all([e(Ko,s),e(Xs,a)]),u=await r(n,o),h=await e(ta,u);for(let f=0;f<An;f++)h[f]^=c[f]^o[f];return p.concatUint8Array([u,h])},decrypt:async function(n,s,a){if(n.length<An)throw Error("Invalid EAX ciphertext");const o=n.subarray(0,-16),c=n.subarray(-16),[u,h,f]=await Promise.all([e(Ko,s),e(Xs,a),e(ta,o)]),y=f;for(let g=0;g<An;g++)y[g]^=h[g]^u[g];if(!p.equalsUint8Array(c,y))throw Error("Authentication tag mismatch");return await r(o,u)}}}ta[qe-1]=2,Ii.getNonce=function(i,t){const e=i.slice();for(let r=0;r<t.length;r++)e[8+r]^=t[r];return e},Ii.blockLength=qe,Ii.ivLength=R0,Ii.tagLength=An;const Ft=16,Dc=15,ea=16;function Uo(i){let t=0;for(let e=1;!(i&e);e<<=1)t++;return t}function Ht(i,t){for(let e=0;e<i.length;e++)i[e]^=t[e];return i}function nn(i,t){return Ht(i.slice(),t)}const sn=new Uint8Array(Ft),M0=new Uint8Array([1]);async function Si(i,t){const{keySize:e}=ct(i);if(!p.isAES(i)||t.length!==e)throw Error("Unexpected algorithm or key size");let r=0;const n=rc(t,sn,{disablePadding:!0}),s=u=>n.encrypt(u),a=u=>n.decrypt(u);let o;function c(u,h,f,y){const g=h.length/Ft|0;(function(I,m){const K=p.nbits(Math.max(I.length,m.length)/Ft|0)-1;for(let C=r+1;C<=K;C++)o[C]=p.double(o[C-1]);r=K})(h,y);const A=p.concatUint8Array([sn.subarray(0,Dc-f.length),M0,f]),d=63&A[Ft-1];A[Ft-1]&=192;const w=s(A),k=p.concatUint8Array([w,nn(w.subarray(0,8),w.subarray(1,9))]),v=p.shiftRight(k.subarray(0+(d>>3),17+(d>>3)),8-(7&d)).subarray(1),b=new Uint8Array(Ft),E=new Uint8Array(h.length+ea);let U,D=0;for(U=0;U<g;U++)Ht(v,o[Uo(U+1)]),E.set(Ht(u(nn(v,h)),v),D),Ht(b,u===s?h:E.subarray(D)),h=h.subarray(Ft),D+=Ft;if(h.length){Ht(v,o.x);const I=s(v);E.set(nn(h,I),D);const m=new Uint8Array(Ft);m.set(u===s?h:E.subarray(D,-16),0),m[h.length]=128,Ht(b,m),D+=h.length}const x=Ht(s(Ht(Ht(b,v),o.$)),function(I){if(!I.length)return sn;const m=I.length/Ft|0,K=new Uint8Array(Ft),C=new Uint8Array(Ft);for(let S=0;S<m;S++)Ht(K,o[Uo(S+1)]),Ht(C,s(nn(K,I))),I=I.subarray(Ft);if(I.length){Ht(K,o.x);const S=new Uint8Array(Ft);S.set(I,0),S[I.length]=128,Ht(S,K),Ht(C,s(S))}return C}(y));return E.set(x,D),E}return function(){const u=s(sn),h=p.double(u);o=[],o[0]=p.double(h),o.x=u,o.$=h}(),{encrypt:async function(u,h,f){return c(s,u,h,f)},decrypt:async function(u,h,f){if(u.length<ea)throw Error("Invalid OCB ciphertext");const y=u.subarray(-16);u=u.subarray(0,-16);const g=c(a,u,h,f);if(p.equalsUint8Array(y,g.subarray(-16)))return g.subarray(0,-16);throw Error("Authentication tag mismatch")}}}Si.getNonce=function(i,t){const e=i.slice();for(let r=0;r<t.length;r++)e[7+r]^=t[r];return e},Si.blockLength=Ft,Si.ivLength=Dc,Si.tagLength=ea;const ds=p.getWebCrypto(),Do=p.getNodeCrypto(),Po=p.getNodeBuffer(),Gr=16,As="AES-GCM";async function Jr(i,t){if(i!==l.symmetric.aes128&&i!==l.symmetric.aes192&&i!==l.symmetric.aes256)throw Error("GCM mode supports only AES cipher");if(p.getNodeCrypto())return{encrypt:async function(e,r,n=new Uint8Array){const s=new Do.createCipheriv("aes-"+8*t.length+"-gcm",t,r);s.setAAD(n);const a=Po.concat([s.update(e),s.final(),s.getAuthTag()]);return new Uint8Array(a)},decrypt:async function(e,r,n=new Uint8Array){const s=new Do.createDecipheriv("aes-"+8*t.length+"-gcm",t,r);s.setAAD(n),s.setAuthTag(e.slice(e.length-Gr,e.length));const a=Po.concat([s.update(e.slice(0,e.length-Gr)),s.final()]);return new Uint8Array(a)}};if(p.getWebCrypto())try{const e=await ds.importKey("raw",t,{name:As},!1,["encrypt","decrypt"]),r=navigator.userAgent.match(/Version\/13\.\d(\.\d)* Safari/)||navigator.userAgent.match(/Version\/(13|14)\.\d(\.\d)* Mobile\/\S* Safari/);return{encrypt:async function(n,s,a=new Uint8Array){if(r&&!n.length)return en(t,s,a).encrypt(n);const o=await ds.encrypt({name:As,iv:s,additionalData:a,tagLength:8*Gr},e,n);return new Uint8Array(o)},decrypt:async function(n,s,a=new Uint8Array){if(r&&n.length===Gr)return en(t,s,a).decrypt(n);try{const o=await ds.decrypt({name:As,iv:s,additionalData:a,tagLength:8*Gr},e,n);return new Uint8Array(o)}catch(o){if(o.name==="OperationError")throw Error("Authentication tag mismatch")}}}}catch(e){if(e.name!=="NotSupportedError"&&(t.length!==24||e.name!=="OperationError"))throw e;p.printDebugError("Browser did not support operation: "+e.message)}return{encrypt:async function(e,r,n){return en(t,r,n).encrypt(e)},decrypt:async function(e,r,n){return en(t,r,n).decrypt(e)}}}function ze(i,t=!1){switch(i){case l.aead.eax:return Ii;case l.aead.ocb:return Si;case l.aead.gcm:return Jr;case l.aead.experimentalGCM:if(!t)throw Error("Unexpected non-standard `experimentalGCM` AEAD algorithm provided in `config.preferredAEADAlgorithm`: use `gcm` instead");return Jr;default:throw Error("Unsupported AEAD mode")}}async function F0(i,t,e,r,n,s){switch(i){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.rsaSign:{const{n:a,e:o}=r;return W3(t,n,p.leftPad(e.s,a.length),a,o,s)}case l.publicKey.dsa:{const{g:a,p:o,q:c,y:u}=r,{r:h,s:f}=e;return async function(y,g,A,d,w,k,v,b){if(g=V(g),A=V(A),k=V(k),v=V(v),w=V(w),b=V(b),g<=gn||g>=v||A<=gn||A>=v)return p.printDebug("invalid DSA Signature"),!1;const E=tt(V(d.subarray(0,Yt(v))),v),U=ti(A,v);if(U===gn)return p.printDebug("invalid DSA Signature"),!1;w=tt(w,k),b=tt(b,k);const D=tt(E*U,v),x=tt(g*U,v);return tt(tt(Ut(w,D,k)*Ut(b,x,k),k),v)===g}(0,h,f,s,a,o,c,u)}case l.publicKey.ecdsa:{const{oid:a,Q:o}=r,c=new ae(a).payloadSize;return Ws(a,t,{r:p.leftPad(e.r,c),s:p.leftPad(e.s,c)},n,o,s)}case l.publicKey.eddsaLegacy:{const{oid:a,Q:o}=r,c=new ae(a).payloadSize;return mc(a,t,{r:p.leftPad(e.r,c),s:p.leftPad(e.s,c)},0,o,s)}case l.publicKey.ed25519:case l.publicKey.ed448:{const{A:a}=r;return ba(i,t,e,0,a,s)}default:throw Error("Unknown signature algorithm.")}}async function N0(i,t,e,r,n,s){if(!e||!r)throw Error("Missing key parameters");switch(i){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.rsaSign:{const{n:a,e:o}=e,{d:c,p:u,q:h,u:f}=r;return{s:await Z3(t,n,a,o,c,u,h,f,s)}}case l.publicKey.dsa:{const{g:a,p:o,q:c}=e,{x:u}=r;return async function(h,f,y,g,A,d){const w=BigInt(0);let k,v,b,E;g=V(g),A=V(A),y=V(y),d=V(d),y=tt(y,g),d=tt(d,A);const U=tt(V(f.subarray(0,Yt(A))),A);for(;;){if(k=ur(Bi,A),v=tt(Ut(y,k,g),A),v===w)continue;const D=tt(d*v,A);if(E=tt(U+D,A),b=tt(ti(k,A)*E,A),b!==w)break}return{r:kt(v,"be",Yt(g)),s:kt(b,"be",Yt(g))}}(0,s,a,o,c,u)}case l.publicKey.elgamal:throw Error("Signing with Elgamal is not defined in the OpenPGP standard.");case l.publicKey.ecdsa:{const{oid:a,Q:o}=e,{d:c}=r;return Zs(a,t,n,o,c,s)}case l.publicKey.eddsaLegacy:{const{oid:a,Q:o}=e,{seed:c}=r;return wc(a,t,0,o,c,s)}case l.publicKey.ed25519:case l.publicKey.ed448:{const{A:a}=e,{seed:o}=r;return ma(i,t,0,a,o,s)}default:throw Error("Unknown signature algorithm.")}}Jr.getNonce=function(i,t){const e=i.slice();for(let r=0;r<t.length;r++)e[4+r]^=t[r];return e},Jr.blockLength=16,Jr.ivLength=12,Jr.tagLength=Gr;class Jn extends Error{constructor(...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,Jn),this.name="Argon2OutOfMemoryError"}}let an,gi;class O0{constructor(t=O){const{passes:e,parallelism:r,memoryExponent:n}=t.s2kArgon2Params;this.type="argon2",this.salt=null,this.t=e,this.p=r,this.encodedM=n}generateSalt(){this.salt=Dt(16)}read(t){let e=0;return this.salt=t.subarray(e,e+16),e+=16,this.t=t[e++],this.p=t[e++],this.encodedM=t[e++],e}write(){const t=[new Uint8Array([l.write(l.s2k,this.type)]),this.salt,new Uint8Array([this.t,this.p,this.encodedM])];return p.concatUint8Array(t)}async produceKey(t,e){const r=2<<this.encodedM-1;try{an=an||(await Promise.resolve().then(function(){return iu})).default,gi=gi||an();const n=await gi,s=n({version:19,type:2,password:p.encodeUTF8(t),salt:this.salt,tagLength:e,memorySize:r,parallelism:this.p,passes:this.t});return r>1048576&&(gi=an(),gi.catch(()=>{})),s}catch(n){throw n.message&&(n.message.includes("Unable to grow instance memory")||n.message.includes("failed to grow memory")||n.message.includes("WebAssembly.Memory.grow")||n.message.includes("Out of memory"))?new Jn("Could not allocate required memory for Argon2"):n}}}class H0{constructor(t,e=O){this.algorithm=l.hash.sha256,this.type=l.read(l.s2k,t),this.c=e.s2kIterationCountByte,this.salt=null}generateSalt(){switch(this.type){case"salted":case"iterated":this.salt=Dt(8)}}getCount(){return 16+(15&this.c)<<6+(this.c>>4)}read(t){let e=0;switch(this.algorithm=t[e++],this.type){case"simple":break;case"salted":this.salt=t.subarray(e,e+8),e+=8;break;case"iterated":this.salt=t.subarray(e,e+8),e+=8,this.c=t[e++];break;case"gnu":if(p.uint8ArrayToString(t.subarray(e,e+3))!=="GNU")throw new ot("Unknown s2k type.");if(e+=3,1e3+t[e++]!==1001)throw new ot("Unknown s2k gnu protection mode.");this.type="gnu-dummy";break;default:throw new ot("Unknown s2k type.")}return e}write(){if(this.type==="gnu-dummy")return new Uint8Array([101,0,...p.stringToUint8Array("GNU"),1]);const t=[new Uint8Array([l.write(l.s2k,this.type),this.algorithm])];switch(this.type){case"simple":break;case"salted":t.push(this.salt);break;case"iterated":t.push(this.salt),t.push(new Uint8Array([this.c]));break;case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}return p.concatUint8Array(t)}async produceKey(t,e){t=p.encodeUTF8(t);const r=[];let n=0,s=0;for(;n<e;){let a;switch(this.type){case"simple":a=p.concatUint8Array([new Uint8Array(s),t]);break;case"salted":a=p.concatUint8Array([new Uint8Array(s),this.salt,t]);break;case"iterated":{const c=p.concatUint8Array([this.salt,t]);let u=c.length;const h=Math.max(this.getCount(),u);a=new Uint8Array(s+h),a.set(c,s);for(let f=s+u;f<h;f+=u,u*=2)a.copyWithin(f,s,f);break}case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}const o=await Ue(this.algorithm,a);r.push(o),n+=o.length,s++}return p.concatUint8Array(r).subarray(0,e)}}const z0=new Set([l.s2k.argon2,l.s2k.iterated]);function xn(i,t=O){switch(i){case l.s2k.argon2:return new O0(t);case l.s2k.iterated:case l.s2k.gnu:case l.s2k.salted:case l.s2k.simple:return new H0(i,t);default:throw new ot("Unsupported S2K type")}}function Pc(i){const{s2kType:t}=i;if(!z0.has(t))throw Error("The provided `config.s2kType` value is not allowed");return xn(t,i)}var xt=Uint8Array,Vt=Uint16Array,Yn=Uint32Array,Zn=new xt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Wn=new xt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ra=new xt([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),xc=function(i,t){for(var e=new Vt(31),r=0;r<31;++r)e[r]=t+=1<<i[r-1];var n=new Yn(e[30]);for(r=1;r<30;++r)for(var s=e[r];s<e[r+1];++s)n[s]=s-e[r]<<5|r;return[e,n]},Qc=xc(Zn,2),Rc=Qc[0],ia=Qc[1];Rc[28]=258,ia[258]=28;for(var xo=xc(Wn,0),G0=xo[0],Qo=xo[1],na=new Vt(32768),ft=0;ft<32768;++ft){var kr=(43690&ft)>>>1|(21845&ft)<<1;kr=(61680&(kr=(52428&kr)>>>2|(13107&kr)<<2))>>>4|(3855&kr)<<4,na[ft]=((65280&kr)>>>8|(255&kr)<<8)>>>1}var Se=function(i,t,e){for(var r=i.length,n=0,s=new Vt(t);n<r;++n)i[n]&&++s[i[n]-1];var a,o=new Vt(t);for(n=0;n<t;++n)o[n]=o[n-1]+s[n-1]<<1;if(e){a=new Vt(1<<t);var c=15-t;for(n=0;n<r;++n)if(i[n])for(var u=n<<4|i[n],h=t-i[n],f=o[i[n]-1]++<<h,y=f|(1<<h)-1;f<=y;++f)a[na[f]>>>c]=u}else for(a=new Vt(r),n=0;n<r;++n)i[n]&&(a[n]=na[o[i[n]-1]++]>>>15-i[n]);return a},gr=new xt(288);for(ft=0;ft<144;++ft)gr[ft]=8;for(ft=144;ft<256;++ft)gr[ft]=9;for(ft=256;ft<280;++ft)gr[ft]=7;for(ft=280;ft<288;++ft)gr[ft]=8;var Hi=new xt(32);for(ft=0;ft<32;++ft)Hi[ft]=5;var q0=Se(gr,9,0),_0=Se(gr,9,1),j0=Se(Hi,5,0),V0=Se(Hi,5,1),ws=function(i){for(var t=i[0],e=1;e<i.length;++e)i[e]>t&&(t=i[e]);return t},oe=function(i,t,e){var r=t/8|0;return(i[r]|i[r+1]<<8)>>(7&t)&e},ms=function(i,t){var e=t/8|0;return(i[e]|i[e+1]<<8|i[e+2]<<16)>>(7&t)},Da=function(i){return(i+7)/8|0},Ci=function(i,t,e){(t==null||t<0)&&(t=0),(e==null||e>i.length)&&(e=i.length);var r=new(i.BYTES_PER_ELEMENT==2?Vt:i.BYTES_PER_ELEMENT==4?Yn:xt)(e-t);return r.set(i.subarray(t,e)),r},J0=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Wt=function(i,t,e){var r=Error(t||J0[i]);if(r.code=i,Error.captureStackTrace&&Error.captureStackTrace(r,Wt),!e)throw r;return r},Qe=function(i,t,e){e<<=7&t;var r=t/8|0;i[r]|=e,i[r+1]|=e>>>8},pi=function(i,t,e){e<<=7&t;var r=t/8|0;i[r]|=e,i[r+1]|=e>>>8,i[r+2]|=e>>>16},bs=function(i,t){for(var e=[],r=0;r<i.length;++r)i[r]&&e.push({s:r,f:i[r]});var n=e.length,s=e.slice();if(!n)return[Pa,0];if(n==1){var a=new xt(e[0].s+1);return a[e[0].s]=1,[a,1]}e.sort(function(U,D){return U.f-D.f}),e.push({s:-1,f:25001});var o=e[0],c=e[1],u=0,h=1,f=2;for(e[0]={s:-1,f:o.f+c.f,l:o,r:c};h!=n-1;)o=e[e[u].f<e[f].f?u++:f++],c=e[u!=h&&e[u].f<e[f].f?u++:f++],e[h++]={s:-1,f:o.f+c.f,l:o,r:c};var y=s[0].s;for(r=1;r<n;++r)s[r].s>y&&(y=s[r].s);var g=new Vt(y+1),A=sa(e[h-1],g,0);if(A>t){r=0;var d=0,w=A-t,k=1<<w;for(s.sort(function(U,D){return g[D.s]-g[U.s]||U.f-D.f});r<n;++r){var v=s[r].s;if(!(g[v]>t))break;d+=k-(1<<A-g[v]),g[v]=t}for(d>>>=w;d>0;){var b=s[r].s;g[b]<t?d-=1<<t-g[b]++-1:++r}for(;r>=0&&d;--r){var E=s[r].s;g[E]==t&&(--g[E],++d)}A=t}return[new xt(g),A]},sa=function(i,t,e){return i.s==-1?Math.max(sa(i.l,t,e+1),sa(i.r,t,e+1)):t[i.s]=e},Ro=function(i){for(var t=i.length;t&&!i[--t];);for(var e=new Vt(++t),r=0,n=i[0],s=1,a=function(c){e[r++]=c},o=1;o<=t;++o)if(i[o]==n&&o!=t)++s;else{if(!n&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(n),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(n);s=1,n=i[o]}return[e.subarray(0,r),t]},di=function(i,t){for(var e=0,r=0;r<t.length;++r)e+=i[r]*t[r];return e},aa=function(i,t,e){var r=e.length,n=Da(t+2);i[n]=255&r,i[n+1]=r>>>8,i[n+2]=255^i[n],i[n+3]=255^i[n+1];for(var s=0;s<r;++s)i[n+s+4]=e[s];return 8*(n+4+r)},To=function(i,t,e,r,n,s,a,o,c,u,h){Qe(t,h++,e),++n[256];for(var f=bs(n,15),y=f[0],g=f[1],A=bs(s,15),d=A[0],w=A[1],k=Ro(y),v=k[0],b=k[1],E=Ro(d),U=E[0],D=E[1],x=new Vt(19),I=0;I<v.length;++I)x[31&v[I]]++;for(I=0;I<U.length;++I)x[31&U[I]]++;for(var m=bs(x,7),K=m[0],C=m[1],S=19;S>4&&!K[ra[S-1]];--S);var B,P,Q,R,L=u+5<<3,q=di(n,gr)+di(s,Hi)+a,G=di(n,y)+di(s,d)+a+14+3*S+di(x,K)+(2*x[16]+3*x[17]+7*x[18]);if(L<=q&&L<=G)return aa(t,h,i.subarray(c,c+u));if(Qe(t,h,1+(G<q)),h+=2,G<q){B=Se(y,g,0),P=y,Q=Se(d,w,0),R=d;var M=Se(K,C,0);for(Qe(t,h,b-257),Qe(t,h+5,D-1),Qe(t,h+10,S-4),h+=14,I=0;I<S;++I)Qe(t,h+3*I,K[ra[I]]);h+=3*S;for(var F=[v,U],T=0;T<2;++T){var H=F[T];for(I=0;I<H.length;++I){var N=31&H[I];Qe(t,h,M[N]),h+=K[N],N>15&&(Qe(t,h,H[I]>>>5&127),h+=H[I]>>>12)}}}else B=q0,P=gr,Q=j0,R=Hi;for(I=0;I<o;++I)if(r[I]>255){N=r[I]>>>18&31,pi(t,h,B[N+257]),h+=P[N+257],N>7&&(Qe(t,h,r[I]>>>23&31),h+=Zn[N]);var _=31&r[I];pi(t,h,Q[_]),h+=R[_],_>3&&(pi(t,h,r[I]>>>5&8191),h+=Wn[_])}else pi(t,h,B[r[I]]),h+=P[r[I]];return pi(t,h,B[256]),h+P[256]},Y0=new Yn([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Pa=new xt(0),Tc=function(i,t,e,r,n){return function(s,a,o,c,u,h){var f=s.length,y=new xt(c+f+5*(1+Math.ceil(f/7e3))+u),g=y.subarray(c,y.length-u),A=0;if(!a||f<8)for(var d=0;d<=f;d+=65535){var w=d+65535;w>=f&&(g[A>>3]=h),A=aa(g,A+1,s.subarray(d,w))}else{for(var k=Y0[a-1],v=k>>>13,b=8191&k,E=(1<<o)-1,U=new Vt(32768),D=new Vt(E+1),x=Math.ceil(o/3),I=2*x,m=function(Mr){return(s[Mr]^s[Mr+1]<<x^s[Mr+2]<<I)&E},K=new Yn(25e3),C=new Vt(288),S=new Vt(32),B=0,P=0,Q=(d=0,0),R=0,L=0;d<f;++d){var q=m(d),G=32767&d,M=D[q];if(U[G]=M,D[q]=G,R<=d){var F=f-d;if((B>7e3||Q>24576)&&F>423){A=To(s,g,0,K,C,S,P,Q,L,d-L,A),Q=B=P=0,L=d;for(var T=0;T<286;++T)C[T]=0;for(T=0;T<30;++T)S[T]=0}var H=2,N=0,_=b,z=G-M&32767;if(F>2&&q==m(d-z))for(var Y=Math.min(v,F)-1,J=Math.min(32767,d),X=Math.min(258,F);z<=J&&--_&&G!=M;){if(s[d+H]==s[d+H-z]){for(var W=0;W<X&&s[d+W]==s[d+W-z];++W);if(W>H){if(H=W,N=z,W>Y)break;var rt=Math.min(z,W-2),st=0;for(T=0;T<rt;++T){var dt=d-z+T+32768&32767,wt=dt-U[dt]+32768&32767;wt>st&&(st=wt,M=dt)}}}z+=(G=M)-(M=U[G])+32768&32767}if(N){K[Q++]=268435456|ia[H]<<18|Qo[N];var mt=31&ia[H],li=31&Qo[N];P+=Zn[mt]+Wn[li],++C[257+mt],++S[li],R=d+H,++B}else K[Q++]=s[d],++C[s[d]]}}A=To(s,g,h,K,C,S,P,Q,L,d-L,A),!h&&7&A&&(A=aa(g,A+1,Pa))}return Ci(y,0,c+Da(A)+u)}(i,t.level==null?6:t.level,t.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(i.length)))):12+t.mem,e,r,!n)},oa=function(){function i(t,e){e||typeof t!="function"||(e=t,t={}),this.ondata=e,this.o=t||{}}return i.prototype.p=function(t,e){this.ondata(Tc(t,this.o,0,0,!e),e)},i.prototype.push=function(t,e){this.ondata||Wt(5),this.d&&Wt(4),this.d=e,this.p(t,e||!1)},i}(),wn=function(){function i(t){this.s={},this.p=new xt(0),this.ondata=t}return i.prototype.e=function(t){this.ondata||Wt(5),this.d&&Wt(4);var e=this.p.length,r=new xt(e+t.length);r.set(this.p),r.set(t,e),this.p=r},i.prototype.c=function(t){this.d=this.s.i=t||!1;var e=this.s.b,r=function(n,s,a){var o=n.length;if(!o||a&&a.f&&!a.l)return s||new xt(0);var c=!s||a,u=!a||a.i;a||(a={}),s||(s=new xt(3*o));var h=function(W){var rt=s.length;if(W>rt){var st=new xt(Math.max(2*rt,W));st.set(s),s=st}},f=a.f||0,y=a.p||0,g=a.b||0,A=a.l,d=a.d,w=a.m,k=a.n,v=8*o;do{if(!A){f=oe(n,y,1);var b=oe(n,y+1,3);if(y+=3,!b){var E=n[(Q=Da(y)+4)-4]|n[Q-3]<<8,U=Q+E;if(U>o){u&&Wt(0);break}c&&h(g+E),s.set(n.subarray(Q,U),g),a.b=g+=E,a.p=y=8*U,a.f=f;continue}if(b==1)A=_0,d=V0,w=9,k=5;else if(b==2){var D=oe(n,y,31)+257,x=oe(n,y+10,15)+4,I=D+oe(n,y+5,31)+1;y+=14;for(var m=new xt(I),K=new xt(19),C=0;C<x;++C)K[ra[C]]=oe(n,y+3*C,7);y+=3*x;var S=ws(K),B=(1<<S)-1,P=Se(K,S,1);for(C=0;C<I;){var Q,R=P[oe(n,y,B)];if(y+=15&R,(Q=R>>>4)<16)m[C++]=Q;else{var L=0,q=0;for(Q==16?(q=3+oe(n,y,3),y+=2,L=m[C-1]):Q==17?(q=3+oe(n,y,7),y+=3):Q==18&&(q=11+oe(n,y,127),y+=7);q--;)m[C++]=L}}var G=m.subarray(0,D),M=m.subarray(D);w=ws(G),k=ws(M),A=Se(G,w,1),d=Se(M,k,1)}else Wt(1);if(y>v){u&&Wt(0);break}}c&&h(g+131072);for(var F=(1<<w)-1,T=(1<<k)-1,H=y;;H=y){var N=(L=A[ms(n,y)&F])>>>4;if((y+=15&L)>v){u&&Wt(0);break}if(L||Wt(2),N<256)s[g++]=N;else{if(N==256){H=y,A=null;break}var _=N-254;if(N>264){var z=Zn[C=N-257];_=oe(n,y,(1<<z)-1)+Rc[C],y+=z}var Y=d[ms(n,y)&T],J=Y>>>4;if(Y||Wt(3),y+=15&Y,M=G0[J],J>3&&(z=Wn[J],M+=ms(n,y)&(1<<z)-1,y+=z),y>v){u&&Wt(0);break}c&&h(g+131072);for(var X=g+_;g<X;g+=4)s[g]=s[g-M],s[g+1]=s[g+1-M],s[g+2]=s[g+2-M],s[g+3]=s[g+3-M];g=X}}a.l=A,a.p=H,a.b=g,a.f=f,A&&(f=1,a.m=w,a.d=d,a.n=k)}while(!f);return g==s.length?s:Ci(s,0,g)}(this.p,this.o,this.s);this.ondata(Ci(r,e,this.s.b),this.d),this.o=Ci(r,this.s.b-32768),this.s.b=this.o.length,this.p=Ci(this.p,this.s.p/8|0),this.s.p&=7},i.prototype.push=function(t,e){this.e(t),this.c(e)},i}(),Z0=function(){function i(t,e){var r,n;this.c=(r=1,n=0,{p:function(s){for(var a=r,o=n,c=0|s.length,u=0;u!=c;){for(var h=Math.min(u+2655,c);u<h;++u)o+=a+=s[u];a=(65535&a)+15*(a>>16),o=(65535&o)+15*(o>>16)}r=a,n=o},d:function(){return(255&(r%=65521))<<24|r>>>8<<16|(255&(n%=65521))<<8|n>>>8}}),this.v=1,oa.call(this,t,e)}return i.prototype.push=function(t,e){oa.prototype.push.call(this,t,e)},i.prototype.p=function(t,e){this.c.p(t);var r=Tc(t,this.o,this.v&&2,e&&4,!e);this.v&&(function(n,s){var a=s.level,o=a==0?0:a<6?1:a==9?3:2;n[0]=120,n[1]=o<<6|(o?32-2*o:1)}(r,this.o),this.v=0),e&&function(n,s,a){for(;a;++s)n[s]=a,a>>>=8}(r,r.length-4,this.c.d()),this.ondata(r,e)},i}(),W0=function(){function i(t){this.v=1,wn.call(this,t)}return i.prototype.push=function(t,e){if(wn.prototype.e.call(this,t),this.v){if(this.p.length<2&&!e)return;this.p=this.p.subarray(2),this.v=0}e&&(this.p.length<4&&Wt(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),wn.prototype.c.call(this,e)},i}(),$0=typeof TextDecoder<"u"&&new TextDecoder;try{$0.decode(Pa,{stream:!0})}catch{}class hi{static get tag(){return l.packet.literalData}constructor(t=new Date){this.format=l.literal.utf8,this.date=p.normalizeDate(t),this.text=null,this.data=null,this.filename=""}setText(t,e=l.literal.utf8){this.format=e,this.text=t,this.data=null}getText(t=!1){return(this.text===null||p.isStream(this.text))&&(this.text=p.decodeUTF8(p.nativeEOL(this.getBytes(t)))),this.text}setBytes(t,e){this.format=e,this.data=t,this.text=null}getBytes(t=!1){return this.data===null&&(this.data=p.canonicalizeEOL(p.encodeUTF8(this.text))),t?Qi(this.data):this.data}setFilename(t){this.filename=t}getFilename(){return this.filename}async read(t){await On(t,async e=>{const r=await e.readByte(),n=await e.readByte();this.filename=p.decodeUTF8(await e.readBytes(n)),this.date=p.readDate(await e.readBytes(4));let s=e.remainder();vt(s)&&(s=await It(s)),this.setBytes(s,r)})}writeHeader(){const t=p.encodeUTF8(this.filename),e=new Uint8Array([t.length]),r=new Uint8Array([this.format]),n=p.writeDate(this.date);return p.concatUint8Array([r,e,t,n])}write(){const t=this.writeHeader(),e=this.getBytes();return p.concat([t,e])}}class Ce{constructor(){this.bytes=""}read(t){return this.bytes=p.uint8ArrayToString(t.subarray(0,8)),this.bytes.length}write(){return p.stringToUint8Array(this.bytes)}toHex(){return p.uint8ArrayToHex(p.stringToUint8Array(this.bytes))}equals(t,e=!1){return e&&(t.isWildcard()||this.isWildcard())||this.bytes===t.bytes}isNull(){return this.bytes===""}isWildcard(){return/^0+$/.test(this.toHex())}static mapToHex(t){return t.toHex()}static fromID(t){const e=new Ce;return e.read(p.hexToUint8Array(t)),e}static wildcard(){const t=new Ce;return t.read(new Uint8Array(8)),t}}const Ai=Symbol("verified"),Lo="salt@notations.openpgpjs.org",X0=new Set([l.signatureSubpacket.issuerKeyID,l.signatureSubpacket.issuerFingerprint,l.signatureSubpacket.embeddedSignature]);class Rt{static get tag(){return l.packet.signature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.signatureData=null,this.unhashedSubpackets=[],this.unknownSubpackets=[],this.signedHashValue=null,this.salt=null,this.created=null,this.signatureExpirationTime=null,this.signatureNeverExpires=!0,this.exportable=null,this.trustLevel=null,this.trustAmount=null,this.regularExpression=null,this.revocable=null,this.keyExpirationTime=null,this.keyNeverExpires=null,this.preferredSymmetricAlgorithms=null,this.revocationKeyClass=null,this.revocationKeyAlgorithm=null,this.revocationKeyFingerprint=null,this.issuerKeyID=new Ce,this.rawNotations=[],this.notations={},this.preferredHashAlgorithms=null,this.preferredCompressionAlgorithms=null,this.keyServerPreferences=null,this.preferredKeyServer=null,this.isPrimaryUserID=null,this.policyURI=null,this.keyFlags=null,this.signersUserID=null,this.reasonForRevocationFlag=null,this.reasonForRevocationString=null,this.features=null,this.signatureTargetPublicKeyAlgorithm=null,this.signatureTargetHashAlgorithm=null,this.signatureTargetHash=null,this.embeddedSignature=null,this.issuerKeyVersion=null,this.issuerFingerprint=null,this.preferredAEADAlgorithms=null,this.preferredCipherSuites=null,this.revoked=null,this[Ai]=null}read(t,e=O){let r=0;if(this.version=t[r++],this.version===5&&!e.enableParsingV5Entities)throw new ot("Support for v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(this.version!==4&&this.version!==5&&this.version!==6)throw new ot(`Version ${this.version} of the signature packet is unsupported.`);if(this.signatureType=t[r++],this.publicKeyAlgorithm=t[r++],this.hashAlgorithm=t[r++],r+=this.readSubPackets(t.subarray(r,t.length),!0),!this.created)throw Error("Missing signature creation time subpacket.");if(this.signatureData=t.subarray(0,r),r+=this.readSubPackets(t.subarray(r,t.length),!1),this.signedHashValue=t.subarray(r,r+2),r+=2,this.version===6){const o=t[r++];this.salt=t.subarray(r,r+o),r+=o}const n=t.subarray(r,t.length),{read:s,signatureParams:a}=function(o,c){let u=0;switch(o){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.rsaSign:{const h=p.readMPI(c.subarray(u));return u+=h.length+2,{read:u,signatureParams:{s:h}}}case l.publicKey.dsa:case l.publicKey.ecdsa:{const h=p.readMPI(c.subarray(u));u+=h.length+2;const f=p.readMPI(c.subarray(u));return u+=f.length+2,{read:u,signatureParams:{r:h,s:f}}}case l.publicKey.eddsaLegacy:{const h=p.readMPI(c.subarray(u));u+=h.length+2;const f=p.readMPI(c.subarray(u));return u+=f.length+2,{read:u,signatureParams:{r:h,s:f}}}case l.publicKey.ed25519:case l.publicKey.ed448:{const h=2*zn(o),f=p.readExactSubarray(c,u,u+h);return u+=f.length,{read:u,signatureParams:{RS:f}}}default:throw new ot("Unknown signature algorithm.")}}(this.publicKeyAlgorithm,n);if(s<n.length)throw Error("Error reading MPIs");this.params=a}writeParams(){return this.params instanceof Promise?dr(async()=>ri(this.publicKeyAlgorithm,await this.params)):ri(this.publicKeyAlgorithm,this.params)}write(){const t=[];return t.push(this.signatureData),t.push(this.writeUnhashedSubPackets()),t.push(this.signedHashValue),this.version===6&&(t.push(new Uint8Array([this.salt.length])),t.push(this.salt)),t.push(this.writeParams()),p.concat(t)}async sign(t,e,r=new Date,n=!1,s){this.version=t.version,this.created=p.normalizeDate(r),this.issuerKeyVersion=t.version,this.issuerFingerprint=t.getFingerprintBytes(),this.issuerKeyID=t.getKeyID();const a=[new Uint8Array([this.version,this.signatureType,this.publicKeyAlgorithm,this.hashAlgorithm])];if(this.version===6){const h=ks(this.hashAlgorithm);if(this.salt===null)this.salt=Dt(h);else if(h!==this.salt.length)throw Error("Provided salt does not have the required length")}else if(s.nonDeterministicSignaturesViaNotation){if(this.rawNotations.filter(({name:h})=>h===Lo).length!==0)throw Error("Unexpected existing salt notation");{const h=Dt(ks(this.hashAlgorithm));this.rawNotations.push({name:Lo,value:h,humanReadable:!1,critical:!1})}}a.push(this.writeHashedSubPackets()),this.unhashedSubpackets=[],this.signatureData=p.concat(a);const o=this.toHash(this.signatureType,e,n),c=await this.hash(this.signatureType,e,o,n);this.signedHashValue=Qt(Kr(c),0,2);const u=async()=>N0(this.publicKeyAlgorithm,this.hashAlgorithm,t.publicParams,t.privateParams,o,await It(c));p.isStream(c)?this.params=u():(this.params=await u(),this[Ai]=!0)}writeHashedSubPackets(){const t=l.signatureSubpacket,e=[];let r;if(this.created===null)throw Error("Missing signature creation time");e.push(at(t.signatureCreationTime,!0,p.writeDate(this.created))),this.signatureExpirationTime!==null&&e.push(at(t.signatureExpirationTime,!0,p.writeNumber(this.signatureExpirationTime,4))),this.exportable!==null&&e.push(at(t.exportableCertification,!0,new Uint8Array([this.exportable?1:0]))),this.trustLevel!==null&&(r=new Uint8Array([this.trustLevel,this.trustAmount]),e.push(at(t.trustSignature,!0,r))),this.regularExpression!==null&&e.push(at(t.regularExpression,!0,this.regularExpression)),this.revocable!==null&&e.push(at(t.revocable,!0,new Uint8Array([this.revocable?1:0]))),this.keyExpirationTime!==null&&e.push(at(t.keyExpirationTime,!0,p.writeNumber(this.keyExpirationTime,4))),this.preferredSymmetricAlgorithms!==null&&(r=p.stringToUint8Array(p.uint8ArrayToString(this.preferredSymmetricAlgorithms)),e.push(at(t.preferredSymmetricAlgorithms,!1,r))),this.revocationKeyClass!==null&&(r=new Uint8Array([this.revocationKeyClass,this.revocationKeyAlgorithm]),r=p.concat([r,this.revocationKeyFingerprint]),e.push(at(t.revocationKey,!1,r))),!this.issuerKeyID.isNull()&&this.issuerKeyVersion<5&&e.push(at(t.issuerKeyID,!0,this.issuerKeyID.write())),this.rawNotations.forEach(({name:a,value:o,humanReadable:c,critical:u})=>{r=[new Uint8Array([c?128:0,0,0,0])];const h=p.encodeUTF8(a);r.push(p.writeNumber(h.length,2)),r.push(p.writeNumber(o.length,2)),r.push(h),r.push(o),r=p.concat(r),e.push(at(t.notationData,u,r))}),this.preferredHashAlgorithms!==null&&(r=p.stringToUint8Array(p.uint8ArrayToString(this.preferredHashAlgorithms)),e.push(at(t.preferredHashAlgorithms,!1,r))),this.preferredCompressionAlgorithms!==null&&(r=p.stringToUint8Array(p.uint8ArrayToString(this.preferredCompressionAlgorithms)),e.push(at(t.preferredCompressionAlgorithms,!1,r))),this.keyServerPreferences!==null&&(r=p.stringToUint8Array(p.uint8ArrayToString(this.keyServerPreferences)),e.push(at(t.keyServerPreferences,!1,r))),this.preferredKeyServer!==null&&e.push(at(t.preferredKeyServer,!1,p.encodeUTF8(this.preferredKeyServer))),this.isPrimaryUserID!==null&&e.push(at(t.primaryUserID,!1,new Uint8Array([this.isPrimaryUserID?1:0]))),this.policyURI!==null&&e.push(at(t.policyURI,!1,p.encodeUTF8(this.policyURI))),this.keyFlags!==null&&(r=p.stringToUint8Array(p.uint8ArrayToString(this.keyFlags)),e.push(at(t.keyFlags,!0,r))),this.signersUserID!==null&&e.push(at(t.signersUserID,!1,p.encodeUTF8(this.signersUserID))),this.reasonForRevocationFlag!==null&&(r=p.stringToUint8Array(String.fromCharCode(this.reasonForRevocationFlag)+this.reasonForRevocationString),e.push(at(t.reasonForRevocation,!0,r))),this.features!==null&&(r=p.stringToUint8Array(p.uint8ArrayToString(this.features)),e.push(at(t.features,!1,r))),this.signatureTargetPublicKeyAlgorithm!==null&&(r=[new Uint8Array([this.signatureTargetPublicKeyAlgorithm,this.signatureTargetHashAlgorithm])],r.push(p.stringToUint8Array(this.signatureTargetHash)),r=p.concat(r),e.push(at(t.signatureTarget,!0,r))),this.embeddedSignature!==null&&e.push(at(t.embeddedSignature,!0,this.embeddedSignature.write())),this.issuerFingerprint!==null&&(r=[new Uint8Array([this.issuerKeyVersion]),this.issuerFingerprint],r=p.concat(r),e.push(at(t.issuerFingerprint,this.version>=5,r))),this.preferredAEADAlgorithms!==null&&(r=p.stringToUint8Array(p.uint8ArrayToString(this.preferredAEADAlgorithms)),e.push(at(t.preferredAEADAlgorithms,!1,r))),this.preferredCipherSuites!==null&&(r=new Uint8Array([].concat(...this.preferredCipherSuites)),e.push(at(t.preferredCipherSuites,!1,r)));const n=p.concat(e),s=p.writeNumber(n.length,this.version===6?4:2);return p.concat([s,n])}writeUnhashedSubPackets(){const t=this.unhashedSubpackets.map(({type:n,critical:s,body:a})=>at(n,s,a)),e=p.concat(t),r=p.writeNumber(e.length,this.version===6?4:2);return p.concat([r,e])}readSubPacket(t,e=!0){let r=0;const n=!!(128&t[r]),s=127&t[r];if(r++,e||(this.unhashedSubpackets.push({type:s,critical:n,body:t.subarray(r,t.length)}),X0.has(s)))switch(s){case l.signatureSubpacket.signatureCreationTime:this.created=p.readDate(t.subarray(r,t.length));break;case l.signatureSubpacket.signatureExpirationTime:{const a=p.readNumber(t.subarray(r,t.length));this.signatureNeverExpires=a===0,this.signatureExpirationTime=a;break}case l.signatureSubpacket.exportableCertification:this.exportable=t[r++]===1;break;case l.signatureSubpacket.trustSignature:this.trustLevel=t[r++],this.trustAmount=t[r++];break;case l.signatureSubpacket.regularExpression:this.regularExpression=t[r];break;case l.signatureSubpacket.revocable:this.revocable=t[r++]===1;break;case l.signatureSubpacket.keyExpirationTime:{const a=p.readNumber(t.subarray(r,t.length));this.keyExpirationTime=a,this.keyNeverExpires=a===0;break}case l.signatureSubpacket.preferredSymmetricAlgorithms:this.preferredSymmetricAlgorithms=[...t.subarray(r,t.length)];break;case l.signatureSubpacket.revocationKey:this.revocationKeyClass=t[r++],this.revocationKeyAlgorithm=t[r++],this.revocationKeyFingerprint=t.subarray(r,r+20);break;case l.signatureSubpacket.issuerKeyID:if(this.version===4)this.issuerKeyID.read(t.subarray(r,t.length));else if(e)throw Error("Unexpected Issuer Key ID subpacket");break;case l.signatureSubpacket.notationData:{const a=!!(128&t[r]);r+=4;const o=p.readNumber(t.subarray(r,r+2));r+=2;const c=p.readNumber(t.subarray(r,r+2));r+=2;const u=p.decodeUTF8(t.subarray(r,r+o)),h=t.subarray(r+o,r+o+c);this.rawNotations.push({name:u,humanReadable:a,value:h,critical:n}),a&&(this.notations[u]=p.decodeUTF8(h));break}case l.signatureSubpacket.preferredHashAlgorithms:this.preferredHashAlgorithms=[...t.subarray(r,t.length)];break;case l.signatureSubpacket.preferredCompressionAlgorithms:this.preferredCompressionAlgorithms=[...t.subarray(r,t.length)];break;case l.signatureSubpacket.keyServerPreferences:this.keyServerPreferences=[...t.subarray(r,t.length)];break;case l.signatureSubpacket.preferredKeyServer:this.preferredKeyServer=p.decodeUTF8(t.subarray(r,t.length));break;case l.signatureSubpacket.primaryUserID:this.isPrimaryUserID=t[r++]!==0;break;case l.signatureSubpacket.policyURI:this.policyURI=p.decodeUTF8(t.subarray(r,t.length));break;case l.signatureSubpacket.keyFlags:this.keyFlags=[...t.subarray(r,t.length)];break;case l.signatureSubpacket.signersUserID:this.signersUserID=p.decodeUTF8(t.subarray(r,t.length));break;case l.signatureSubpacket.reasonForRevocation:this.reasonForRevocationFlag=t[r++],this.reasonForRevocationString=p.decodeUTF8(t.subarray(r,t.length));break;case l.signatureSubpacket.features:this.features=[...t.subarray(r,t.length)];break;case l.signatureSubpacket.signatureTarget:{this.signatureTargetPublicKeyAlgorithm=t[r++],this.signatureTargetHashAlgorithm=t[r++];const a=Bt(this.signatureTargetHashAlgorithm);this.signatureTargetHash=p.uint8ArrayToString(t.subarray(r,r+a));break}case l.signatureSubpacket.embeddedSignature:this.embeddedSignature=new Rt,this.embeddedSignature.read(t.subarray(r,t.length));break;case l.signatureSubpacket.issuerFingerprint:this.issuerKeyVersion=t[r++],this.issuerFingerprint=t.subarray(r,t.length),this.issuerKeyVersion>=5?this.issuerKeyID.read(this.issuerFingerprint):this.issuerKeyID.read(this.issuerFingerprint.subarray(-8));break;case l.signatureSubpacket.preferredAEADAlgorithms:this.preferredAEADAlgorithms=[...t.subarray(r,t.length)];break;case l.signatureSubpacket.preferredCipherSuites:this.preferredCipherSuites=[];for(let a=r;a<t.length;a+=2)this.preferredCipherSuites.push([t[a],t[a+1]]);break;default:this.unknownSubpackets.push({type:s,critical:n,body:t.subarray(r,t.length)})}}readSubPackets(t,e=!0,r){const n=this.version===6?4:2,s=p.readNumber(t.subarray(0,n));let a=n;for(;a<2+s;){const o=q1(t.subarray(a,t.length));a+=o.offset,this.readSubPacket(t.subarray(a,a+o.len),e,r),a+=o.len}return a}toSign(t,e){const r=l.signature;switch(t){case r.binary:return e.text!==null?p.encodeUTF8(e.getText(!0)):e.getBytes(!0);case r.text:{const n=e.getBytes(!0);return p.canonicalizeEOL(n)}case r.standalone:return new Uint8Array(0);case r.certGeneric:case r.certPersona:case r.certCasual:case r.certPositive:case r.certRevocation:{let n,s;if(e.userID)s=180,n=e.userID;else{if(!e.userAttribute)throw Error("Either a userID or userAttribute packet needs to be supplied for certification.");s=209,n=e.userAttribute}const a=n.write();return p.concat([this.toSign(r.key,e),new Uint8Array([s]),p.writeNumber(a.length,4),a])}case r.subkeyBinding:case r.subkeyRevocation:case r.keyBinding:return p.concat([this.toSign(r.key,e),this.toSign(r.key,{key:e.bind})]);case r.key:if(e.key===void 0)throw Error("Key packet is required for this signature.");return e.key.writeForHash(this.version);case r.keyRevocation:return this.toSign(r.key,e);case r.timestamp:return new Uint8Array(0);case r.thirdParty:throw Error("Not implemented");default:throw Error("Unknown signature type.")}}calculateTrailer(t,e){let r=0;return At(Kr(this.signatureData),n=>{r+=n.length},()=>{const n=[];return this.version!==5||this.signatureType!==l.signature.binary&&this.signatureType!==l.signature.text||(e?n.push(new Uint8Array(6)):n.push(t.writeHeader())),n.push(new Uint8Array([this.version,255])),this.version===5&&n.push(new Uint8Array(4)),n.push(p.writeNumber(r,4)),p.concat(n)})}toHash(t,e,r=!1){const n=this.toSign(t,e);return p.concat([this.salt||new Uint8Array,n,this.signatureData,this.calculateTrailer(e,r)])}async hash(t,e,r,n=!1){if(this.version===6&&this.salt.length!==ks(this.hashAlgorithm))throw Error("Signature salt does not have the expected length");return r||(r=this.toHash(t,e,n)),Ue(this.hashAlgorithm,r)}async verify(t,e,r,n=new Date,s=!1,a=O){if(!this.issuerKeyID.equals(t.getKeyID()))throw Error("Signature was not issued by the given public key");if(this.publicKeyAlgorithm!==t.algorithm)throw Error("Public key algorithm used to sign signature does not match issuer key algorithm.");const o=e===l.signature.binary||e===l.signature.text;if(!(this[Ai]&&!o)){let u,h;if(this.hashed?h=await this.hashed:(u=this.toHash(e,r,s),h=await this.hash(e,r,u)),h=await It(h),this.signedHashValue[0]!==h[0]||this.signedHashValue[1]!==h[1])throw Error("Signed digest did not match");if(this.params=await this.params,this[Ai]=await F0(this.publicKeyAlgorithm,this.hashAlgorithm,this.params,t.publicParams,u,h),!this[Ai])throw Error("Signature verification failed")}const c=p.normalizeDate(n);if(c&&this.created>c)throw Error("Signature creation time is in the future");if(c&&c>=this.getExpirationTime())throw Error("Signature is expired");if(a.rejectHashAlgorithms.has(this.hashAlgorithm))throw Error("Insecure hash algorithm: "+l.read(l.hash,this.hashAlgorithm).toUpperCase());if(a.rejectMessageHashAlgorithms.has(this.hashAlgorithm)&&[l.signature.binary,l.signature.text].includes(this.signatureType))throw Error("Insecure message hash algorithm: "+l.read(l.hash,this.hashAlgorithm).toUpperCase());if(this.unknownSubpackets.forEach(({type:u,critical:h})=>{if(h)throw Error("Unknown critical signature subpacket type "+u)}),this.rawNotations.forEach(({name:u,critical:h})=>{if(h&&a.knownNotations.indexOf(u)<0)throw Error("Unknown critical notation: "+u)}),this.revocationKeyClass!==null)throw Error("This key is intended to be revoked with an authorized key, which OpenPGP.js does not support.")}isExpired(t=new Date){const e=p.normalizeDate(t);return e!==null&&!(this.created<=e&&e<this.getExpirationTime())}getExpirationTime(){return this.signatureNeverExpires?1/0:new Date(this.created.getTime()+1e3*this.signatureExpirationTime)}}function at(i,t,e){const r=[];return r.push(Hn(e.length+1)),r.push(new Uint8Array([(t?128:0)|i])),r.push(e),p.concat(r)}function ks(i){switch(i){case l.hash.sha256:return 16;case l.hash.sha384:return 24;case l.hash.sha512:return 32;case l.hash.sha224:case l.hash.sha3_256:return 16;case l.hash.sha3_512:return 32;default:throw Error("Unsupported hash function")}}class se{static get tag(){return l.packet.onePassSignature}static fromSignaturePacket(t,e){const r=new se;return r.version=t.version===6?6:3,r.signatureType=t.signatureType,r.hashAlgorithm=t.hashAlgorithm,r.publicKeyAlgorithm=t.publicKeyAlgorithm,r.issuerKeyID=t.issuerKeyID,r.salt=t.salt,r.issuerFingerprint=t.issuerFingerprint,r.flags=e?1:0,r}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.salt=null,this.issuerKeyID=null,this.issuerFingerprint=null,this.flags=null}read(t){let e=0;if(this.version=t[e++],this.version!==3&&this.version!==6)throw new ot(`Version ${this.version} of the one-pass signature packet is unsupported.`);if(this.signatureType=t[e++],this.hashAlgorithm=t[e++],this.publicKeyAlgorithm=t[e++],this.version===6){const r=t[e++];this.salt=t.subarray(e,e+r),e+=r,this.issuerFingerprint=t.subarray(e,e+32),e+=32,this.issuerKeyID=new Ce,this.issuerKeyID.read(this.issuerFingerprint)}else this.issuerKeyID=new Ce,this.issuerKeyID.read(t.subarray(e,e+8)),e+=8;return this.flags=t[e++],this}write(){const t=[new Uint8Array([this.version,this.signatureType,this.hashAlgorithm,this.publicKeyAlgorithm])];return this.version===6?t.push(new Uint8Array([this.salt.length]),this.salt,this.issuerFingerprint):t.push(this.issuerKeyID.write()),t.push(new Uint8Array([this.flags])),p.concatUint8Array(t)}calculateTrailer(...t){return dr(async()=>Rt.prototype.calculateTrailer.apply(await this.correspondingSig,t))}async verify(){const t=await this.correspondingSig;if(!t||t.constructor.tag!==l.packet.signature)throw Error("Corresponding signature packet missing");if(t.signatureType!==this.signatureType||t.hashAlgorithm!==this.hashAlgorithm||t.publicKeyAlgorithm!==this.publicKeyAlgorithm||!t.issuerKeyID.equals(this.issuerKeyID)||this.version===3&&t.version===6||this.version===6&&t.version!==6||this.version===6&&!p.equalsUint8Array(t.issuerFingerprint,this.issuerFingerprint)||this.version===6&&!p.equalsUint8Array(t.salt,this.salt))throw Error("Corresponding signature packet does not match one-pass signature packet");return t.hashed=this.hashed,t.verify.apply(t,arguments)}}function t5(i,t){if(!t[i]){let e;try{e=l.read(l.packet,i)}catch{throw new _1("Unknown packet type with tag: "+i)}throw Error("Packet not allowed in this context: "+e)}return new t[i]}se.prototype.hash=Rt.prototype.hash,se.prototype.toHash=Rt.prototype.toHash,se.prototype.toSign=Rt.prototype.toSign;class it extends Array{static async fromBinary(t,e,r=O){const n=new it;return await n.read(t,e,r),n}async read(t,e,r=O){r.additionalAllowedPackets.length&&(e={...e,...p.constructAllowedPackets(r.additionalAllowedPackets)}),this.stream=pr(t,async(s,a)=>{const o=Xt(a);try{for(;;)if(await o.ready,await o0(s,async c=>{try{if(c.tag===l.packet.marker||c.tag===l.packet.trust||c.tag===l.packet.padding)return;const u=t5(c.tag,e);u.packets=new it,u.fromStream=p.isStream(c.packet),await u.read(c.packet,r),await o.write(u)}catch(u){if(u instanceof _1){if(!(c.tag<=39))return;await o.abort(u)}const h=!r.ignoreUnsupportedPackets&&u instanceof ot,f=!(r.ignoreMalformedPackets||u instanceof ot);if(h||f||fn(c.tag))await o.abort(u);else{const y=new js(c.tag,c.packet);await o.write(y)}p.printDebugError(u)}}))return await o.ready,void await o.close()}catch(c){await o.abort(c)}});const n=_e(this.stream);for(;;){const{done:s,value:a}=await n.read();if(s?this.stream=null:this.push(a),s||fn(a.constructor.tag))break}n.releaseLock()}write(){const t=[];for(let e=0;e<this.length;e++){const r=this[e]instanceof js?this[e].tag:this[e].constructor.tag,n=this[e].write();if(p.isStream(n)&&fn(this[e].constructor.tag)){let s=[],a=0;const o=512;t.push(Bn(r)),t.push(At(n,c=>{if(s.push(c),a+=c.length,a>=o){const u=Math.min(Math.log(a)/Math.LN2|0,30),h=2**u,f=p.concat([a0(u)].concat(s));return s=[f.subarray(1+h)],a=s[0].length,f.subarray(0,1+h)}},()=>p.concat([Hn(a)].concat(s))))}else{if(p.isStream(n)){let s=0;t.push(At(Kr(n),a=>{s+=a.length},()=>lo(r,s)))}else t.push(lo(r,n.length));t.push(n)}}return p.concat(t)}filterByTag(...t){const e=new it,r=n=>s=>n===s;for(let n=0;n<this.length;n++)t.some(r(this[n].constructor.tag))&&e.push(this[n]);return e}findPacket(t){return this.find(e=>e.constructor.tag===t)}indexOfTag(...t){const e=[],r=this,n=s=>a=>s===a;for(let s=0;s<this.length;s++)t.some(n(r[s].constructor.tag))&&e.push(s);return e}}const e5=p.constructAllowedPackets([hi,se,Rt]);class Ji{static get tag(){return l.packet.compressedData}constructor(t=O){this.packets=null,this.algorithm=t.preferredCompressionAlgorithm,this.compressed=null}async read(t,e=O){await On(t,async r=>{this.algorithm=await r.readByte(),this.compressed=r.remainder(),await this.decompress(e)})}write(){return this.compressed===null&&this.compress(),p.concat([new Uint8Array([this.algorithm]),this.compressed])}async decompress(t=O){const e=l.read(l.compression,this.algorithm),r=n5[e];if(!r)throw Error(e+" decompression not supported");this.packets=await it.fromBinary(await r(this.compressed),e5,t)}compress(){const t=l.read(l.compression,this.algorithm),e=i5[t];if(!e)throw Error(t+" compression not supported");this.compressed=e(this.packets.write())}}function Qn(i,t){return e=>{if(!p.isStream(e)||vt(e))return dr(()=>It(e).then(s=>new Promise((a,o)=>{const c=new t;c.ondata=u=>{a(u)};try{c.push(s,!0)}catch(u){o(u)}})));if(i)try{const s=i();return e.pipeThrough(s)}catch(s){if(s.name!=="TypeError")throw s}const r=e.getReader(),n=new t;return new ReadableStream({async start(s){for(n.ondata=async(a,o)=>{s.enqueue(a),o&&s.close()};;){const{done:a,value:o}=await r.read();if(a)return void n.push(new Uint8Array,!0);o.length&&n.push(o)}}})}}function r5(){return async function(i){const{decode:t}=await Promise.resolve().then(function(){return uu});return dr(async()=>t(await It(i)))}}const Rn=i=>({compressor:typeof CompressionStream<"u"&&(()=>new CompressionStream(i)),decompressor:typeof DecompressionStream<"u"&&(()=>new DecompressionStream(i))}),i5={zip:Qn(Rn("deflate-raw").compressor,oa),zlib:Qn(Rn("deflate").compressor,Z0)},n5={uncompressed:i=>i,zip:Qn(Rn("deflate-raw").decompressor,wn),zlib:Qn(Rn("deflate").decompressor,W0),bzip2:r5()},s5=p.constructAllowedPackets([hi,Ji,se,Rt]);class ii{static get tag(){return l.packet.symEncryptedIntegrityProtectedData}static fromObject({version:t,aeadAlgorithm:e}){if(t!==1&&t!==2)throw Error("Unsupported SEIPD version");const r=new ii;return r.version=t,t===2&&(r.aeadAlgorithm=e),r}constructor(){this.version=null,this.cipherAlgorithm=null,this.aeadAlgorithm=null,this.chunkSizeByte=null,this.salt=null,this.encrypted=null,this.packets=null}async read(t){await On(t,async e=>{if(this.version=await e.readByte(),this.version!==1&&this.version!==2)throw new ot(`Version ${this.version} of the SEIP packet is unsupported.`);this.version===2&&(this.cipherAlgorithm=await e.readByte(),this.aeadAlgorithm=await e.readByte(),this.chunkSizeByte=await e.readByte(),this.salt=await e.readBytes(32)),this.encrypted=e.remainder()})}write(){return this.version===2?p.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.salt,this.encrypted]):p.concat([new Uint8Array([this.version]),this.encrypted])}async encrypt(t,e,r=O){const{blockSize:n,keySize:s}=ct(t);if(e.length!==s)throw Error("Unexpected session key size");let a=this.packets.write();if(vt(a)&&(a=await It(a)),this.version===2)this.cipherAlgorithm=t,this.salt=Dt(32),this.chunkSizeByte=r.aeadChunkSizeByte,this.encrypted=await Tn(this,"encrypt",e,a);else{const o=await Kc(t),c=new Uint8Array([211,20]),u=p.concat([o,a,c]),h=await Ue(l.hash.sha1,Qi(u)),f=p.concat([u,h]);this.encrypted=await Oi(t,e,f,new Uint8Array(n))}return!0}async decrypt(t,e,r=O){if(e.length!==ct(t).keySize)throw Error("Unexpected session key size");let n,s=Kr(this.encrypted);if(vt(s)&&(s=await It(s)),this.version===2){if(this.cipherAlgorithm!==t)throw Error("Unexpected session key algorithm");n=await Tn(this,"decrypt",e,s)}else{const{blockSize:a}=ct(t),o=await Vn(t,e,s,new Uint8Array(a)),c=Qt(Qi(o),-20),u=Qt(o,0,-20),h=Promise.all([It(await Ue(l.hash.sha1,Qi(u))),It(c)]).then(([y,g])=>{if(!p.equalsUint8Array(y,g))throw Error("Modification detected.");return new Uint8Array}),f=Qt(u,a+2);n=Qt(f,0,-2),n=qt([n,dr(()=>h)]),p.isStream(s)&&r.allowUnauthenticatedStream||(n=await It(n))}return this.packets=await it.fromBinary(n,s5,r),!0}}async function Tn(i,t,e,r){const n=i instanceof ii&&i.version===2,s=!n&&i.constructor.tag===l.packet.aeadEncryptedData;if(!n&&!s)throw Error("Unexpected packet type");const a=ze(i.aeadAlgorithm,s),o=t==="decrypt"?a.tagLength:0,c=t==="encrypt"?a.tagLength:0,u=2**(i.chunkSizeByte+6)+o,h=s?8:0,f=new ArrayBuffer(13+h),y=new Uint8Array(f,0,5+h),g=new Uint8Array(f),A=new DataView(f),d=new Uint8Array(f,5,8);y.set([192|i.constructor.tag,i.version,i.cipherAlgorithm,i.aeadAlgorithm,i.chunkSizeByte],0);let w,k,v=0,b=Promise.resolve(),E=0,U=0;if(n){const{keySize:x}=ct(i.cipherAlgorithm),{ivLength:I}=a,m=new Uint8Array(f,0,5),K=await yr(l.hash.sha256,e,i.salt,m,x+I);e=K.subarray(0,x),w=K.subarray(x),w.fill(0,w.length-8),k=new DataView(w.buffer,w.byteOffset,w.byteLength)}else w=i.iv;const D=await a(i.cipherAlgorithm,e);return pr(r,async(x,I)=>{if(p.isStream(x)!=="array"){const C=new TransformStream({},{highWaterMark:p.getHardwareConcurrency()*2**(i.chunkSizeByte+6),size:S=>S.length});Cr(C.readable,I),I=C.writable}const m=_e(x),K=Xt(I);try{for(;;){let C=await m.readBytes(u+o)||new Uint8Array;const S=C.subarray(C.length-o);let B,P,Q;if(C=C.subarray(0,C.length-o),n)Q=w;else{Q=w.slice();for(let R=0;R<8;R++)Q[w.length-8+R]^=d[R]}if(!v||C.length?(m.unshift(S),B=D[t](C,Q,y),B.catch(()=>{}),U+=C.length-o+c):(A.setInt32(5+h+4,E),B=D[t](S,Q,g),B.catch(()=>{}),U+=c,P=!0),E+=C.length-o,b=b.then(()=>B).then(async R=>{await K.ready,await K.write(R),U-=R.length}).catch(R=>K.abort(R)),(P||U>K.desiredSize)&&await b,P){await K.close();break}n?k.setInt32(w.length-4,++v):A.setInt32(9,++v)}}catch(C){await K.ready.catch(()=>{}),await K.abort(C)}})}const a5=p.constructAllowedPackets([hi,Ji,se,Rt]);class o5{static get tag(){return l.packet.aeadEncryptedData}constructor(){this.version=1,this.cipherAlgorithm=null,this.aeadAlgorithm=l.aead.eax,this.chunkSizeByte=null,this.iv=null,this.encrypted=null,this.packets=null}async read(t){await On(t,async e=>{const r=await e.readByte();if(r!==1)throw new ot(`Version ${r} of the AEAD-encrypted data packet is not supported.`);this.cipherAlgorithm=await e.readByte(),this.aeadAlgorithm=await e.readByte(),this.chunkSizeByte=await e.readByte();const n=ze(this.aeadAlgorithm,!0);this.iv=await e.readBytes(n.ivLength),this.encrypted=e.remainder()})}write(){return p.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.iv,this.encrypted])}async decrypt(t,e,r=O){this.packets=await it.fromBinary(await Tn(this,"decrypt",e,Kr(this.encrypted)),a5,r)}async encrypt(t,e,r=O){this.cipherAlgorithm=t;const{ivLength:n}=ze(this.aeadAlgorithm,!0);this.iv=Dt(n),this.chunkSizeByte=r.aeadChunkSizeByte;const s=this.packets.write();this.encrypted=await Tn(this,"encrypt",e,s)}}class zi{static get tag(){return l.packet.publicKeyEncryptedSessionKey}constructor(){this.version=null,this.publicKeyID=new Ce,this.publicKeyVersion=null,this.publicKeyFingerprint=null,this.publicKeyAlgorithm=null,this.sessionKey=null,this.sessionKeyAlgorithm=null,this.encrypted={}}static fromObject({version:t,encryptionKeyPacket:e,anonymousRecipient:r,sessionKey:n,sessionKeyAlgorithm:s}){const a=new zi;if(t!==3&&t!==6)throw Error("Unsupported PKESK version");return a.version=t,t===6&&(a.publicKeyVersion=r?null:e.version,a.publicKeyFingerprint=r?null:e.getFingerprintBytes()),a.publicKeyID=r?Ce.wildcard():e.getKeyID(),a.publicKeyAlgorithm=e.algorithm,a.sessionKey=n,a.sessionKeyAlgorithm=s,a}read(t){let e=0;if(this.version=t[e++],this.version!==3&&this.version!==6)throw new ot(`Version ${this.version} of the PKESK packet is unsupported.`);if(this.version===6){const r=t[e++];if(r){this.publicKeyVersion=t[e++];const n=r-1;this.publicKeyFingerprint=t.subarray(e,e+n),e+=n,this.publicKeyVersion>=5?this.publicKeyID.read(this.publicKeyFingerprint):this.publicKeyID.read(this.publicKeyFingerprint.subarray(-8))}else this.publicKeyID=Ce.wildcard()}else e+=this.publicKeyID.read(t.subarray(e,e+8));if(this.publicKeyAlgorithm=t[e++],this.encrypted=function(r,n){let s=0;switch(r){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:return{c:p.readMPI(n.subarray(s))};case l.publicKey.elgamal:{const a=p.readMPI(n.subarray(s));return s+=a.length+2,{c1:a,c2:p.readMPI(n.subarray(s))}}case l.publicKey.ecdh:{const a=p.readMPI(n.subarray(s));s+=a.length+2;const o=new Sc;return o.read(n.subarray(s)),{V:a,C:o}}case l.publicKey.x25519:case l.publicKey.x448:{const a=Vr(r),o=p.readExactSubarray(n,s,s+a);s+=o.length;const c=new jn;return c.read(n.subarray(s)),{ephemeralPublicKey:o,C:c}}default:throw new ot("Unknown public key encryption algorithm.")}}(this.publicKeyAlgorithm,t.subarray(e)),this.publicKeyAlgorithm===l.publicKey.x25519||this.publicKeyAlgorithm===l.publicKey.x448){if(this.version===3)this.sessionKeyAlgorithm=l.write(l.symmetric,this.encrypted.C.algorithm);else if(this.encrypted.C.algorithm!==null)throw Error("Unexpected cleartext symmetric algorithm")}}write(){const t=[new Uint8Array([this.version])];return this.version===6?this.publicKeyFingerprint!==null?(t.push(new Uint8Array([this.publicKeyFingerprint.length+1,this.publicKeyVersion])),t.push(this.publicKeyFingerprint)):t.push(new Uint8Array([0])):t.push(this.publicKeyID.write()),t.push(new Uint8Array([this.publicKeyAlgorithm]),ri(this.publicKeyAlgorithm,this.encrypted)),p.concatUint8Array(t)}async encrypt(t){const e=l.write(l.publicKey,this.publicKeyAlgorithm),r=this.version===3?this.sessionKeyAlgorithm:null,n=t.version===5?t.getFingerprintBytes().subarray(0,20):t.getFingerprintBytes(),s=Mo(this.version,e,r,this.sessionKey);this.encrypted=await I0(e,r,t.publicParams,s,n)}async decrypt(t,e){if(this.publicKeyAlgorithm!==t.algorithm)throw Error("Decryption error");const r=e?Mo(this.version,this.publicKeyAlgorithm,e.sessionKeyAlgorithm,e.sessionKey):null,n=t.version===5?t.getFingerprintBytes().subarray(0,20):t.getFingerprintBytes(),s=await S0(this.publicKeyAlgorithm,t.publicParams,t.privateParams,this.encrypted,n,r),{sessionKey:a,sessionKeyAlgorithm:o}=function(c,u,h,f){switch(u){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.elgamal:case l.publicKey.ecdh:{const y=h.subarray(0,h.length-2),g=h.subarray(h.length-2),A=p.writeChecksum(y.subarray(y.length%8)),d=A[0]===g[0]&A[1]===g[1],w=c===6?{sessionKeyAlgorithm:null,sessionKey:y}:{sessionKeyAlgorithm:y[0],sessionKey:y.subarray(1)};if(f){const k=d&w.sessionKeyAlgorithm===f.sessionKeyAlgorithm&w.sessionKey.length===f.sessionKey.length;return{sessionKey:p.selectUint8Array(k,w.sessionKey,f.sessionKey),sessionKeyAlgorithm:c===6?null:p.selectUint8(k,w.sessionKeyAlgorithm,f.sessionKeyAlgorithm)}}if(d&&(c===6||l.read(l.symmetric,w.sessionKeyAlgorithm)))return w;throw Error("Decryption error")}case l.publicKey.x25519:case l.publicKey.x448:return{sessionKeyAlgorithm:null,sessionKey:h};default:throw Error("Unsupported public key algorithm")}}(this.version,this.publicKeyAlgorithm,s,e);if(this.version===3){const c=this.publicKeyAlgorithm!==l.publicKey.x25519&&this.publicKeyAlgorithm!==l.publicKey.x448;if(this.sessionKeyAlgorithm=c?o:this.sessionKeyAlgorithm,a.length!==ct(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}this.sessionKey=a}}function Mo(i,t,e,r){switch(t){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.elgamal:case l.publicKey.ecdh:return p.concatUint8Array([new Uint8Array(i===6?[]:[e]),r,p.writeChecksum(r.subarray(r.length%8))]);case l.publicKey.x25519:case l.publicKey.x448:return r;default:throw Error("Unsupported public key algorithm")}}class ni{static get tag(){return l.packet.symEncryptedSessionKey}constructor(t=O){this.version=t.aeadProtect?6:4,this.sessionKey=null,this.sessionKeyEncryptionAlgorithm=null,this.sessionKeyAlgorithm=null,this.aeadAlgorithm=l.write(l.aead,t.preferredAEADAlgorithm),this.encrypted=null,this.s2k=null,this.iv=null}read(t){let e=0;if(this.version=t[e++],this.version!==4&&this.version!==5&&this.version!==6)throw new ot(`Version ${this.version} of the SKESK packet is unsupported.`);this.version===6&&e++;const r=t[e++];this.version>=5&&(this.aeadAlgorithm=t[e++],this.version===6&&e++);const n=t[e++];if(this.s2k=xn(n),e+=this.s2k.read(t.subarray(e,t.length)),this.version>=5){const s=ze(this.aeadAlgorithm,!0);this.iv=t.subarray(e,e+=s.ivLength)}this.version>=5||e<t.length?(this.encrypted=t.subarray(e,t.length),this.sessionKeyEncryptionAlgorithm=r):this.sessionKeyAlgorithm=r}write(){const t=this.encrypted===null?this.sessionKeyAlgorithm:this.sessionKeyEncryptionAlgorithm;let e;const r=this.s2k.write();if(this.version===6){const n=r.length,s=3+n+this.iv.length;e=p.concatUint8Array([new Uint8Array([this.version,s,t,this.aeadAlgorithm,n]),r,this.iv,this.encrypted])}else this.version===5?e=p.concatUint8Array([new Uint8Array([this.version,t,this.aeadAlgorithm]),r,this.iv,this.encrypted]):(e=p.concatUint8Array([new Uint8Array([this.version,t]),r]),this.encrypted!==null&&(e=p.concatUint8Array([e,this.encrypted])));return e}async decrypt(t){const e=this.sessionKeyEncryptionAlgorithm!==null?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm,{blockSize:r,keySize:n}=ct(e),s=await this.s2k.produceKey(t,n);if(this.version>=5){const a=ze(this.aeadAlgorithm,!0),o=new Uint8Array([192|ni.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),c=this.version===6?await yr(l.hash.sha256,s,new Uint8Array,o,n):s,u=await a(e,c);this.sessionKey=await u.decrypt(this.encrypted,this.iv,o)}else if(this.encrypted!==null){const a=await Vn(e,s,this.encrypted,new Uint8Array(r));if(this.sessionKeyAlgorithm=l.write(l.symmetric,a[0]),this.sessionKey=a.subarray(1,a.length),this.sessionKey.length!==ct(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}else this.sessionKey=s}async encrypt(t,e=O){const r=this.sessionKeyEncryptionAlgorithm!==null?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm;this.sessionKeyEncryptionAlgorithm=r,this.s2k=Pc(e),this.s2k.generateSalt();const{blockSize:n,keySize:s}=ct(r),a=await this.s2k.produceKey(t,s);if(this.sessionKey===null&&(this.sessionKey=$s(this.sessionKeyAlgorithm)),this.version>=5){const o=ze(this.aeadAlgorithm);this.iv=Dt(o.ivLength);const c=new Uint8Array([192|ni.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),u=this.version===6?await yr(l.hash.sha256,a,new Uint8Array,c,s):a,h=await o(r,u);this.encrypted=await h.encrypt(this.sessionKey,this.iv,c)}else{const o=p.concatUint8Array([new Uint8Array([this.sessionKeyAlgorithm]),this.sessionKey]);this.encrypted=await Oi(r,a,o,new Uint8Array(n))}}}class Be{static get tag(){return l.packet.publicKey}constructor(t=new Date,e=O){this.version=e.v6Keys?6:4,this.created=p.normalizeDate(t),this.algorithm=null,this.publicParams=null,this.expirationTimeV3=0,this.fingerprint=null,this.keyID=null}static fromSecretKeyPacket(t){const e=new Be,{version:r,created:n,algorithm:s,publicParams:a,keyID:o,fingerprint:c}=t;return e.version=r,e.created=n,e.algorithm=s,e.publicParams=a,e.keyID=o,e.fingerprint=c,e}async read(t,e=O){let r=0;if(this.version=t[r++],this.version===5&&!e.enableParsingV5Entities)throw new ot("Support for parsing v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(this.version===4||this.version===5||this.version===6){this.created=p.readDate(t.subarray(r,r+4)),r+=4,this.algorithm=t[r++],this.version>=5&&(r+=4);const{read:n,publicParams:s}=function(a,o){let c=0;switch(a){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:{const u=p.readMPI(o.subarray(c));c+=u.length+2;const h=p.readMPI(o.subarray(c));return c+=h.length+2,{read:c,publicParams:{n:u,e:h}}}case l.publicKey.dsa:{const u=p.readMPI(o.subarray(c));c+=u.length+2;const h=p.readMPI(o.subarray(c));c+=h.length+2;const f=p.readMPI(o.subarray(c));c+=f.length+2;const y=p.readMPI(o.subarray(c));return c+=y.length+2,{read:c,publicParams:{p:u,q:h,g:f,y}}}case l.publicKey.elgamal:{const u=p.readMPI(o.subarray(c));c+=u.length+2;const h=p.readMPI(o.subarray(c));c+=h.length+2;const f=p.readMPI(o.subarray(c));return c+=f.length+2,{read:c,publicParams:{p:u,g:h,y:f}}}case l.publicKey.ecdsa:{const u=new He;c+=u.read(o),gs(u);const h=p.readMPI(o.subarray(c));return c+=h.length+2,{read:c,publicParams:{oid:u,Q:h}}}case l.publicKey.eddsaLegacy:{const u=new He;if(c+=u.read(o),gs(u),u.getName()!==l.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let h=p.readMPI(o.subarray(c));return c+=h.length+2,h=p.leftPad(h,33),{read:c,publicParams:{oid:u,Q:h}}}case l.publicKey.ecdh:{const u=new He;c+=u.read(o),gs(u);const h=p.readMPI(o.subarray(c));c+=h.length+2;const f=new Cc;return c+=f.read(o.subarray(c)),{read:c,publicParams:{oid:u,Q:h,kdfParams:f}}}case l.publicKey.ed25519:case l.publicKey.ed448:case l.publicKey.x25519:case l.publicKey.x448:{const u=p.readExactSubarray(o,c,c+Vr(a));return c+=u.length,{read:c,publicParams:{A:u}}}default:throw new ot("Unknown public key encryption algorithm.")}}(this.algorithm,t.subarray(r));if(this.version===6&&s.oid&&(s.oid.getName()===l.curve.curve25519Legacy||s.oid.getName()===l.curve.ed25519Legacy))throw Error("Legacy curve25519 cannot be used with v6 keys");return this.publicParams=s,r+=n,await this.computeFingerprintAndKeyID(),r}throw new ot(`Version ${this.version} of the key packet is unsupported.`)}write(){const t=[];t.push(new Uint8Array([this.version])),t.push(p.writeDate(this.created)),t.push(new Uint8Array([this.algorithm]));const e=ri(this.algorithm,this.publicParams);return this.version>=5&&t.push(p.writeNumber(e.length,4)),t.push(e),p.concatUint8Array(t)}writeForHash(t){const e=this.writePublicKey(),r=149+t,n=t>=5?4:2;return p.concatUint8Array([new Uint8Array([r]),p.writeNumber(e.length,n),e])}isDecrypted(){return null}getCreationTime(){return this.created}getKeyID(){return this.keyID}async computeFingerprintAndKeyID(){if(await this.computeFingerprint(),this.keyID=new Ce,this.version>=5)this.keyID.read(this.fingerprint.subarray(0,8));else{if(this.version!==4)throw Error("Unsupported key version");this.keyID.read(this.fingerprint.subarray(12,20))}}async computeFingerprint(){const t=this.writeForHash(this.version);if(this.version>=5)this.fingerprint=await Ue(l.hash.sha256,t);else{if(this.version!==4)throw Error("Unsupported key version");this.fingerprint=await Ue(l.hash.sha1,t)}}getFingerprintBytes(){return this.fingerprint}getFingerprint(){return p.uint8ArrayToHex(this.getFingerprintBytes())}hasSameFingerprintAs(t){return this.version===t.version&&p.equalsUint8Array(this.writePublicKey(),t.writePublicKey())}getAlgorithmInfo(){const t={};t.algorithm=l.read(l.publicKey,this.algorithm);const e=this.publicParams.n||this.publicParams.p;return e?t.bits=p.uint8ArrayBitLength(e):this.publicParams.oid&&(t.curve=this.publicParams.oid.getName()),t}}Be.prototype.readPublicKey=Be.prototype.read,Be.prototype.writePublicKey=Be.prototype.write;const c5=p.constructAllowedPackets([hi,Ji,se,Rt]);class u5{static get tag(){return l.packet.symmetricallyEncryptedData}constructor(){this.encrypted=null,this.packets=null}read(t){this.encrypted=t}write(){return this.encrypted}async decrypt(t,e,r=O){if(!r.allowUnauthenticatedMessages)throw Error("Message is not authenticated.");const{blockSize:n}=ct(t),s=await It(Kr(this.encrypted)),a=await Vn(t,e,s.subarray(n+2),s.subarray(2,n+2));this.packets=await it.fromBinary(a,c5,r)}async encrypt(t,e,r=O){const n=this.packets.write(),{blockSize:s}=ct(t),a=await Kc(t),o=await Oi(t,e,a,new Uint8Array(s)),c=await Oi(t,e,n,o.subarray(2));this.encrypted=p.concat([o,c])}}class $n extends Be{static get tag(){return l.packet.publicSubkey}constructor(t,e){super(t,e)}static fromSecretSubkeyPacket(t){const e=new $n,{version:r,created:n,algorithm:s,publicParams:a,keyID:o,fingerprint:c}=t;return e.version=r,e.created=n,e.algorithm=s,e.publicParams=a,e.keyID=o,e.fingerprint=c,e}}class xa{static get tag(){return l.packet.userAttribute}constructor(){this.attributes=[]}read(t){let e=0;for(;e<t.length;){const r=q1(t.subarray(e,t.length));e+=r.offset,this.attributes.push(p.uint8ArrayToString(t.subarray(e,e+r.len))),e+=r.len}}write(){const t=[];for(let e=0;e<this.attributes.length;e++)t.push(Hn(this.attributes[e].length)),t.push(p.stringToUint8Array(this.attributes[e]));return p.concatUint8Array(t)}equals(t){return!!(t&&t instanceof xa)&&this.attributes.every(function(e,r){return e===t.attributes[r]})}}class Qa extends Be{static get tag(){return l.packet.secretKey}constructor(t=new Date,e=O){super(t,e),this.keyMaterial=null,this.isEncrypted=null,this.s2kUsage=0,this.s2k=null,this.symmetric=null,this.aead=null,this.isLegacyAEAD=null,this.privateParams=null,this.usedModernAEAD=null}async read(t,e=O){let r=await this.readPublicKey(t,e);const n=r;this.s2kUsage=t[r++],this.version===5&&r++,this.version===6&&this.s2kUsage&&r++;try{if(this.s2kUsage===255||this.s2kUsage===254||this.s2kUsage===253){this.symmetric=t[r++],this.s2kUsage===253&&(this.aead=t[r++]),this.version===6&&r++;const s=t[r++];if(this.s2k=xn(s),r+=this.s2k.read(t.subarray(r,t.length)),this.s2k.type==="gnu-dummy")return}else this.s2kUsage&&(this.symmetric=this.s2kUsage);this.s2kUsage&&(this.isLegacyAEAD=this.s2kUsage===253&&(this.version===5||this.version===4&&e.parseAEADEncryptedV4KeysAsLegacy),this.s2kUsage!==253||this.isLegacyAEAD?(this.iv=t.subarray(r,r+ct(this.symmetric).blockSize),this.usedModernAEAD=!1):(this.iv=t.subarray(r,r+ze(this.aead).ivLength),this.usedModernAEAD=!0),r+=this.iv.length)}catch(s){if(!this.s2kUsage)throw s;this.unparseableKeyMaterial=t.subarray(n),this.isEncrypted=!0}if(this.version===5&&(r+=4),this.keyMaterial=t.subarray(r),this.isEncrypted=!!this.s2kUsage,!this.isEncrypted){let s;if(this.version===6)s=this.keyMaterial;else if(s=this.keyMaterial.subarray(0,-2),!p.equalsUint8Array(p.writeChecksum(s),this.keyMaterial.subarray(-2)))throw Error("Key checksum mismatch");try{const{read:a,privateParams:o}=vo(this.algorithm,s,this.publicParams);if(a<s.length)throw Error("Error reading MPIs");this.privateParams=o}catch(a){throw a instanceof ot?a:Error("Error reading MPIs")}}}write(){const t=this.writePublicKey();if(this.unparseableKeyMaterial)return p.concatUint8Array([t,this.unparseableKeyMaterial]);const e=[t];e.push(new Uint8Array([this.s2kUsage]));const r=[];if(this.s2kUsage===255||this.s2kUsage===254||this.s2kUsage===253){r.push(this.symmetric),this.s2kUsage===253&&r.push(this.aead);const n=this.s2k.write();this.version===6&&r.push(n.length),r.push(...n)}return this.s2kUsage&&this.s2k.type!=="gnu-dummy"&&r.push(...this.iv),(this.version===5||this.version===6&&this.s2kUsage)&&e.push(new Uint8Array([r.length])),e.push(new Uint8Array(r)),this.isDummy()||(this.s2kUsage||(this.keyMaterial=ri(this.algorithm,this.privateParams)),this.version===5&&e.push(p.writeNumber(this.keyMaterial.length,4)),e.push(this.keyMaterial),this.s2kUsage||this.version===6||e.push(p.writeChecksum(this.keyMaterial))),p.concatUint8Array(e)}isDecrypted(){return this.isEncrypted===!1}isMissingSecretKeyMaterial(){return this.unparseableKeyMaterial!==void 0||this.isDummy()}isDummy(){return!(!this.s2k||this.s2k.type!=="gnu-dummy")}makeDummy(t=O){this.isDummy()||(this.isDecrypted()&&this.clearPrivateParams(),delete this.unparseableKeyMaterial,this.isEncrypted=null,this.keyMaterial=null,this.s2k=xn(l.s2k.gnu,t),this.s2k.algorithm=0,this.s2k.c=0,this.s2k.type="gnu-dummy",this.s2kUsage=254,this.symmetric=l.symmetric.aes256,this.isLegacyAEAD=null,this.usedModernAEAD=null)}async encrypt(t,e=O){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key packet is already encrypted");if(!t)throw Error("A non-empty passphrase is required for key encryption.");this.s2k=Pc(e),this.s2k.generateSalt();const r=ri(this.algorithm,this.privateParams);this.symmetric=l.symmetric.aes256;const{blockSize:n}=ct(this.symmetric);if(e.aeadProtect){this.s2kUsage=253,this.aead=e.preferredAEADAlgorithm;const s=ze(this.aead);this.isLegacyAEAD=this.version===5,this.usedModernAEAD=!this.isLegacyAEAD;const a=Bn(this.constructor.tag),o=await Es(this.version,this.s2k,t,this.symmetric,this.aead,a,this.isLegacyAEAD),c=await s(this.symmetric,o);this.iv=this.isLegacyAEAD?Dt(n):Dt(s.ivLength);const u=this.isLegacyAEAD?new Uint8Array:p.concatUint8Array([a,this.writePublicKey()]);this.keyMaterial=await c.encrypt(r,this.iv.subarray(0,s.ivLength),u)}else{this.s2kUsage=254,this.usedModernAEAD=!1;const s=await Es(this.version,this.s2k,t,this.symmetric);this.iv=Dt(n),this.keyMaterial=await Oi(this.symmetric,s,p.concatUint8Array([r,await Ue(l.hash.sha1,r)]),this.iv)}}async decrypt(t){if(this.isDummy())return!1;if(this.unparseableKeyMaterial)throw Error("Key packet cannot be decrypted: unsupported S2K or cipher algo");if(this.isDecrypted())throw Error("Key packet is already decrypted.");let e;const r=Bn(this.constructor.tag);if(this.s2kUsage!==254&&this.s2kUsage!==253)throw this.s2kUsage===255?Error("Encrypted private key is authenticated using an insecure two-byte hash"):Error("Private key is encrypted using an insecure S2K function: unsalted MD5");let n;if(e=await Es(this.version,this.s2k,t,this.symmetric,this.aead,r,this.isLegacyAEAD),this.s2kUsage===253){const s=ze(this.aead,!0),a=await s(this.symmetric,e);try{const o=this.isLegacyAEAD?new Uint8Array:p.concatUint8Array([r,this.writePublicKey()]);n=await a.decrypt(this.keyMaterial,this.iv.subarray(0,s.ivLength),o)}catch(o){throw o.message==="Authentication tag mismatch"?Error("Incorrect key passphrase: "+o.message):o}}else{const s=await Vn(this.symmetric,e,this.keyMaterial,this.iv);n=s.subarray(0,-20);const a=await Ue(l.hash.sha1,n);if(!p.equalsUint8Array(a,s.subarray(-20)))throw Error("Incorrect key passphrase")}try{const{privateParams:s}=vo(this.algorithm,n,this.publicParams);this.privateParams=s}catch{throw Error("Error reading MPIs")}this.isEncrypted=!1,this.keyMaterial=null,this.s2kUsage=0,this.aead=null,this.symmetric=null,this.isLegacyAEAD=null}async validate(){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key is not decrypted");if(this.usedModernAEAD)return;let t;try{t=await K0(this.algorithm,this.publicParams,this.privateParams)}catch{t=!1}if(!t)throw Error("Key is invalid")}async generate(t,e){if(this.version===6&&(this.algorithm===l.publicKey.ecdh&&e===l.curve.curve25519Legacy||this.algorithm===l.publicKey.eddsaLegacy))throw Error(`Cannot generate v6 keys of type 'ecc' with curve ${e}. Generate a key of type 'curve25519' instead`);const{privateParams:r,publicParams:n}=await C0(this.algorithm,t,e);this.privateParams=r,this.publicParams=n,this.isEncrypted=!1}clearPrivateParams(){this.isMissingSecretKeyMaterial()||(Object.keys(this.privateParams).forEach(t=>{this.privateParams[t].fill(0),delete this.privateParams[t]}),this.privateParams=null,this.isEncrypted=!0)}}async function Es(i,t,e,r,n,s,a){if(t.type==="argon2"&&!n)throw Error("Using Argon2 S2K without AEAD is not allowed");if(t.type==="simple"&&i===6)throw Error("Using Simple S2K with version 6 keys is not allowed");const{keySize:o}=ct(r),c=await t.produceKey(e,o);if(!n||i===5||a)return c;const u=p.concatUint8Array([s,new Uint8Array([i,r,n])]);return yr(l.hash.sha256,c,new Uint8Array,u,o)}class Xn{static get tag(){return l.packet.userID}constructor(){this.userID="",this.name="",this.email="",this.comment=""}static fromObject(t){if(p.isString(t)||t.name&&!p.isString(t.name)||t.email&&!p.isEmailAddress(t.email)||t.comment&&!p.isString(t.comment))throw Error("Invalid user ID format");const e=new Xn;Object.assign(e,t);const r=[];return e.name&&r.push(e.name),e.comment&&r.push(`(${e.comment})`),e.email&&r.push(`<${e.email}>`),e.userID=r.join(" "),e}read(t,e=O){const r=p.decodeUTF8(t);if(r.length>e.maxUserIDLength)throw Error("User ID string is too long");const n=/^(?<name>[^()]+\s+)?(?<comment>\([^()]+\)\s+)?(?<email><\S+@\S+>)$/.exec(r);if(n!==null){const{name:s,comment:a,email:o}=n.groups;this.comment=(a==null?void 0:a.replace(/^\(|\)|\s$/g,"").trim())||"",this.name=(s==null?void 0:s.trim())||"",this.email=o.substring(1,o.length-1)}else/^[^\s@]+@[^\s@]+$/.test(r)&&(this.email=r);this.userID=r}write(){return p.encodeUTF8(this.userID)}equals(t){return t&&t.userID===this.userID}}class Lc extends Qa{static get tag(){return l.packet.secretSubkey}constructor(t=new Date,e=O){super(t,e)}}class Mc{constructor(t){this.packets=t||new it}write(){return this.packets.write()}armor(t=O){const e=this.packets.some(r=>r.constructor.tag===Rt.tag&&r.version!==6);return ji(l.armor.signature,this.write(),void 0,void 0,void 0,e,t)}getSigningKeyIDs(){return this.packets.map(t=>t.issuerKeyID)}}async function Fc(i,t){const e=new Lc(i.date,t);return e.packets=null,e.algorithm=l.write(l.publicKey,i.algorithm),await e.generate(i.rsaBits,i.curve),await e.computeFingerprintAndKeyID(),e}async function h5(i,t){const e=new Qa(i.date,t);return e.packets=null,e.algorithm=l.write(l.publicKey,i.algorithm),await e.generate(i.rsaBits,i.curve,i.config),await e.computeFingerprintAndKeyID(),e}async function he(i,t,e,r,n=new Date,s){let a,o;for(let c=i.length-1;c>=0;c--)try{(!a||i[c].created>=a.created)&&(await i[c].verify(t,e,r,n,void 0,s),a=i[c])}catch(u){o=u}if(!a)throw p.wrapError(`Could not find valid ${l.read(l.signature,e)} signature in key ${t.getKeyID().toHex()}`.replace("certGeneric ","self-").replace(/([a-z])([A-Z])/g,(c,u,h)=>u+" "+h.toLowerCase()),o);return a}function ca(i,t,e=new Date){const r=p.normalizeDate(e);if(r!==null){const n=Ln(i,t);return!(i.created<=r&&r<n)}return!1}async function Nc(i,t,e,r){const n={};n.key=t,n.bind=i;const s={signatureType:l.signature.subkeyBinding};return e.sign?(s.keyFlags=[l.keyFlags.signData],s.embeddedSignature=await Ke(n,[],i,{signatureType:l.signature.keyBinding},e.date,void 0,void 0,void 0,r)):s.keyFlags=[l.keyFlags.encryptCommunication|l.keyFlags.encryptStorage],e.keyExpirationTime>0&&(s.keyExpirationTime=e.keyExpirationTime,s.keyNeverExpires=!1),await Ke(n,[],t,s,e.date,void 0,void 0,void 0,r)}async function l5(i,t,e=new Date,r=[],n){const s=l.hash.sha256,a=n.preferredHashAlgorithm,o=await Promise.all(i.map(async(f,y)=>(await f.getPrimarySelfSignature(e,r[y],n)).preferredHashAlgorithms||[])),c=new Map;for(const f of o)for(const y of f)try{const g=l.write(l.hash,y);c.set(g,c.has(g)?c.get(g)+1:1)}catch{}const u=f=>i.length===0||c.get(f)===i.length||f===s,h=()=>{if(c.size===0)return s;const f=Array.from(c.keys()).filter(y=>u(y)).sort((y,g)=>Bt(y)-Bt(g))[0];return Bt(f)>=Bt(s)?f:s};if(new Set([l.publicKey.ecdsa,l.publicKey.eddsaLegacy,l.publicKey.ed25519,l.publicKey.ed448]).has(t.algorithm)){const f=function(A,d){switch(A){case l.publicKey.ecdsa:case l.publicKey.eddsaLegacy:return yc(d);case l.publicKey.ed25519:case l.publicKey.ed448:return Gn(A);default:throw Error("Unknown elliptic signing algo")}}(t.algorithm,t.publicParams.oid),y=u(a),g=Bt(a)>=Bt(f);if(y&&g)return a;{const A=h();return Bt(A)>=Bt(f)?A:f}}return u(a)?a:h()}async function Ke(i,t,e,r,n,s,a=[],o=!1,c){if(e.isDummy())throw Error("Cannot sign with a gnu-dummy key.");if(!e.isDecrypted())throw Error("Signing key is not decrypted.");const u=new Rt;return Object.assign(u,r),u.publicKeyAlgorithm=e.algorithm,u.hashAlgorithm=await l5(t,e,n,s,c),u.rawNotations=[...a],await u.sign(e,i,n,o,c),u}async function Sr(i,t,e,r=new Date,n){(i=i[e])&&(t[e].length?await Promise.all(i.map(async function(s){s.isExpired(r)||n&&!await n(s)||t[e].some(function(a){return p.equalsUint8Array(a.writeParams(),s.writeParams())})||t[e].push(s)})):t[e]=i)}async function si(i,t,e,r,n,s,a=new Date,o){s=s||i;const c=[];return await Promise.all(r.map(async function(u){try{if(!n||u.issuerKeyID.equals(n.issuerKeyID)){const h=![l.reasonForRevocation.keyRetired,l.reasonForRevocation.keySuperseded,l.reasonForRevocation.userIDInvalid].includes(u.reasonForRevocationFlag);await u.verify(s,t,e,h?null:a,!1,o),c.push(u.issuerKeyID)}}catch{}})),n?(n.revoked=!!c.some(u=>u.equals(n.issuerKeyID))||n.revoked||!1,n.revoked):c.length>0}function Ln(i,t){let e;return t.keyNeverExpires===!1&&(e=i.created.getTime()+1e3*t.keyExpirationTime),e?new Date(e):1/0}function ua(i,t={}){switch(i.type=i.type||t.type,i.curve=i.curve||t.curve,i.rsaBits=i.rsaBits||t.rsaBits,i.keyExpirationTime=i.keyExpirationTime!==void 0?i.keyExpirationTime:t.keyExpirationTime,i.passphrase=p.isString(i.passphrase)?i.passphrase:t.passphrase,i.date=i.date||t.date,i.sign=i.sign||!1,i.type){case"ecc":try{i.curve=l.write(l.curve,i.curve)}catch{throw Error("Unknown curve")}i.curve!==l.curve.ed25519Legacy&&i.curve!==l.curve.curve25519Legacy&&i.curve!=="ed25519"&&i.curve!=="curve25519"||(i.curve=i.sign?l.curve.ed25519Legacy:l.curve.curve25519Legacy),i.sign?i.algorithm=i.curve===l.curve.ed25519Legacy?l.publicKey.eddsaLegacy:l.publicKey.ecdsa:i.algorithm=l.publicKey.ecdh;break;case"curve25519":i.algorithm=i.sign?l.publicKey.ed25519:l.publicKey.x25519;break;case"curve448":i.algorithm=i.sign?l.publicKey.ed448:l.publicKey.x448;break;case"rsa":i.algorithm=l.publicKey.rsaEncryptSign;break;default:throw Error("Unsupported key type "+i.type)}return i}function Fo(i,t,e){switch(i.algorithm){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:case l.publicKey.dsa:case l.publicKey.ecdsa:case l.publicKey.eddsaLegacy:case l.publicKey.ed25519:case l.publicKey.ed448:if(!t.keyFlags&&!e.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!t.keyFlags||!!(t.keyFlags[0]&l.keyFlags.signData);default:return!1}}function No(i,t,e){switch(i.algorithm){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.elgamal:case l.publicKey.ecdh:case l.publicKey.x25519:case l.publicKey.x448:if(!t.keyFlags&&!e.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!t.keyFlags||!!(t.keyFlags[0]&l.keyFlags.encryptCommunication)||!!(t.keyFlags[0]&l.keyFlags.encryptStorage);default:return!1}}function Oo(i,t,e){if(!t.keyFlags&&!e.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");switch(i.algorithm){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.elgamal:case l.publicKey.ecdh:case l.publicKey.x25519:case l.publicKey.x448:return!(!(!t.keyFlags||t.keyFlags[0]&l.keyFlags.signData)||!e.allowInsecureDecryptionWithSigningKeys)||!t.keyFlags||!!(t.keyFlags[0]&l.keyFlags.encryptCommunication)||!!(t.keyFlags[0]&l.keyFlags.encryptStorage);default:return!1}}function ir(i,t){const e=l.write(l.publicKey,i.algorithm),r=i.getAlgorithmInfo();if(t.rejectPublicKeyAlgorithms.has(e))throw Error(r.algorithm+" keys are considered too weak.");switch(e){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:case l.publicKey.rsaEncrypt:if(r.bits<t.minRSABits)throw Error(`RSA keys shorter than ${t.minRSABits} bits are considered too weak.`);break;case l.publicKey.ecdsa:case l.publicKey.eddsaLegacy:case l.publicKey.ecdh:if(t.rejectCurves.has(r.curve))throw Error(`Support for ${r.algorithm} keys using curve ${r.curve} is disabled.`)}}class Ri{constructor(t,e){this.userID=t.constructor.tag===l.packet.userID?t:null,this.userAttribute=t.constructor.tag===l.packet.userAttribute?t:null,this.selfCertifications=[],this.otherCertifications=[],this.revocationSignatures=[],this.mainKey=e}toPacketList(){const t=new it;return t.push(this.userID||this.userAttribute),t.push(...this.revocationSignatures),t.push(...this.selfCertifications),t.push(...this.otherCertifications),t}clone(){const t=new Ri(this.userID||this.userAttribute,this.mainKey);return t.selfCertifications=[...this.selfCertifications],t.otherCertifications=[...this.otherCertifications],t.revocationSignatures=[...this.revocationSignatures],t}async certify(t,e,r){const n=this.mainKey.keyPacket,s={userID:this.userID,userAttribute:this.userAttribute,key:n},a=new Ri(s.userID||s.userAttribute,this.mainKey);return a.otherCertifications=await Promise.all(t.map(async function(o){if(!o.isPrivate())throw Error("Need private key for signing");if(o.hasSameFingerprintAs(n))throw Error("The user's own key can only be used for self-certifications");const c=await o.getSigningKey(void 0,e,void 0,r);return Ke(s,[o],c.keyPacket,{signatureType:l.signature.certGeneric,keyFlags:[l.keyFlags.certifyKeys|l.keyFlags.signData]},e,void 0,void 0,void 0,r)})),await a.update(this,e,r),a}async isRevoked(t,e,r=new Date,n=O){const s=this.mainKey.keyPacket;return si(s,l.signature.certRevocation,{key:s,userID:this.userID,userAttribute:this.userAttribute},this.revocationSignatures,t,e,r,n)}async verifyCertificate(t,e,r=new Date,n){const s=this,a=this.mainKey.keyPacket,o={userID:this.userID,userAttribute:this.userAttribute,key:a},{issuerKeyID:c}=t,u=e.filter(h=>h.getKeys(c).length>0);return u.length===0?null:(await Promise.all(u.map(async h=>{const f=await h.getSigningKey(c,t.created,void 0,n);if(t.revoked||await s.isRevoked(t,f.keyPacket,r,n))throw Error("User certificate is revoked");try{await t.verify(f.keyPacket,l.signature.certGeneric,o,r,void 0,n)}catch(y){throw p.wrapError("User certificate is invalid",y)}})),!0)}async verifyAllCertifications(t,e=new Date,r){const n=this,s=this.selfCertifications.concat(this.otherCertifications);return Promise.all(s.map(async a=>({keyID:a.issuerKeyID,valid:await n.verifyCertificate(a,t,e,r).catch(()=>!1)})))}async verify(t=new Date,e){if(!this.selfCertifications.length)throw Error("No self-certifications found");const r=this,n=this.mainKey.keyPacket,s={userID:this.userID,userAttribute:this.userAttribute,key:n};let a;for(let o=this.selfCertifications.length-1;o>=0;o--)try{const c=this.selfCertifications[o];if(c.revoked||await r.isRevoked(c,void 0,t,e))throw Error("Self-certification is revoked");try{await c.verify(n,l.signature.certGeneric,s,t,void 0,e)}catch(u){throw p.wrapError("Self-certification is invalid",u)}return!0}catch(c){a=c}throw a}async update(t,e,r){const n=this.mainKey.keyPacket,s={userID:this.userID,userAttribute:this.userAttribute,key:n};await Sr(t,this,"selfCertifications",e,async function(a){try{return await a.verify(n,l.signature.certGeneric,s,e,!1,r),!0}catch{return!1}}),await Sr(t,this,"otherCertifications",e),await Sr(t,this,"revocationSignatures",e,function(a){return si(n,l.signature.certRevocation,s,[a],void 0,void 0,e,r)})}async revoke(t,{flag:e=l.reasonForRevocation.noReason,string:r=""}={},n=new Date,s=O){const a={userID:this.userID,userAttribute:this.userAttribute,key:t},o=new Ri(a.userID||a.userAttribute,this.mainKey);return o.revocationSignatures.push(await Ke(a,[],t,{signatureType:l.signature.certRevocation,reasonForRevocationFlag:l.write(l.reasonForRevocation,e),reasonForRevocationString:r},n,void 0,void 0,!1,s)),await o.update(this),o}}class ai{constructor(t,e){this.keyPacket=t,this.bindingSignatures=[],this.revocationSignatures=[],this.mainKey=e}toPacketList(){const t=new it;return t.push(this.keyPacket),t.push(...this.revocationSignatures),t.push(...this.bindingSignatures),t}clone(){const t=new ai(this.keyPacket,this.mainKey);return t.bindingSignatures=[...this.bindingSignatures],t.revocationSignatures=[...this.revocationSignatures],t}async isRevoked(t,e,r=new Date,n=O){const s=this.mainKey.keyPacket;return si(s,l.signature.subkeyRevocation,{key:s,bind:this.keyPacket},this.revocationSignatures,t,e,r,n)}async verify(t=new Date,e=O){const r=this.mainKey.keyPacket,n={key:r,bind:this.keyPacket},s=await he(this.bindingSignatures,r,l.signature.subkeyBinding,n,t,e);if(s.revoked||await this.isRevoked(s,null,t,e))throw Error("Subkey is revoked");if(ca(this.keyPacket,s,t))throw Error("Subkey is expired");return s}async getExpirationTime(t=new Date,e=O){const r=this.mainKey.keyPacket,n={key:r,bind:this.keyPacket};let s;try{s=await he(this.bindingSignatures,r,l.signature.subkeyBinding,n,t,e)}catch{return null}const a=Ln(this.keyPacket,s),o=s.getExpirationTime();return a<o?a:o}async update(t,e=new Date,r=O){const n=this.mainKey.keyPacket;if(!this.hasSameFingerprintAs(t))throw Error("Subkey update method: fingerprints of subkeys not equal");this.keyPacket.constructor.tag===l.packet.publicSubkey&&t.keyPacket.constructor.tag===l.packet.secretSubkey&&(this.keyPacket=t.keyPacket);const s=this,a={key:n,bind:s.keyPacket};await Sr(t,this,"bindingSignatures",e,async function(o){for(let c=0;c<s.bindingSignatures.length;c++)if(s.bindingSignatures[c].issuerKeyID.equals(o.issuerKeyID))return o.created>s.bindingSignatures[c].created&&(s.bindingSignatures[c]=o),!1;try{return await o.verify(n,l.signature.subkeyBinding,a,e,void 0,r),!0}catch{return!1}}),await Sr(t,this,"revocationSignatures",e,function(o){return si(n,l.signature.subkeyRevocation,a,[o],void 0,void 0,e,r)})}async revoke(t,{flag:e=l.reasonForRevocation.noReason,string:r=""}={},n=new Date,s=O){const a={key:t,bind:this.keyPacket},o=new ai(this.keyPacket,this.mainKey);return o.revocationSignatures.push(await Ke(a,[],t,{signatureType:l.signature.subkeyRevocation,reasonForRevocationFlag:l.write(l.reasonForRevocation,e),reasonForRevocationString:r},n,void 0,void 0,!1,s)),await o.update(this),o}hasSameFingerprintAs(t){return this.keyPacket.hasSameFingerprintAs(t.keyPacket||t)}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","isDecrypted"].forEach(i=>{ai.prototype[i]=function(){return this.keyPacket[i]()}});const f5=p.constructAllowedPackets([Rt]),Ho=new Set([l.packet.publicKey,l.packet.privateKey]),zo=new Set([l.packet.publicKey,l.packet.privateKey,l.packet.publicSubkey,l.packet.privateSubkey]);class Oc{packetListToStructure(t,e=new Set){let r,n,s,a;for(const o of t){if(o instanceof js){zo.has(o.tag)&&!a&&(a=Ho.has(o.tag)?Ho:zo);continue}const c=o.constructor.tag;if(a){if(!a.has(c))continue;a=null}if(e.has(c))throw Error("Unexpected packet type: "+c);switch(c){case l.packet.publicKey:case l.packet.secretKey:if(this.keyPacket)throw Error("Key block contains multiple keys");if(this.keyPacket=o,n=this.getKeyID(),!n)throw Error("Missing Key ID");break;case l.packet.userID:case l.packet.userAttribute:r=new Ri(o,this),this.users.push(r);break;case l.packet.publicSubkey:case l.packet.secretSubkey:r=null,s=new ai(o,this),this.subkeys.push(s);break;case l.packet.signature:switch(o.signatureType){case l.signature.certGeneric:case l.signature.certPersona:case l.signature.certCasual:case l.signature.certPositive:if(!r){p.printDebug("Dropping certification signatures without preceding user packet");continue}o.issuerKeyID.equals(n)?r.selfCertifications.push(o):r.otherCertifications.push(o);break;case l.signature.certRevocation:r?r.revocationSignatures.push(o):this.directSignatures.push(o);break;case l.signature.key:this.directSignatures.push(o);break;case l.signature.subkeyBinding:if(!s){p.printDebug("Dropping subkey binding signature without preceding subkey packet");continue}s.bindingSignatures.push(o);break;case l.signature.keyRevocation:this.revocationSignatures.push(o);break;case l.signature.subkeyRevocation:if(!s){p.printDebug("Dropping subkey revocation signature without preceding subkey packet");continue}s.revocationSignatures.push(o)}}}}toPacketList(){const t=new it;return t.push(this.keyPacket),t.push(...this.revocationSignatures),t.push(...this.directSignatures),this.users.map(e=>t.push(...e.toPacketList())),this.subkeys.map(e=>t.push(...e.toPacketList())),t}clone(t=!1){const e=new this.constructor(this.toPacketList());return t&&e.getKeys().forEach(r=>{if(r.keyPacket=Object.create(Object.getPrototypeOf(r.keyPacket),Object.getOwnPropertyDescriptors(r.keyPacket)),!r.keyPacket.isDecrypted())return;const n={};Object.keys(r.keyPacket.privateParams).forEach(s=>{n[s]=new Uint8Array(r.keyPacket.privateParams[s])}),r.keyPacket.privateParams=n}),e}getSubkeys(t=null){return this.subkeys.filter(e=>!t||e.getKeyID().equals(t,!0))}getKeys(t=null){const e=[];return t&&!this.getKeyID().equals(t,!0)||e.push(this),e.concat(this.getSubkeys(t))}getKeyIDs(){return this.getKeys().map(t=>t.getKeyID())}getUserIDs(){return this.users.map(t=>t.userID?t.userID.userID:null).filter(t=>t!==null)}write(){return this.toPacketList().write()}async getSigningKey(t=null,e=new Date,r={},n=O){await this.verifyPrimaryKey(e,r,n);const s=this.keyPacket;try{ir(s,n)}catch(c){throw p.wrapError("Could not verify primary key",c)}const a=this.subkeys.slice().sort((c,u)=>u.keyPacket.created-c.keyPacket.created);let o;for(const c of a)if(!t||c.getKeyID().equals(t))try{await c.verify(e,n);const u={key:s,bind:c.keyPacket},h=await he(c.bindingSignatures,s,l.signature.subkeyBinding,u,e,n);if(!Fo(c.keyPacket,h,n))continue;if(!h.embeddedSignature)throw Error("Missing embedded signature");return await he([h.embeddedSignature],c.keyPacket,l.signature.keyBinding,u,e,n),ir(c.keyPacket,n),c}catch(u){o=u}try{const c=await this.getPrimarySelfSignature(e,r,n);if((!t||s.getKeyID().equals(t))&&Fo(s,c,n))return ir(s,n),this}catch(c){o=c}throw p.wrapError("Could not find valid signing key packet in key "+this.getKeyID().toHex(),o)}async getEncryptionKey(t,e=new Date,r={},n=O){await this.verifyPrimaryKey(e,r,n);const s=this.keyPacket;try{ir(s,n)}catch(c){throw p.wrapError("Could not verify primary key",c)}const a=this.subkeys.slice().sort((c,u)=>u.keyPacket.created-c.keyPacket.created);let o;for(const c of a)if(!t||c.getKeyID().equals(t))try{await c.verify(e,n);const u={key:s,bind:c.keyPacket},h=await he(c.bindingSignatures,s,l.signature.subkeyBinding,u,e,n);if(No(c.keyPacket,h,n))return ir(c.keyPacket,n),c}catch(u){o=u}try{const c=await this.getPrimarySelfSignature(e,r,n);if((!t||s.getKeyID().equals(t))&&No(s,c,n))return ir(s,n),this}catch(c){o=c}throw p.wrapError("Could not find valid encryption key packet in key "+this.getKeyID().toHex(),o)}async isRevoked(t,e,r=new Date,n=O){return si(this.keyPacket,l.signature.keyRevocation,{key:this.keyPacket},this.revocationSignatures,t,e,r,n)}async verifyPrimaryKey(t=new Date,e={},r=O){const n=this.keyPacket;if(await this.isRevoked(null,null,t,r))throw Error("Primary key is revoked");if(ca(n,await this.getPrimarySelfSignature(t,e,r),t))throw Error("Primary key is expired");if(n.version!==6){const s=await he(this.directSignatures,n,l.signature.key,{key:n},t,r).catch(()=>{});if(s&&ca(n,s,t))throw Error("Primary key is expired")}}async getExpirationTime(t,e=O){let r;try{const n=await this.getPrimarySelfSignature(null,t,e),s=Ln(this.keyPacket,n),a=n.getExpirationTime(),o=this.keyPacket.version!==6&&await he(this.directSignatures,this.keyPacket,l.signature.key,{key:this.keyPacket},null,e).catch(()=>{});if(o){const c=Ln(this.keyPacket,o);r=Math.min(s,a,c)}else r=s<a?s:a}catch{r=null}return p.normalizeDate(r)}async getPrimarySelfSignature(t=new Date,e={},r=O){const n=this.keyPacket;if(n.version===6)return he(this.directSignatures,n,l.signature.key,{key:n},t,r);const{selfCertification:s}=await this.getPrimaryUser(t,e,r);return s}async getPrimaryUser(t=new Date,e={},r=O){const n=this.keyPacket,s=[];let a;for(let h=0;h<this.users.length;h++)try{const f=this.users[h];if(!f.userID)continue;if(e.name!==void 0&&f.userID.name!==e.name||e.email!==void 0&&f.userID.email!==e.email||e.comment!==void 0&&f.userID.comment!==e.comment)throw Error("Could not find user that matches that user ID");const y={userID:f.userID,key:n},g=await he(f.selfCertifications,n,l.signature.certGeneric,y,t,r);s.push({index:h,user:f,selfCertification:g})}catch(f){a=f}if(!s.length)throw a||Error("Could not find primary user");await Promise.all(s.map(async function(h){return h.selfCertification.revoked||h.user.isRevoked(h.selfCertification,null,t,r)}));const o=s.sort(function(h,f){const y=h.selfCertification,g=f.selfCertification;return g.revoked-y.revoked||y.isPrimaryUserID-g.isPrimaryUserID||y.created-g.created}).pop(),{user:c,selfCertification:u}=o;if(u.revoked||await c.isRevoked(u,null,t,r))throw Error("Primary user is revoked");return o}async update(t,e=new Date,r=O){if(!this.hasSameFingerprintAs(t))throw Error("Primary key fingerprints must be equal to update the key");if(!this.isPrivate()&&t.isPrivate()){if(!(this.subkeys.length===t.subkeys.length&&this.subkeys.every(s=>t.subkeys.some(a=>s.hasSameFingerprintAs(a)))))throw Error("Cannot update public key with private key if subkeys mismatch");return t.update(this,r)}const n=this.clone();return await Sr(t,n,"revocationSignatures",e,s=>si(n.keyPacket,l.signature.keyRevocation,n,[s],null,t.keyPacket,e,r)),await Sr(t,n,"directSignatures",e),await Promise.all(t.users.map(async s=>{const a=n.users.filter(o=>s.userID&&s.userID.equals(o.userID)||s.userAttribute&&s.userAttribute.equals(o.userAttribute));if(a.length>0)await Promise.all(a.map(o=>o.update(s,e,r)));else{const o=s.clone();o.mainKey=n,n.users.push(o)}})),await Promise.all(t.subkeys.map(async s=>{const a=n.subkeys.filter(o=>o.hasSameFingerprintAs(s));if(a.length>0)await Promise.all(a.map(o=>o.update(s,e,r)));else{const o=s.clone();o.mainKey=n,n.subkeys.push(o)}})),n}async getRevocationCertificate(t=new Date,e=O){const r={key:this.keyPacket},n=await he(this.revocationSignatures,this.keyPacket,l.signature.keyRevocation,r,t,e),s=new it;s.push(n);const a=this.keyPacket.version!==6;return ji(l.armor.publicKey,s.write(),null,null,"This is a revocation certificate",a,e)}async applyRevocationCertificate(t,e=new Date,r=O){const n=await _i(t),s=(await it.fromBinary(n.data,f5,r)).findPacket(l.packet.signature);if(!s||s.signatureType!==l.signature.keyRevocation)throw Error("Could not find revocation signature packet");if(!s.issuerKeyID.equals(this.getKeyID()))throw Error("Revocation signature does not match key");try{await s.verify(this.keyPacket,l.signature.keyRevocation,{key:this.keyPacket},e,void 0,r)}catch(o){throw p.wrapError("Could not verify revocation signature",o)}const a=this.clone();return a.revocationSignatures.push(s),a}async signPrimaryUser(t,e,r,n=O){const{index:s,user:a}=await this.getPrimaryUser(e,r,n),o=await a.certify(t,e,n),c=this.clone();return c.users[s]=o,c}async signAllUsers(t,e=new Date,r=O){const n=this.clone();return n.users=await Promise.all(this.users.map(function(s){return s.certify(t,e,r)})),n}async verifyPrimaryUser(t,e=new Date,r,n=O){const s=this.keyPacket,{user:a}=await this.getPrimaryUser(e,r,n);return t?await a.verifyAllCertifications(t,e,n):[{keyID:s.getKeyID(),valid:await a.verify(e,n).catch(()=>!1)}]}async verifyAllUsers(t,e=new Date,r=O){const n=this.keyPacket,s=[];return await Promise.all(this.users.map(async a=>{const o=t?await a.verifyAllCertifications(t,e,r):[{keyID:n.getKeyID(),valid:await a.verify(e,r).catch(()=>!1)}];s.push(...o.map(c=>({userID:a.userID?a.userID.userID:null,userAttribute:a.userAttribute,keyID:c.keyID,valid:c.valid})))})),s}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","hasSameFingerprintAs"].forEach(i=>{Oc.prototype[i]=ai.prototype[i]});class ha extends Oc{constructor(t){if(super(),this.keyPacket=null,this.revocationSignatures=[],this.directSignatures=[],this.users=[],this.subkeys=[],t&&(this.packetListToStructure(t,new Set([l.packet.secretKey,l.packet.secretSubkey])),!this.keyPacket))throw Error("Invalid key: missing public-key packet")}isPrivate(){return!1}toPublic(){return this}armor(t=O){const e=this.keyPacket.version!==6;return ji(l.armor.publicKey,this.toPacketList().write(),void 0,void 0,void 0,e,t)}}class Yi extends ha{constructor(t){if(super(),this.packetListToStructure(t,new Set([l.packet.publicKey,l.packet.publicSubkey])),!this.keyPacket)throw Error("Invalid key: missing private-key packet")}isPrivate(){return!0}toPublic(){const t=new it,e=this.toPacketList();for(const r of e)switch(r.constructor.tag){case l.packet.secretKey:{const n=Be.fromSecretKeyPacket(r);t.push(n);break}case l.packet.secretSubkey:{const n=$n.fromSecretSubkeyPacket(r);t.push(n);break}default:t.push(r)}return new ha(t)}armor(t=O){const e=this.keyPacket.version!==6;return ji(l.armor.privateKey,this.toPacketList().write(),void 0,void 0,void 0,e,t)}async getDecryptionKeys(t,e=new Date,r={},n=O){const s=this.keyPacket,a=[];let o=null;for(let u=0;u<this.subkeys.length;u++)if(!t||this.subkeys[u].getKeyID().equals(t,!0)){if(this.subkeys[u].keyPacket.isDummy()){o=o||Error("Gnu-dummy key packets cannot be used for decryption");continue}try{const h={key:s,bind:this.subkeys[u].keyPacket},f=await he(this.subkeys[u].bindingSignatures,s,l.signature.subkeyBinding,h,e,n);Oo(this.subkeys[u].keyPacket,f,n)&&a.push(this.subkeys[u])}catch(h){o=h}}const c=await this.getPrimarySelfSignature(e,r,n);if(t&&!s.getKeyID().equals(t,!0)||!Oo(s,c,n)||(s.isDummy()?o=o||Error("Gnu-dummy key packets cannot be used for decryption"):a.push(this)),a.length===0)throw o||Error("No decryption key packets found");return a}isDecrypted(){return this.getKeys().some(({keyPacket:t})=>t.isDecrypted())}async validate(t=O){if(!this.isPrivate())throw Error("Cannot validate a public key");let e;if(this.keyPacket.isDummy()){const r=await this.getSigningKey(null,null,void 0,{...t,rejectPublicKeyAlgorithms:new Set,minRSABits:0});r&&!r.keyPacket.isDummy()&&(e=r.keyPacket)}else e=this.keyPacket;if(e)return e.validate();{const r=this.getKeys();if(r.map(n=>n.keyPacket.isDummy()).every(Boolean))throw Error("Cannot validate an all-gnu-dummy key");return Promise.all(r.map(async n=>n.keyPacket.validate()))}}clearPrivateParams(){this.getKeys().forEach(({keyPacket:t})=>{t.isDecrypted()&&t.clearPrivateParams()})}async revoke({flag:t=l.reasonForRevocation.noReason,string:e=""}={},r=new Date,n=O){if(!this.isPrivate())throw Error("Need private key for revoking");const s={key:this.keyPacket},a=this.clone();return a.revocationSignatures.push(await Ke(s,[],this.keyPacket,{signatureType:l.signature.keyRevocation,reasonForRevocationFlag:l.write(l.reasonForRevocation,t),reasonForRevocationString:e},r,void 0,void 0,void 0,n)),a}async addSubkey(t={}){const e={...O,...t.config};if(t.passphrase)throw Error("Subkey could not be encrypted here, please encrypt whole key");if(t.rsaBits<e.minRSABits)throw Error(`rsaBits should be at least ${e.minRSABits}, got: ${t.rsaBits}`);const r=this.keyPacket;if(r.isDummy())throw Error("Cannot add subkey to gnu-dummy primary key");if(!r.isDecrypted())throw Error("Key is not decrypted");const n=r.getAlgorithmInfo();n.type=function(c){switch(l.write(l.publicKey,c)){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:case l.publicKey.dsa:return"rsa";case l.publicKey.ecdsa:case l.publicKey.eddsaLegacy:return"ecc";case l.publicKey.ed25519:return"curve25519";case l.publicKey.ed448:return"curve448";default:throw Error("Unsupported algorithm")}}(n.algorithm),n.rsaBits=n.bits||4096,n.curve=n.curve||"curve25519Legacy",t=ua(t,n);const s=await Fc(t,{...e,v6Keys:this.keyPacket.version===6});ir(s,e);const a=await Nc(s,r,t,e),o=this.toPacketList();return o.push(s,a),new Yi(o)}}const Hc=p.constructAllowedPackets([Be,$n,Qa,Lc,Xn,xa,Rt]);function y5(i){for(const t of i)switch(t.constructor.tag){case l.packet.secretKey:return new Yi(i);case l.packet.publicKey:return new ha(i)}throw Error("No key packet found")}async function g5(i,t,e,r){e.passphrase&&await i.encrypt(e.passphrase,r),await Promise.all(t.map(async function(c,u){const h=e.subkeys[u].passphrase;h&&await c.encrypt(h,r)}));const n=new it;function s(c,u){return[u,...c.filter(h=>h!==u)]}function a(){const c={};c.keyFlags=[l.keyFlags.certifyKeys|l.keyFlags.signData];const u=s([l.symmetric.aes256,l.symmetric.aes128],r.preferredSymmetricAlgorithm);if(c.preferredSymmetricAlgorithms=u,r.aeadProtect){const h=s([l.aead.gcm,l.aead.eax,l.aead.ocb],r.preferredAEADAlgorithm);c.preferredCipherSuites=h.flatMap(f=>u.map(y=>[y,f]))}return c.preferredHashAlgorithms=s([l.hash.sha512,l.hash.sha256,l.hash.sha3_512,l.hash.sha3_256],r.preferredHashAlgorithm),c.preferredCompressionAlgorithms=s([l.compression.uncompressed,l.compression.zlib,l.compression.zip],r.preferredCompressionAlgorithm),c.features=[0],c.features[0]|=l.features.modificationDetection,r.aeadProtect&&(c.features[0]|=l.features.seipdv2),e.keyExpirationTime>0&&(c.keyExpirationTime=e.keyExpirationTime,c.keyNeverExpires=!1),c}if(n.push(i),i.version===6){const c={key:i},u=a();u.signatureType=l.signature.key;const h=await Ke(c,[],i,u,e.date,void 0,void 0,void 0,r);n.push(h)}await Promise.all(e.userIDs.map(async function(c,u){const h=Xn.fromObject(c),f={userID:h,key:i},y=i.version!==6?a():{};return y.signatureType=l.signature.certPositive,u===0&&(y.isPrimaryUserID=!0),{userIDPacket:h,signaturePacket:await Ke(f,[],i,y,e.date,void 0,void 0,void 0,r)}})).then(c=>{c.forEach(({userIDPacket:u,signaturePacket:h})=>{n.push(u),n.push(h)})}),await Promise.all(t.map(async function(c,u){const h=e.subkeys[u];return{secretSubkeyPacket:c,subkeySignaturePacket:await Nc(c,i,h,r)}})).then(c=>{c.forEach(({secretSubkeyPacket:u,subkeySignaturePacket:h})=>{n.push(u),n.push(h)})});const o={key:i};return n.push(await Ke(o,[],i,{signatureType:l.signature.keyRevocation,reasonForRevocationFlag:l.reasonForRevocation.noReason,reasonForRevocationString:""},e.date,void 0,void 0,void 0,r)),e.passphrase&&i.clearPrivateParams(),await Promise.all(t.map(async function(c,u){e.subkeys[u].passphrase&&c.clearPrivateParams()})),new Yi(n)}async function zc({armoredKey:i,binaryKey:t,config:e,...r}){if(e={...O,...e},!i&&!t)throw Error("readKey: must pass options object containing `armoredKey` or `binaryKey`");if(i&&!p.isString(i))throw Error("readKey: options.armoredKey must be a string");if(t&&!p.isUint8Array(t))throw Error("readKey: options.binaryKey must be a Uint8Array");const n=Object.keys(r);if(n.length>0)throw Error("Unknown option: "+n.join(", "));let s;if(i){const{type:c,data:u}=await _i(i);if(c!==l.armor.publicKey&&c!==l.armor.privateKey)throw Error("Armored text not of type key");s=u}else s=t;const a=await it.fromBinary(s,Hc,e),o=a.indexOfTag(l.packet.publicKey,l.packet.secretKey);if(o.length===0)throw Error("No key packet found");return y5(a.slice(o[0],o[1]))}async function p5({armoredKey:i,binaryKey:t,config:e,...r}){if(e={...O,...e},!i&&!t)throw Error("readPrivateKey: must pass options object containing `armoredKey` or `binaryKey`");if(i&&!p.isString(i))throw Error("readPrivateKey: options.armoredKey must be a string");if(t&&!p.isUint8Array(t))throw Error("readPrivateKey: options.binaryKey must be a Uint8Array");const n=Object.keys(r);if(n.length>0)throw Error("Unknown option: "+n.join(", "));let s;if(i){const{type:c,data:u}=await _i(i);if(c!==l.armor.privateKey)throw Error("Armored text not of type private key");s=u}else s=t;const a=await it.fromBinary(s,Hc,e),o=a.indexOfTag(l.packet.publicKey,l.packet.secretKey);for(let c=0;c<o.length;c++){if(a[o[c]].constructor.tag===l.packet.publicKey)continue;const u=a.slice(o[c],o[c+1]);return new Yi(u)}throw Error("No secret key packet found")}const d5=p.constructAllowedPackets([hi,Ji,o5,ii,u5,zi,ni,se,Rt]),A5=p.constructAllowedPackets([ni]),w5=p.constructAllowedPackets([Rt]);class re{constructor(t){this.packets=t||new it}getEncryptionKeyIDs(){const t=[];return this.packets.filterByTag(l.packet.publicKeyEncryptedSessionKey).forEach(function(e){t.push(e.publicKeyID)}),t}getSigningKeyIDs(){const t=this.unwrapCompressed(),e=t.packets.filterByTag(l.packet.onePassSignature);return e.length>0?e.map(r=>r.issuerKeyID):t.packets.filterByTag(l.packet.signature).map(r=>r.issuerKeyID)}async decrypt(t,e,r,n=new Date,s=O){const a=this.packets.filterByTag(l.packet.symmetricallyEncryptedData,l.packet.symEncryptedIntegrityProtectedData,l.packet.aeadEncryptedData);if(a.length===0)throw Error("No encrypted data found");const o=a[0],c=o.cipherAlgorithm,u=r||await this.decryptSessionKeys(t,e,c,n,s);let h=null;const f=Promise.all(u.map(async({algorithm:g,data:A})=>{if(!p.isUint8Array(A)||!o.cipherAlgorithm&&!p.isString(g))throw Error("Invalid session key for decryption.");try{const d=o.cipherAlgorithm||l.write(l.symmetric,g);await o.decrypt(d,A,s)}catch(d){p.printDebugError(d),h=d}}));if(Ms(o.encrypted),o.encrypted=null,await f,!o.packets||!o.packets.length)throw h||Error("Decryption failed.");const y=new re(o.packets);return o.packets=new it,y}async decryptSessionKeys(t,e,r,n=new Date,s=O){let a,o=[];if(e){const c=this.packets.filterByTag(l.packet.symEncryptedSessionKey);if(c.length===0)throw Error("No symmetrically encrypted session key packet found.");await Promise.all(e.map(async function(u,h){let f;f=h?await it.fromBinary(c.write(),A5,s):c,await Promise.all(f.map(async function(y){try{await y.decrypt(u),o.push(y)}catch(g){p.printDebugError(g),g instanceof Jn&&(a=g)}}))}))}else{if(!t)throw Error("No key or password specified.");{const c=this.packets.filterByTag(l.packet.publicKeyEncryptedSessionKey);if(c.length===0)throw Error("No public key encrypted session key packet found.");await Promise.all(c.map(async function(u){await Promise.all(t.map(async function(h){let f;try{f=(await h.getDecryptionKeys(u.publicKeyID,null,void 0,s)).map(g=>g.keyPacket)}catch(g){return void(a=g)}let y=[l.symmetric.aes256,l.symmetric.aes128,l.symmetric.tripledes,l.symmetric.cast5];try{const g=await h.getPrimarySelfSignature(n,void 0,s);g.preferredSymmetricAlgorithms&&(y=y.concat(g.preferredSymmetricAlgorithms))}catch{}await Promise.all(f.map(async function(g){if(!g.isDecrypted())throw Error("Decryption key is not decrypted.");if(s.constantTimePKCS1Decryption&&(u.publicKeyAlgorithm===l.publicKey.rsaEncrypt||u.publicKeyAlgorithm===l.publicKey.rsaEncryptSign||u.publicKeyAlgorithm===l.publicKey.rsaSign||u.publicKeyAlgorithm===l.publicKey.elgamal)){const A=u.write();await Promise.all((r?[r]:Array.from(s.constantTimePKCS1DecryptionSupportedSymmetricAlgorithms)).map(async d=>{const w=new zi;w.read(A);const k={sessionKeyAlgorithm:d,sessionKey:$s(d)};try{await w.decrypt(g,k),o.push(w)}catch(v){p.printDebugError(v),a=v}}))}else try{await u.decrypt(g);const A=r||u.sessionKeyAlgorithm;if(A&&!y.includes(l.write(l.symmetric,A)))throw Error("A non-preferred symmetric algorithm was used.");o.push(u)}catch(A){p.printDebugError(A),a=A}}))})),Ms(u.encrypted),u.encrypted=null}))}}if(o.length>0){if(o.length>1){const c=new Set;o=o.filter(u=>{const h=u.sessionKeyAlgorithm+p.uint8ArrayToString(u.sessionKey);return!c.has(h)&&(c.add(h),!0)})}return o.map(c=>({data:c.sessionKey,algorithm:c.sessionKeyAlgorithm&&l.read(l.symmetric,c.sessionKeyAlgorithm)}))}throw a||Error("Session key decryption failed.")}getLiteralData(){const t=this.unwrapCompressed().packets.findPacket(l.packet.literalData);return t&&t.getBytes()||null}getFilename(){const t=this.unwrapCompressed().packets.findPacket(l.packet.literalData);return t&&t.getFilename()||null}getText(){const t=this.unwrapCompressed().packets.findPacket(l.packet.literalData);return t?t.getText():null}static async generateSessionKey(t=[],e=new Date,r=[],n=O){const{symmetricAlgo:s,aeadAlgo:a}=await async function(u=[],h=new Date,f=[],y=O){const g=await Promise.all(u.map((w,k)=>w.getPrimarySelfSignature(h,f[k],y)));if(u.length?g.every(w=>w.features&&w.features[0]&l.features.seipdv2):y.aeadProtect){const w={symmetricAlgo:l.symmetric.aes128,aeadAlgo:l.aead.ocb},k=[{symmetricAlgo:y.preferredSymmetricAlgorithm,aeadAlgo:y.preferredAEADAlgorithm},{symmetricAlgo:y.preferredSymmetricAlgorithm,aeadAlgo:l.aead.ocb},{symmetricAlgo:l.symmetric.aes128,aeadAlgo:y.preferredAEADAlgorithm}];for(const v of k)if(g.every(b=>b.preferredCipherSuites&&b.preferredCipherSuites.some(E=>E[0]===v.symmetricAlgo&&E[1]===v.aeadAlgo)))return v;return w}const A=l.symmetric.aes128,d=y.preferredSymmetricAlgorithm;return{symmetricAlgo:g.every(w=>w.preferredSymmetricAlgorithms&&w.preferredSymmetricAlgorithms.includes(d))?d:A,aeadAlgo:void 0}}(t,e,r,n),o=l.read(l.symmetric,s),c=a?l.read(l.aead,a):void 0;return await Promise.all(t.map(u=>u.getEncryptionKey().catch(()=>null).then(h=>{if(h&&(h.keyPacket.algorithm===l.publicKey.x25519||h.keyPacket.algorithm===l.publicKey.x448)&&!c&&!p.isAES(s))throw Error("Could not generate a session key compatible with the given `encryptionKeys`: X22519 and X448 keys can only be used to encrypt AES session keys; change `config.preferredSymmetricAlgorithm` accordingly.")}))),{data:$s(s),algorithm:o,aeadAlgorithm:c}}async encrypt(t,e,r,n=!1,s=[],a=new Date,o=[],c=O){if(r){if(!p.isUint8Array(r.data)||!p.isString(r.algorithm))throw Error("Invalid session key for encryption.")}else if(t&&t.length)r=await re.generateSessionKey(t,a,o,c);else{if(!e||!e.length)throw Error("No keys, passwords, or session key provided.");r=await re.generateSessionKey(void 0,void 0,void 0,c)}const{data:u,algorithm:h,aeadAlgorithm:f}=r,y=await re.encryptSessionKey(u,h,f,t,e,n,s,a,o,c),g=ii.fromObject({version:f?2:1,aeadAlgorithm:f?l.write(l.aead,f):null});g.packets=this.packets;const A=l.write(l.symmetric,h);return await g.encrypt(A,u,c),y.packets.push(g),g.packets=new it,y}static async encryptSessionKey(t,e,r,n,s,a=!1,o=[],c=new Date,u=[],h=O){const f=new it,y=l.write(l.symmetric,e),g=r&&l.write(l.aead,r);if(n){const A=await Promise.all(n.map(async function(d,w){const k=await d.getEncryptionKey(o[w],c,u,h),v=zi.fromObject({version:g?6:3,encryptionKeyPacket:k.keyPacket,anonymousRecipient:a,sessionKey:t,sessionKeyAlgorithm:y});return await v.encrypt(k.keyPacket),delete v.sessionKey,v}));f.push(...A)}if(s){const A=async function(v,b){try{return await v.decrypt(b),1}catch{return 0}},d=(v,b)=>v+b,w=async function(v,b,E,U){const D=new ni(h);return D.sessionKey=v,D.sessionKeyAlgorithm=b,E&&(D.aeadAlgorithm=E),await D.encrypt(U,h),h.passwordCollisionCheck&&(await Promise.all(s.map(x=>A(D,x)))).reduce(d)!==1?w(v,b,U):(delete D.sessionKey,D)},k=await Promise.all(s.map(v=>w(t,y,g,v)));f.push(...k)}return new re(f)}async sign(t=[],e=[],r=null,n=[],s=new Date,a=[],o=[],c=[],u=O){const h=new it,f=this.packets.findPacket(l.packet.literalData);if(!f)throw Error("No literal data packet to sign.");const y=await Go(f,t,e,r,n,s,a,o,c,!1,u),g=y.map((A,d)=>se.fromSignaturePacket(A,d===0)).reverse();return h.push(...g),h.push(f),h.push(...y),new re(h)}compress(t,e=O){if(t===l.compression.uncompressed)return this;const r=new Ji(e);r.algorithm=t,r.packets=this.packets;const n=new it;return n.push(r),new re(n)}async signDetached(t=[],e=[],r=null,n=[],s=[],a=new Date,o=[],c=[],u=O){const h=this.packets.findPacket(l.packet.literalData);if(!h)throw Error("No literal data packet to sign.");return new Mc(await Go(h,t,e,r,n,s,a,o,c,!0,u))}async verify(t,e=new Date,r=O){const n=this.unwrapCompressed(),s=n.packets.filterByTag(l.packet.literalData);if(s.length!==1)throw Error("Can only verify message with one literal data packet.");vt(n.packets.stream)&&n.packets.push(...await It(n.packets.stream,c=>c||[]));const a=n.packets.filterByTag(l.packet.onePassSignature).reverse(),o=n.packets.filterByTag(l.packet.signature);return a.length&&!o.length&&p.isStream(n.packets.stream)&&!vt(n.packets.stream)?(await Promise.all(a.map(async c=>{c.correspondingSig=new Promise((u,h)=>{c.correspondingSigResolve=u,c.correspondingSigReject=h}),c.signatureData=dr(async()=>(await c.correspondingSig).signatureData),c.hashed=It(await c.hash(c.signatureType,s[0],void 0,!1)),c.hashed.catch(()=>{})})),n.packets.stream=pr(n.packets.stream,async(c,u)=>{const h=_e(c),f=Xt(u);try{for(let y=0;y<a.length;y++){const{value:g}=await h.read();a[y].correspondingSigResolve(g)}await h.readToEnd(),await f.ready,await f.close()}catch(y){a.forEach(g=>{g.correspondingSigReject(y)}),await f.abort(y)}}),vs(a,s,t,e,!1,r)):vs(o,s,t,e,!1,r)}verifyDetached(t,e,r=new Date,n=O){const s=this.unwrapCompressed().packets.filterByTag(l.packet.literalData);if(s.length!==1)throw Error("Can only verify message with one literal data packet.");return vs(t.packets.filterByTag(l.packet.signature),s,e,r,!0,n)}unwrapCompressed(){const t=this.packets.filterByTag(l.packet.compressedData);return t.length?new re(t[0].packets):this}async appendSignature(t,e=O){await this.packets.read(p.isUint8Array(t)?t:(await _i(t)).data,w5,e)}write(){return this.packets.write()}armor(t=O){const e=this.packets[this.packets.length-1],r=e.constructor.tag===ii.tag?e.version!==2:this.packets.some(n=>n.constructor.tag===Rt.tag&&n.version!==6);return ji(l.armor.message,this.write(),null,null,null,r,t)}}async function Go(i,t,e=[],r=null,n=[],s=new Date,a=[],o=[],c=[],u=!1,h=O){const f=new it,y=i.text===null?l.signature.binary:l.signature.text;if(await Promise.all(t.map(async(g,A)=>{const d=a[A];if(!g.isPrivate())throw Error("Need private key for signing");const w=await g.getSigningKey(n[A],s,d,h);return Ke(i,e.length?e:[g],w.keyPacket,{signatureType:y},s,o,c,u,h)})).then(g=>{f.push(...g)}),r){const g=r.packets.filterByTag(l.packet.signature);f.push(...g)}return f}async function vs(i,t,e,r=new Date,n=!1,s=O){return Promise.all(i.filter(function(a){return["text","binary"].includes(l.read(l.signature,a.signatureType))}).map(async function(a){return async function(o,c,u,h=new Date,f=!1,y=O){let g,A;for(const k of u){const v=k.getKeys(o.issuerKeyID);if(v.length>0){g=k,A=v[0];break}}const d=o instanceof se?o.correspondingSig:o,w={keyID:o.issuerKeyID,verified:(async()=>{if(!A)throw Error("Could not find signing key with key ID "+o.issuerKeyID.toHex());await o.verify(A.keyPacket,o.signatureType,c[0],h,f,y);const k=await d;if(A.getCreationTime()>k.created)throw Error("Key is newer than the signature");try{await g.getSigningKey(A.getKeyID(),k.created,void 0,y)}catch(v){if(!y.allowInsecureVerificationWithReformattedKeys||!v.message.match(/Signature creation time is in the future/))throw v;await g.getSigningKey(A.getKeyID(),h,void 0,y)}return!0})(),signature:(async()=>{const k=await d,v=new it;return k&&v.push(k),new Mc(v)})()};return w.signature.catch(()=>{}),w.verified.catch(()=>{}),w}(a,t,e,r,n,s)}))}async function m5({armoredMessage:i,binaryMessage:t,config:e,...r}){e={...O,...e};let n=i||t;if(!n)throw Error("readMessage: must pass options object containing `armoredMessage` or `binaryMessage`");if(i&&!p.isString(i)&&!p.isStream(i))throw Error("readMessage: options.armoredMessage must be a string or stream");if(t&&!p.isUint8Array(t)&&!p.isStream(t))throw Error("readMessage: options.binaryMessage must be a Uint8Array or stream");const s=Object.keys(r);if(s.length>0)throw Error("Unknown option: "+s.join(", "));const a=p.isStream(n);if(i){const{type:u,data:h}=await _i(n);if(u!==l.armor.message)throw Error("Armored text not of type message");n=h}const o=await it.fromBinary(n,d5,e),c=new re(o);return c.fromStream=a,c}async function Gc({text:i,binary:t,filename:e,date:r=new Date,format:n=i!==void 0?"utf8":"binary",...s}){const a=i!==void 0?i:t;if(a===void 0)throw Error("createMessage: must pass options object containing `text` or `binary`");if(i&&!p.isString(i)&&!p.isStream(i))throw Error("createMessage: options.text must be a string or stream");if(t&&!p.isUint8Array(t)&&!p.isStream(t))throw Error("createMessage: options.binary must be a Uint8Array or stream");const o=Object.keys(s);if(o.length>0)throw Error("Unknown option: "+o.join(", "));const c=p.isStream(a),u=new hi(r);i!==void 0?u.setText(a,l.write(l.literal,n)):u.setBytes(a,l.write(l.literal,n)),e!==void 0&&u.setFilename(e);const h=new it;h.push(u);const f=new re(h);return f.fromStream=c,f}async function b5({userIDs:i=[],passphrase:t,type:e,curve:r,rsaBits:n=4096,keyExpirationTime:s=0,date:a=new Date,subkeys:o=[{}],format:c="armored",config:u,...h}){ts(u={...O,...u}),e||r?(e=e||"ecc",r=r||"curve25519Legacy"):(e=u.v6Keys?"curve25519":"ecc",r="curve25519Legacy"),i=$t(i);const f=Object.keys(h);if(f.length>0)throw Error("Unknown option: "+f.join(", "));if(i.length===0&&!u.v6Keys)throw Error("UserIDs are required for V4 keys");if(e==="rsa"&&n<u.minRSABits)throw Error(`rsaBits should be at least ${u.minRSABits}, got: ${n}`);const y={userIDs:i,passphrase:t,type:e,rsaBits:n,curve:r,keyExpirationTime:s,date:a,subkeys:o};try{const{key:g,revocationCertificate:A}=await async function(d,w){d.sign=!0,(d=ua(d)).subkeys=d.subkeys.map((U,D)=>ua(d.subkeys[D],d));let k=[h5(d,w)];k=k.concat(d.subkeys.map(U=>Fc(U,w)));const v=await Promise.all(k),b=await g5(v[0],v.slice(1),d,w),E=await b.getRevocationCertificate(d.date,w);return b.revocationSignatures=[],{key:b,revocationCertificate:E}}(y,u);return g.getKeys().forEach(({keyPacket:d})=>ir(d,u)),{privateKey:qo(g,c,u),publicKey:qo(g.toPublic(),c,u),revocationCertificate:A}}catch(g){throw p.wrapError("Error generating keypair",g)}}async function k5({privateKey:i,passphrase:t,config:e,...r}){ts(e={...O,...e});const n=Object.keys(r);if(n.length>0)throw Error("Unknown option: "+n.join(", "));if(!i.isPrivate())throw Error("Cannot decrypt a public key");const s=i.clone(!0),a=p.isArray(t)?t:[t];try{return await Promise.all(s.getKeys().map(o=>p.anyPromise(a.map(c=>o.keyPacket.decrypt(c))))),await s.validate(e),s}catch(o){throw s.clearPrivateParams(),p.wrapError("Error decrypting private key",o)}}async function qc({message:i,encryptionKeys:t,signingKeys:e,passwords:r,sessionKey:n,format:s="armored",signature:a=null,wildcard:o=!1,signingKeyIDs:c=[],encryptionKeyIDs:u=[],date:h=new Date,signingUserIDs:f=[],encryptionUserIDs:y=[],signatureNotations:g=[],config:A,...d}){if(ts(A={...O,...A}),_c(i),v5(s),t=$t(t),e=$t(e),r=$t(r),c=$t(c),u=$t(u),f=$t(f),y=$t(y),g=$t(g),d.detached)throw Error("The `detached` option has been removed from openpgp.encrypt, separately call openpgp.sign instead. Don't forget to remove the `privateKeys` option as well.");if(d.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.encrypt, pass `encryptionKeys` instead");if(d.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.encrypt, pass `signingKeys` instead");if(d.armor!==void 0)throw Error("The `armor` option has been removed from openpgp.encrypt, pass `format` instead.");const w=Object.keys(d);if(w.length>0)throw Error("Unknown option: "+w.join(", "));e||(e=[]);try{if((e.length||a)&&(i=await i.sign(e,t,a,c,h,f,u,g,A)),i=i.compress(await async function(v=[],b=new Date,E=[],U=O){const D=l.compression.uncompressed,x=U.preferredCompressionAlgorithm;return(await Promise.all(v.map(async function(m,K){const C=(await m.getPrimarySelfSignature(b,E[K],U)).preferredCompressionAlgorithms;return!!C&&C.indexOf(x)>=0}))).every(Boolean)?x:D}(t,h,y,A),A),i=await i.encrypt(t,r,n,o,u,h,y,A),s==="object")return i;const k=s==="armored"?i.armor(A):i.write();return await jc(k)}catch(k){throw p.wrapError("Error encrypting message",k)}}async function E5({message:i,decryptionKeys:t,passwords:e,sessionKeys:r,verificationKeys:n,expectSigned:s=!1,format:a="utf8",signature:o=null,date:c=new Date,config:u,...h}){if(ts(u={...O,...u}),_c(i),n=$t(n),t=$t(t),e=$t(e),r=$t(r),h.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.decrypt, pass `decryptionKeys` instead");if(h.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.decrypt, pass `verificationKeys` instead");const f=Object.keys(h);if(f.length>0)throw Error("Unknown option: "+f.join(", "));try{const y=await i.decrypt(t,e,r,c,u);n||(n=[]);const g={};if(g.signatures=o?await y.verifyDetached(o,n,c,u):await y.verify(n,c,u),g.data=a==="binary"?y.getLiteralData():y.getText(),g.filename=y.getFilename(),I5(g,i),s){if(n.length===0)throw Error("Verification keys are required to verify message signatures");if(g.signatures.length===0)throw Error("Message is not signed");g.data=qt([g.data,dr(async()=>(await p.anyPromise(g.signatures.map(A=>A.verified)),a==="binary"?new Uint8Array:""))])}return g.data=await jc(g.data),g}catch(y){throw p.wrapError("Error decrypting message",y)}}function _c(i){if(!(i instanceof re))throw Error("Parameter [message] needs to be of type Message")}function v5(i){if(i!=="armored"&&i!=="binary"&&i!=="object")throw Error("Unsupported format "+i)}const B5=Object.keys(O).length;function ts(i){const t=Object.keys(i);if(t.length!==B5){for(const e of t)if(O[e]===void 0)throw Error("Unknown config property: "+e)}}function $t(i){return i&&!p.isArray(i)&&(i=[i]),i}async function jc(i){return p.isStream(i)==="array"?It(i):i}function I5(i,t){i.data=pr(t.packets.stream,async(e,r)=>{await Cr(i.data,r,{preventClose:!0});const n=Xt(r);try{await It(e,s=>s),await n.close()}catch(s){await n.abort(s)}})}function qo(i,t,e){switch(t){case"object":return i;case"armored":return i.armor(e);case"binary":return i.write();default:throw Error("Unsupported format "+t)}}function Mn(i){if(!Number.isSafeInteger(i)||i<0)throw Error("positive integer expected, not "+i)}function Zi(i,...t){if(!((e=i)instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"))throw Error("Uint8Array expected");var e;if(t.length>0&&!t.includes(i.length))throw Error(`Uint8Array expected of length ${t}, not of length=${i.length}`)}function oi(i,t=!0){if(i.destroyed)throw Error("Hash instance has been destroyed");if(t&&i.finished)throw Error("Hash#digest() has already been called")}function Vc(i,t){Zi(i);const e=t.outputLen;if(i.length<e)throw Error("digestInto() expects output buffer of length at least "+e)}const Nr=typeof Lt=="object"&&"crypto"in Lt?Lt.crypto:void 0,Bs=i=>new DataView(i.buffer,i.byteOffset,i.byteLength),ge=(i,t)=>i<<32-t|i>>>t,or=(i,t)=>i<<t|i>>>32-t>>>0,_o=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function jo(i){for(let e=0;e<i.length;e++)i[e]=(t=i[e])<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;var t}function Jc(i){if(typeof i!="string")throw Error("utf8ToBytes expected string, got "+typeof i);return new Uint8Array(new TextEncoder().encode(i))}function Wi(i){return typeof i=="string"&&(i=Jc(i)),Zi(i),i}function Yc(...i){let t=0;for(let r=0;r<i.length;r++){const n=i[r];Zi(n),t+=n.length}const e=new Uint8Array(t);for(let r=0,n=0;r<i.length;r++){const s=i[r];e.set(s,n),n+=s.length}return e}class Ra{clone(){return this._cloneInto()}}function De(i){const t=r=>i().update(Wi(r)).digest(),e=i();return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=()=>i(),t}function Ta(i=32){if(Nr&&typeof Nr.getRandomValues=="function")return Nr.getRandomValues(new Uint8Array(i));if(Nr&&typeof Nr.randomBytes=="function")return Nr.randomBytes(i);throw Error("crypto.getRandomValues must be defined")}const Zc=(i,t,e)=>i&t^~i&e,Wc=(i,t,e)=>i&t^i&e^t&e;class $i extends Ra{constructor(t,e,r,n){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Bs(this.buffer)}update(t){oi(this);const{view:e,buffer:r,blockLen:n}=this,s=(t=Wi(t)).length;for(let a=0;a<s;){const o=Math.min(n-this.pos,s-a);if(o!==n)r.set(t.subarray(a,a+o),this.pos),this.pos+=o,a+=o,this.pos===n&&(this.process(e,0),this.pos=0);else{const c=Bs(t);for(;n<=s-a;a+=n)this.process(c,a)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){oi(this),Vc(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:n,isLE:s}=this;let{pos:a}=this;e[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>n-a&&(this.process(r,0),a=0);for(let f=a;f<n;f++)e[f]=0;(function(f,y,g,A){if(typeof f.setBigUint64=="function")return f.setBigUint64(y,g,A);const d=BigInt(32),w=BigInt(4294967295),k=Number(g>>d&w),v=Number(g&w),b=A?4:0,E=A?0:4;f.setUint32(y+b,k,A),f.setUint32(y+E,v,A)})(r,n-8,BigInt(8*this.length),s),this.process(r,0);const o=Bs(t),c=this.outputLen;if(c%4)throw Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,h=this.get();if(u>h.length)throw Error("_sha2: outputLen bigger than state");for(let f=0;f<u;f++)o.setUint32(4*f,h[f],s)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:n,finished:s,destroyed:a,pos:o}=this;return t.length=n,t.pos=o,t.finished=s,t.destroyed=a,n%e&&t.buffer.set(r),t}}const S5=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Je=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ye=new Uint32Array(64);class $c extends $i{constructor(){super(64,32,8,!1),this.A=0|Je[0],this.B=0|Je[1],this.C=0|Je[2],this.D=0|Je[3],this.E=0|Je[4],this.F=0|Je[5],this.G=0|Je[6],this.H=0|Je[7]}get(){const{A:t,B:e,C:r,D:n,E:s,F:a,G:o,H:c}=this;return[t,e,r,n,s,a,o,c]}set(t,e,r,n,s,a,o,c){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|s,this.F=0|a,this.G=0|o,this.H=0|c}process(t,e){for(let f=0;f<16;f++,e+=4)Ye[f]=t.getUint32(e,!1);for(let f=16;f<64;f++){const y=Ye[f-15],g=Ye[f-2],A=ge(y,7)^ge(y,18)^y>>>3,d=ge(g,17)^ge(g,19)^g>>>10;Ye[f]=d+Ye[f-7]+A+Ye[f-16]|0}let{A:r,B:n,C:s,D:a,E:o,F:c,G:u,H:h}=this;for(let f=0;f<64;f++){const y=h+(ge(o,6)^ge(o,11)^ge(o,25))+Zc(o,c,u)+S5[f]+Ye[f]|0,g=(ge(r,2)^ge(r,13)^ge(r,22))+Wc(r,n,s)|0;h=u,u=c,c=o,o=a+y|0,a=s,s=n,n=r,r=y+g|0}r=r+this.A|0,n=n+this.B|0,s=s+this.C|0,a=a+this.D|0,o=o+this.E|0,c=c+this.F|0,u=u+this.G|0,h=h+this.H|0,this.set(r,n,s,a,o,c,u,h)}roundClean(){Ye.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class C5 extends $c{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const es=De(()=>new $c),K5=De(()=>new C5);class Xc extends Ra{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,function(a){if(typeof a!="function"||typeof a.create!="function")throw Error("Hash should be wrapped by utils.wrapConstructor");Mn(a.outputLen),Mn(a.blockLen)}(t);const r=Wi(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,s=new Uint8Array(n);s.set(r.length>n?t.create().update(r).digest():r);for(let a=0;a<s.length;a++)s[a]^=54;this.iHash.update(s),this.oHash=t.create();for(let a=0;a<s.length;a++)s[a]^=106;this.oHash.update(s),s.fill(0)}update(t){return oi(this),this.iHash.update(t),this}digestInto(t){oi(this),Zi(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:n,destroyed:s,blockLen:a,outputLen:o}=this;return t.finished=n,t.destroyed=s,t.blockLen=a,t.outputLen=o,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const t3=(i,t,e)=>new Xc(i,t).update(e).digest();t3.create=(i,t)=>new Xc(i,t);const La=BigInt(0),Fn=BigInt(1),U5=BigInt(2);function Pr(i){return i instanceof Uint8Array||i!=null&&typeof i=="object"&&i.constructor.name==="Uint8Array"}function Xi(i){if(!Pr(i))throw Error("Uint8Array expected")}function Ge(i,t){if(typeof t!="boolean")throw Error(`${i} must be valid boolean, got "${t}".`)}const D5=Array.from({length:256},(i,t)=>t.toString(16).padStart(2,"0"));function xr(i){Xi(i);let t="";for(let e=0;e<i.length;e++)t+=D5[i[e]];return t}function Yr(i){const t=i.toString(16);return 1&t.length?"0"+t:t}function Ma(i){if(typeof i!="string")throw Error("hex string expected, got "+typeof i);return BigInt(i===""?"0":"0x"+i)}const Re={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function Vo(i){return i>=Re._0&&i<=Re._9?i-Re._0:i>=Re._A&&i<=Re._F?i-(Re._A-10):i>=Re._a&&i<=Re._f?i-(Re._a-10):void 0}function ci(i){if(typeof i!="string")throw Error("hex string expected, got "+typeof i);const t=i.length,e=t/2;if(t%2)throw Error("padded hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(e);for(let n=0,s=0;n<e;n++,s+=2){const a=Vo(i.charCodeAt(s)),o=Vo(i.charCodeAt(s+1));if(a===void 0||o===void 0){const c=i[s]+i[s+1];throw Error('hex string expected, got non-hex character "'+c+'" at index '+s)}r[n]=16*a+o}return r}function Ir(i){return Ma(xr(i))}function lr(i){return Xi(i),Ma(xr(Uint8Array.from(i).reverse()))}function Xr(i,t){return ci(i.toString(16).padStart(2*t,"0"))}function ui(i,t){return Xr(i,t).reverse()}function bt(i,t,e){let r;if(typeof t=="string")try{r=ci(t)}catch(s){throw Error(`${i} must be valid hex string, got "${t}". Cause: ${s}`)}else{if(!Pr(t))throw Error(i+" must be hex string or Uint8Array");r=Uint8Array.from(t)}const n=r.length;if(typeof e=="number"&&n!==e)throw Error(`${i} expected ${e} bytes, got ${n}`);return r}function Qr(...i){let t=0;for(let r=0;r<i.length;r++){const n=i[r];Xi(n),t+=n.length}const e=new Uint8Array(t);for(let r=0,n=0;r<i.length;r++){const s=i[r];e.set(s,n),n+=s.length}return e}const Is=i=>typeof i=="bigint"&&La<=i;function rs(i,t,e){return Is(i)&&Is(t)&&Is(e)&&t<=i&&i<e}function _t(i,t,e,r){if(!rs(t,e,r))throw Error(`expected valid ${i}: ${e} <= n < ${r}, got ${typeof t} ${t}`)}function e3(i){let t;for(t=0;i>La;i>>=Fn,t+=1);return t}const Fa=i=>(U5<<BigInt(i-1))-Fn,Ss=i=>new Uint8Array(i),Jo=i=>Uint8Array.from(i);function r3(i,t,e){if(typeof i!="number"||i<2)throw Error("hashLen must be a number");if(typeof t!="number"||t<2)throw Error("qByteLen must be a number");if(typeof e!="function")throw Error("hmacFn must be a function");let r=Ss(i),n=Ss(i),s=0;const a=()=>{r.fill(1),n.fill(0),s=0},o=(...h)=>e(n,r,...h),c=(h=Ss())=>{n=o(Jo([0]),h),r=o(),h.length!==0&&(n=o(Jo([1]),h),r=o())},u=()=>{if(s++>=1e3)throw Error("drbg: tried 1000 values");let h=0;const f=[];for(;h<t;){r=o();const y=r.slice();f.push(y),h+=r.length}return Qr(...f)};return(h,f)=>{let y;for(a(),c(h);!(y=f(u()));)c();return a(),y}}const P5={bigint:i=>typeof i=="bigint",function:i=>typeof i=="function",boolean:i=>typeof i=="boolean",string:i=>typeof i=="string",stringOrUint8Array:i=>typeof i=="string"||Pr(i),isSafeInteger:i=>Number.isSafeInteger(i),array:i=>Array.isArray(i),field:(i,t)=>t.Fp.isValid(i),hash:i=>typeof i=="function"&&Number.isSafeInteger(i.outputLen)};function Rr(i,t,e={}){const r=(n,s,a)=>{const o=P5[s];if(typeof o!="function")throw Error(`Invalid validator "${s}", expected function`);const c=i[n];if(!(a&&c===void 0||o(c,i)))throw Error(`Invalid param ${n+""}=${c} (${typeof c}), expected ${s}`)};for(const[n,s]of Object.entries(t))r(n,s,!1);for(const[n,s]of Object.entries(e))r(n,s,!0);return i}function Gi(i){const t=new WeakMap;return(e,...r)=>{const n=t.get(e);if(n!==void 0)return n;const s=i(e,...r);return t.set(e,s),s}}var x5=Object.freeze({__proto__:null,aInRange:_t,abool:Ge,abytes:Xi,bitGet:function(i,t){return i>>BigInt(t)&Fn},bitLen:e3,bitMask:Fa,bitSet:function(i,t,e){return i|(e?Fn:La)<<BigInt(t)},bytesToHex:xr,bytesToNumberBE:Ir,bytesToNumberLE:lr,concatBytes:Qr,createHmacDrbg:r3,ensureBytes:bt,equalBytes:function(i,t){if(i.length!==t.length)return!1;let e=0;for(let r=0;r<i.length;r++)e|=i[r]^t[r];return e===0},hexToBytes:ci,hexToNumber:Ma,inRange:rs,isBytes:Pr,memoized:Gi,notImplemented:()=>{throw Error("not implemented")},numberToBytesBE:Xr,numberToBytesLE:ui,numberToHexUnpadded:Yr,numberToVarBytesBE:function(i){return ci(Yr(i))},utf8ToBytes:function(i){if(typeof i!="string")throw Error("utf8ToBytes expected string, got "+typeof i);return new Uint8Array(new TextEncoder().encode(i))},validateObject:Rr});/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ct=BigInt(0),Et=BigInt(1),Er=BigInt(2),Q5=BigInt(3),Cs=BigInt(4),Yo=BigInt(5),Zo=BigInt(8);function pt(i,t){const e=i%t;return e>=Ct?e:t+e}function i3(i,t,e){if(e<=Ct||t<Ct)throw Error("Expected power/modulo > 0");if(e===Et)return Ct;let r=Et;for(;t>Ct;)t&Et&&(r=r*i%e),i=i*i%e,t>>=Et;return r}function gt(i,t,e){let r=i;for(;t-- >Ct;)r*=r,r%=e;return r}function la(i,t){if(i===Ct||t<=Ct)throw Error(`invert: expected positive integers, got n=${i} mod=${t}`);let e=pt(i,t),r=t,n=Ct,s=Et;for(;e!==Ct;){const a=r%e,o=n-s*(r/e);r=e,e=a,n=s,s=o}if(r!==Et)throw Error("invert: does not exist");return pt(n,t)}function R5(i){if(i%Cs===Q5){const t=(i+Et)/Cs;return function(e,r){const n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw Error("Cannot find square root");return n}}if(i%Zo===Yo){const t=(i-Yo)/Zo;return function(e,r){const n=e.mul(r,Er),s=e.pow(n,t),a=e.mul(r,s),o=e.mul(e.mul(a,Er),s),c=e.mul(a,e.sub(o,e.ONE));if(!e.eql(e.sqr(c),r))throw Error("Cannot find square root");return c}}return function(t){const e=(t-Et)/Er;let r,n,s;for(r=t-Et,n=0;r%Er===Ct;r/=Er,n++);for(s=Er;s<t&&i3(s,e,t)!==t-Et;s++);if(n===1){const o=(t+Et)/Cs;return function(c,u){const h=c.pow(u,o);if(!c.eql(c.sqr(h),u))throw Error("Cannot find square root");return h}}const a=(r+Et)/Er;return function(o,c){if(o.pow(c,e)===o.neg(o.ONE))throw Error("Cannot find square root");let u=n,h=o.pow(o.mul(o.ONE,s),r),f=o.pow(c,a),y=o.pow(c,r);for(;!o.eql(y,o.ONE);){if(o.eql(y,o.ZERO))return o.ZERO;let g=1;for(let d=o.sqr(y);g<u&&!o.eql(d,o.ONE);g++)d=o.sqr(d);const A=o.pow(h,Et<<BigInt(u-g-1));h=o.sqr(A),f=o.mul(f,A),y=o.mul(y,h),u=g}return f}}(i)}BigInt(9),BigInt(16);const T5=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function n3(i,t){const e=t!==void 0?t:i.toString(2).length;return{nBitLength:e,nByteLength:Math.ceil(e/8)}}function Pe(i,t,e=!1,r={}){if(i<=Ct)throw Error("Expected Field ORDER > 0, got "+i);const{nBitLength:n,nByteLength:s}=n3(i,t);if(s>2048)throw Error("Field lengths over 2048 bytes are not supported");const a=R5(i),o=Object.freeze({ORDER:i,BITS:n,BYTES:s,MASK:Fa(n),ZERO:Ct,ONE:Et,create:c=>pt(c,i),isValid:c=>{if(typeof c!="bigint")throw Error("Invalid field element: expected bigint, got "+typeof c);return Ct<=c&&c<i},is0:c=>c===Ct,isOdd:c=>(c&Et)===Et,neg:c=>pt(-c,i),eql:(c,u)=>c===u,sqr:c=>pt(c*c,i),add:(c,u)=>pt(c+u,i),sub:(c,u)=>pt(c-u,i),mul:(c,u)=>pt(c*u,i),pow:(c,u)=>function(h,f,y){if(y<Ct)throw Error("Expected power > 0");if(y===Ct)return h.ONE;if(y===Et)return f;let g=h.ONE,A=f;for(;y>Ct;)y&Et&&(g=h.mul(g,A)),A=h.sqr(A),y>>=Et;return g}(o,c,u),div:(c,u)=>pt(c*la(u,i),i),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>la(c,i),sqrt:r.sqrt||(c=>a(o,c)),invertBatch:c=>function(u,h){const f=Array(h.length),y=h.reduce((A,d,w)=>u.is0(d)?A:(f[w]=A,u.mul(A,d)),u.ONE),g=u.inv(y);return h.reduceRight((A,d,w)=>u.is0(d)?A:(f[w]=u.mul(A,f[w]),u.mul(A,d)),g),f}(o,c),cmov:(c,u,h)=>h?u:c,toBytes:c=>e?ui(c,s):Xr(c,s),fromBytes:c=>{if(c.length!==s)throw Error(`Fp.fromBytes: expected ${s}, got ${c.length}`);return e?lr(c):Ir(c)}});return Object.freeze(o)}function s3(i){if(typeof i!="bigint")throw Error("field order must be bigint");const t=i.toString(2).length;return Math.ceil(t/8)}function Wo(i){const t=s3(i);return t+Math.ceil(t/2)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const L5=BigInt(0),Ks=BigInt(1),Us=new WeakMap,$o=new WeakMap;function a3(i,t){const e=(s,a)=>{const o=a.negate();return s?o:a},r=s=>{if(!Number.isSafeInteger(s)||s<=0||s>t)throw Error(`Wrong window size=${s}, should be [1..${t}]`)},n=s=>(r(s),{windows:Math.ceil(t/s)+1,windowSize:2**(s-1)});return{constTimeNegate:e,unsafeLadder(s,a){let o=i.ZERO,c=s;for(;a>L5;)a&Ks&&(o=o.add(c)),c=c.double(),a>>=Ks;return o},precomputeWindow(s,a){const{windows:o,windowSize:c}=n(a),u=[];let h=s,f=h;for(let y=0;y<o;y++){f=h,u.push(f);for(let g=1;g<c;g++)f=f.add(h),u.push(f);h=f.double()}return u},wNAF(s,a,o){const{windows:c,windowSize:u}=n(s);let h=i.ZERO,f=i.BASE;const y=BigInt(2**s-1),g=2**s,A=BigInt(s);for(let d=0;d<c;d++){const w=d*u;let k=Number(o&y);o>>=A,k>u&&(k-=g,o+=Ks);const v=w,b=w+Math.abs(k)-1,E=d%2!=0,U=k<0;k===0?f=f.add(e(E,a[v])):h=h.add(e(U,a[b]))}return{p:h,f}},wNAFCached(s,a,o){const c=$o.get(s)||1;let u=Us.get(s);return u||(u=this.precomputeWindow(s,c),c!==1&&Us.set(s,o(u))),this.wNAF(c,u,a)},setWindowSize(s,a){r(a),$o.set(s,a),Us.delete(s)}}}function o3(i,t,e,r){if(!Array.isArray(e)||!Array.isArray(r)||r.length!==e.length)throw Error("arrays of points and scalars must have equal length");r.forEach((h,f)=>{if(!t.isValid(h))throw Error("wrong scalar at index "+f)}),e.forEach((h,f)=>{if(!(h instanceof i))throw Error("wrong point at index "+f)});const n=e3(BigInt(e.length)),s=n>12?n-3:n>4?n-2:n?2:1,a=(1<<s)-1,o=Array(a+1).fill(i.ZERO),c=Math.floor((t.BITS-1)/s)*s;let u=i.ZERO;for(let h=c;h>=0;h-=s){o.fill(i.ZERO);for(let y=0;y<r.length;y++){const g=r[y],A=Number(g>>BigInt(h)&BigInt(a));o[A]=o[A].add(e[y])}let f=i.ZERO;for(let y=o.length-1,g=i.ZERO;y>0;y--)g=g.add(o[y]),f=f.add(g);if(u=u.add(f),h!==0)for(let y=0;y<s;y++)u=u.double()}return u}function Na(i){return Rr(i.Fp,T5.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),Rr(i,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...n3(i.n,i.nBitLength),...i,p:i.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Xo(i){i.lowS!==void 0&&Ge("lowS",i.lowS),i.prehash!==void 0&&Ge("prehash",i.prehash)}const{bytesToNumberBE:M5,hexToBytes:F5}=x5,Ne={Err:class extends Error{constructor(i=""){super(i)}},_tlv:{encode:(i,t)=>{const{Err:e}=Ne;if(i<0||i>256)throw new e("tlv.encode: wrong tag");if(1&t.length)throw new e("tlv.encode: unpadded data");const r=t.length/2,n=Yr(r);if(n.length/2&128)throw new e("tlv.encode: long form length too big");const s=r>127?Yr(n.length/2|128):"";return`${Yr(i)}${s}${n}${t}`},decode(i,t){const{Err:e}=Ne;let r=0;if(i<0||i>256)throw new e("tlv.encode: wrong tag");if(t.length<2||t[r++]!==i)throw new e("tlv.decode: wrong tlv");const n=t[r++];let s=0;if(128&n){const o=127&n;if(!o)throw new e("tlv.decode(long): indefinite length not supported");if(o>4)throw new e("tlv.decode(long): byte length is too big");const c=t.subarray(r,r+o);if(c.length!==o)throw new e("tlv.decode: length bytes not complete");if(c[0]===0)throw new e("tlv.decode(long): zero leftmost byte");for(const u of c)s=s<<8|u;if(r+=o,s<128)throw new e("tlv.decode(long): not minimal encoding")}else s=n;const a=t.subarray(r,r+s);if(a.length!==s)throw new e("tlv.decode: wrong value length");return{v:a,l:t.subarray(r+s)}}},_int:{encode(i){const{Err:t}=Ne;if(i<Oe)throw new t("integer: negative integers are not allowed");let e=Yr(i);if(8&Number.parseInt(e[0],16)&&(e="00"+e),1&e.length)throw new t("unexpected assertion");return e},decode(i){const{Err:t}=Ne;if(128&i[0])throw new t("Invalid signature integer: negative");if(i[0]===0&&!(128&i[1]))throw new t("Invalid signature integer: unnecessary leading zero");return M5(i)}},toSig(i){const{Err:t,_int:e,_tlv:r}=Ne,n=typeof i=="string"?F5(i):i;Xi(n);const{v:s,l:a}=r.decode(48,n);if(a.length)throw new t("Invalid signature: left bytes after parsing");const{v:o,l:c}=r.decode(2,s),{v:u,l:h}=r.decode(2,c);if(h.length)throw new t("Invalid signature: left bytes after parsing");return{r:e.decode(o),s:e.decode(u)}},hexFromSig(i){const{_tlv:t,_int:e}=Ne,r=`${t.encode(2,e.encode(i.r))}${t.encode(2,e.encode(i.s))}`;return t.encode(48,r)}},Oe=BigInt(0),St=BigInt(1);BigInt(2);const t1=BigInt(3);function N5(i){const t=function(A){const d=Na(A);Rr(d,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:w,Fp:k,a:v}=d;if(w){if(!k.eql(v,k.ZERO))throw Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof w!="object"||typeof w.beta!="bigint"||typeof w.splitScalar!="function")throw Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...d})}(i),{Fp:e}=t,r=Pe(t.n,t.nBitLength),n=t.toBytes||((A,d,w)=>{const k=d.toAffine();return Qr(Uint8Array.from([4]),e.toBytes(k.x),e.toBytes(k.y))}),s=t.fromBytes||(A=>{const d=A.subarray(1);return{x:e.fromBytes(d.subarray(0,e.BYTES)),y:e.fromBytes(d.subarray(e.BYTES,2*e.BYTES))}});function a(A){const{a:d,b:w}=t,k=e.sqr(A),v=e.mul(k,A);return e.add(e.add(v,e.mul(A,d)),w)}if(!e.eql(e.sqr(t.Gy),a(t.Gx)))throw Error("bad generator point: equation left != right");function o(A){const{allowedPrivateKeyLengths:d,nByteLength:w,wrapPrivateKey:k,n:v}=t;if(d&&typeof A!="bigint"){if(Pr(A)&&(A=xr(A)),typeof A!="string"||!d.includes(A.length))throw Error("Invalid key");A=A.padStart(2*w,"0")}let b;try{b=typeof A=="bigint"?A:Ir(bt("private key",A,w))}catch{throw Error(`private key must be ${w} bytes, hex or bigint, not ${typeof A}`)}return k&&(b=pt(b,v)),_t("private key",b,St,v),b}function c(A){if(!(A instanceof f))throw Error("ProjectivePoint expected")}const u=Gi((A,d)=>{const{px:w,py:k,pz:v}=A;if(e.eql(v,e.ONE))return{x:w,y:k};const b=A.is0();d==null&&(d=b?e.ONE:e.inv(v));const E=e.mul(w,d),U=e.mul(k,d),D=e.mul(v,d);if(b)return{x:e.ZERO,y:e.ZERO};if(!e.eql(D,e.ONE))throw Error("invZ was invalid");return{x:E,y:U}}),h=Gi(A=>{if(A.is0()){if(t.allowInfinityPoint&&!e.is0(A.py))return;throw Error("bad point: ZERO")}const{x:d,y:w}=A.toAffine();if(!e.isValid(d)||!e.isValid(w))throw Error("bad point: x or y not FE");const k=e.sqr(w),v=a(d);if(!e.eql(k,v))throw Error("bad point: equation left != right");if(!A.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class f{constructor(d,w,k){if(this.px=d,this.py=w,this.pz=k,d==null||!e.isValid(d))throw Error("x required");if(w==null||!e.isValid(w))throw Error("y required");if(k==null||!e.isValid(k))throw Error("z required");Object.freeze(this)}static fromAffine(d){const{x:w,y:k}=d||{};if(!d||!e.isValid(w)||!e.isValid(k))throw Error("invalid affine point");if(d instanceof f)throw Error("projective point not allowed");const v=b=>e.eql(b,e.ZERO);return v(w)&&v(k)?f.ZERO:new f(w,k,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){const w=e.invertBatch(d.map(k=>k.pz));return d.map((k,v)=>k.toAffine(w[v])).map(f.fromAffine)}static fromHex(d){const w=f.fromAffine(s(bt("pointHex",d)));return w.assertValidity(),w}static fromPrivateKey(d){return f.BASE.multiply(o(d))}static msm(d,w){return o3(f,r,d,w)}_setWindowSize(d){g.setWindowSize(this,d)}assertValidity(){h(this)}hasEvenY(){const{y:d}=this.toAffine();if(e.isOdd)return!e.isOdd(d);throw Error("Field doesn't support isOdd")}equals(d){c(d);const{px:w,py:k,pz:v}=this,{px:b,py:E,pz:U}=d,D=e.eql(e.mul(w,U),e.mul(b,v)),x=e.eql(e.mul(k,U),e.mul(E,v));return D&&x}negate(){return new f(this.px,e.neg(this.py),this.pz)}double(){const{a:d,b:w}=t,k=e.mul(w,t1),{px:v,py:b,pz:E}=this;let U=e.ZERO,D=e.ZERO,x=e.ZERO,I=e.mul(v,v),m=e.mul(b,b),K=e.mul(E,E),C=e.mul(v,b);return C=e.add(C,C),x=e.mul(v,E),x=e.add(x,x),U=e.mul(d,x),D=e.mul(k,K),D=e.add(U,D),U=e.sub(m,D),D=e.add(m,D),D=e.mul(U,D),U=e.mul(C,U),x=e.mul(k,x),K=e.mul(d,K),C=e.sub(I,K),C=e.mul(d,C),C=e.add(C,x),x=e.add(I,I),I=e.add(x,I),I=e.add(I,K),I=e.mul(I,C),D=e.add(D,I),K=e.mul(b,E),K=e.add(K,K),I=e.mul(K,C),U=e.sub(U,I),x=e.mul(K,m),x=e.add(x,x),x=e.add(x,x),new f(U,D,x)}add(d){c(d);const{px:w,py:k,pz:v}=this,{px:b,py:E,pz:U}=d;let D=e.ZERO,x=e.ZERO,I=e.ZERO;const m=t.a,K=e.mul(t.b,t1);let C=e.mul(w,b),S=e.mul(k,E),B=e.mul(v,U),P=e.add(w,k),Q=e.add(b,E);P=e.mul(P,Q),Q=e.add(C,S),P=e.sub(P,Q),Q=e.add(w,v);let R=e.add(b,U);return Q=e.mul(Q,R),R=e.add(C,B),Q=e.sub(Q,R),R=e.add(k,v),D=e.add(E,U),R=e.mul(R,D),D=e.add(S,B),R=e.sub(R,D),I=e.mul(m,Q),D=e.mul(K,B),I=e.add(D,I),D=e.sub(S,I),I=e.add(S,I),x=e.mul(D,I),S=e.add(C,C),S=e.add(S,C),B=e.mul(m,B),Q=e.mul(K,Q),S=e.add(S,B),B=e.sub(C,B),B=e.mul(m,B),Q=e.add(Q,B),C=e.mul(S,Q),x=e.add(x,C),C=e.mul(R,Q),D=e.mul(P,D),D=e.sub(D,C),C=e.mul(P,S),I=e.mul(R,I),I=e.add(I,C),new f(D,x,I)}subtract(d){return this.add(d.negate())}is0(){return this.equals(f.ZERO)}wNAF(d){return g.wNAFCached(this,d,f.normalizeZ)}multiplyUnsafe(d){_t("scalar",d,Oe,t.n);const w=f.ZERO;if(d===Oe)return w;if(d===St)return this;const{endo:k}=t;if(!k)return g.unsafeLadder(this,d);let{k1neg:v,k1:b,k2neg:E,k2:U}=k.splitScalar(d),D=w,x=w,I=this;for(;b>Oe||U>Oe;)b&St&&(D=D.add(I)),U&St&&(x=x.add(I)),I=I.double(),b>>=St,U>>=St;return v&&(D=D.negate()),E&&(x=x.negate()),x=new f(e.mul(x.px,k.beta),x.py,x.pz),D.add(x)}multiply(d){const{endo:w,n:k}=t;let v,b;if(_t("scalar",d,St,k),w){const{k1neg:E,k1:U,k2neg:D,k2:x}=w.splitScalar(d);let{p:I,f:m}=this.wNAF(U),{p:K,f:C}=this.wNAF(x);I=g.constTimeNegate(E,I),K=g.constTimeNegate(D,K),K=new f(e.mul(K.px,w.beta),K.py,K.pz),v=I.add(K),b=m.add(C)}else{const{p:E,f:U}=this.wNAF(d);v=E,b=U}return f.normalizeZ([v,b])[0]}multiplyAndAddUnsafe(d,w,k){const v=f.BASE,b=(U,D)=>D!==Oe&&D!==St&&U.equals(v)?U.multiply(D):U.multiplyUnsafe(D),E=b(this,w).add(b(d,k));return E.is0()?void 0:E}toAffine(d){return u(this,d)}isTorsionFree(){const{h:d,isTorsionFree:w}=t;if(d===St)return!0;if(w)return w(f,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:d,clearCofactor:w}=t;return d===St?this:w?w(f,this):this.multiplyUnsafe(t.h)}toRawBytes(d=!0){return Ge("isCompressed",d),this.assertValidity(),n(f,this,d)}toHex(d=!0){return Ge("isCompressed",d),xr(this.toRawBytes(d))}}f.BASE=new f(t.Gx,t.Gy,e.ONE),f.ZERO=new f(e.ZERO,e.ONE,e.ZERO);const y=t.nBitLength,g=a3(f,t.endo?Math.ceil(y/2):y);return{CURVE:t,ProjectivePoint:f,normPrivateKeyToScalar:o,weierstrassEquation:a,isWithinCurveOrder:function(A){return rs(A,St,t.n)}}}function O5(i){const t=function(m){const K=Na(m);return Rr(K,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...K})}(i),{Fp:e,n:r}=t,n=e.BYTES+1,s=2*e.BYTES+1;function a(m){return pt(m,r)}function o(m){return la(m,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:f}=N5({...t,toBytes(m,K,C){const S=K.toAffine(),B=e.toBytes(S.x),P=Qr;return Ge("isCompressed",C),C?P(Uint8Array.from([K.hasEvenY()?2:3]),B):P(Uint8Array.from([4]),B,e.toBytes(S.y))},fromBytes(m){const K=m.length,C=m[0],S=m.subarray(1);if(K!==n||C!==2&&C!==3){if(K===s&&C===4)return{x:e.fromBytes(S.subarray(0,e.BYTES)),y:e.fromBytes(S.subarray(e.BYTES,2*e.BYTES))};throw Error(`Point of length ${K} was invalid. Expected ${n} compressed bytes or ${s} uncompressed bytes`)}{const B=Ir(S);if(!rs(B,St,e.ORDER))throw Error("Point is not on curve");const P=h(B);let Q;try{Q=e.sqrt(P)}catch(R){const L=R instanceof Error?": "+R.message:"";throw Error("Point is not on curve"+L)}return!(1&~C)!=((Q&St)===St)&&(Q=e.neg(Q)),{x:B,y:Q}}}}),y=m=>xr(Xr(m,t.nByteLength));function g(m){return m>r>>St}const A=(m,K,C)=>Ir(m.slice(K,C));class d{constructor(K,C,S){this.r=K,this.s=C,this.recovery=S,this.assertValidity()}static fromCompact(K){const C=t.nByteLength;return K=bt("compactSignature",K,2*C),new d(A(K,0,C),A(K,C,2*C))}static fromDER(K){const{r:C,s:S}=Ne.toSig(bt("DER",K));return new d(C,S)}assertValidity(){_t("r",this.r,St,r),_t("s",this.s,St,r)}addRecoveryBit(K){return new d(this.r,this.s,K)}recoverPublicKey(K){const{r:C,s:S,recovery:B}=this,P=b(bt("msgHash",K));if(B==null||![0,1,2,3].includes(B))throw Error("recovery id invalid");const Q=B===2||B===3?C+t.n:C;if(Q>=e.ORDER)throw Error("recovery id 2 or 3 invalid");const R=1&B?"03":"02",L=c.fromHex(R+y(Q)),q=o(Q),G=a(-P*q),M=a(S*q),F=c.BASE.multiplyAndAddUnsafe(L,G,M);if(!F)throw Error("point at infinify");return F.assertValidity(),F}hasHighS(){return g(this.s)}normalizeS(){return this.hasHighS()?new d(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return ci(this.toDERHex())}toDERHex(){return Ne.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return ci(this.toCompactHex())}toCompactHex(){return y(this.r)+y(this.s)}}const w={isValidPrivateKey(m){try{return u(m),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const m=Wo(t.n);return function(K,C,S=!1){const B=K.length,P=s3(C),Q=Wo(C);if(B<16||B<Q||B>1024)throw Error(`expected ${Q}-1024 bytes of input, got ${B}`);const R=pt(S?Ir(K):lr(K),C-Et)+Et;return S?ui(R,P):Xr(R,P)}(t.randomBytes(m),t.n)},precompute:(m=8,K=c.BASE)=>(K._setWindowSize(m),K.multiply(BigInt(3)),K)};function k(m){const K=Pr(m),C=typeof m=="string",S=(K||C)&&m.length;return K?S===n||S===s:C?S===2*n||S===2*s:m instanceof c}const v=t.bits2int||function(m){const K=Ir(m),C=8*m.length-t.nBitLength;return C>0?K>>BigInt(C):K},b=t.bits2int_modN||function(m){return a(v(m))},E=Fa(t.nBitLength);function U(m){return _t("num < 2^"+t.nBitLength,m,Oe,E),Xr(m,t.nByteLength)}function D(m,K,C=x){if(["recovered","canonical"].some(T=>T in C))throw Error("sign() legacy options not supported");const{hash:S,randomBytes:B}=t;let{lowS:P,prehash:Q,extraEntropy:R}=C;P==null&&(P=!0),m=bt("msgHash",m),Xo(C),Q&&(m=bt("prehashed msgHash",S(m)));const L=b(m),q=u(K),G=[U(q),U(L)];if(R!=null&&R!==!1){const T=R===!0?B(e.BYTES):R;G.push(bt("extraEntropy",T))}const M=Qr(...G),F=L;return{seed:M,k2sig:function(T){const H=v(T);if(!f(H))return;const N=o(H),_=c.BASE.multiply(H).toAffine(),z=a(_.x);if(z===Oe)return;const Y=a(N*a(F+z*q));if(Y===Oe)return;let J=(_.x===z?0:2)|Number(_.y&St),X=Y;return P&&g(Y)&&(X=function(W){return g(W)?a(-W):W}(Y),J^=1),new d(z,X,J)}}}const x={lowS:t.lowS,prehash:!1},I={lowS:t.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(m,K=!0){return c.fromPrivateKey(m).toRawBytes(K)},getSharedSecret:function(m,K,C=!0){if(k(m))throw Error("first arg must be private key");if(!k(K))throw Error("second arg must be public key");return c.fromHex(K).multiply(u(m)).toRawBytes(C)},sign:function(m,K,C=x){const{seed:S,k2sig:B}=D(m,K,C),P=t;return r3(P.hash.outputLen,P.nByteLength,P.hmac)(S,B)},verify:function(m,K,C,S=I){var _;const B=m;if(K=bt("msgHash",K),C=bt("publicKey",C),"strict"in S)throw Error("options.strict was renamed to lowS");Xo(S);const{lowS:P,prehash:Q}=S;let R,L;try{if(typeof B=="string"||Pr(B))try{R=d.fromDER(B)}catch(z){if(!(z instanceof Ne.Err))throw z;R=d.fromCompact(B)}else{if(typeof B!="object"||typeof B.r!="bigint"||typeof B.s!="bigint")throw Error("PARSE");{const{r:z,s:Y}=B;R=new d(z,Y)}}L=c.fromHex(C)}catch(z){if(z.message==="PARSE")throw Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(P&&R.hasHighS())return!1;Q&&(K=t.hash(K));const{r:q,s:G}=R,M=b(K),F=o(G),T=a(M*F),H=a(q*F),N=(_=c.BASE.multiplyAndAddUnsafe(L,T,H))==null?void 0:_.toAffine();return!!N&&a(N.x)===q},ProjectivePoint:c,Signature:d,utils:w}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function H5(i){return{hash:i,hmac:(t,...e)=>t3(i,t,Yc(...e)),randomBytes:Ta}}function Lr(i,t){const e=r=>O5({...i,...H5(r)});return Object.freeze({...e(t),create:e})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */BigInt(4);const e1=Pe(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),z5=Lr({a:e1.create(BigInt("-3")),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Fp:e1,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},es),on=BigInt(2**32-1),fa=BigInt(32);function c3(i,t=!1){return t?{h:Number(i&on),l:Number(i>>fa&on)}:{h:0|Number(i>>fa&on),l:0|Number(i&on)}}function u3(i,t=!1){let e=new Uint32Array(i.length),r=new Uint32Array(i.length);for(let n=0;n<i.length;n++){const{h:s,l:a}=c3(i[n],t);[e[n],r[n]]=[s,a]}return[e,r]}const h3=(i,t,e)=>i<<e|t>>>32-e,l3=(i,t,e)=>t<<e|i>>>32-e,f3=(i,t,e)=>t<<e-32|i>>>64-e,y3=(i,t,e)=>i<<e-32|t>>>64-e,$={fromBig:c3,split:u3,toBig:(i,t)=>BigInt(i>>>0)<<fa|BigInt(t>>>0),shrSH:(i,t,e)=>i>>>e,shrSL:(i,t,e)=>i<<32-e|t>>>e,rotrSH:(i,t,e)=>i>>>e|t<<32-e,rotrSL:(i,t,e)=>i<<32-e|t>>>e,rotrBH:(i,t,e)=>i<<64-e|t>>>e-32,rotrBL:(i,t,e)=>i>>>e-32|t<<64-e,rotr32H:(i,t)=>t,rotr32L:(i,t)=>i,rotlSH:h3,rotlSL:l3,rotlBH:f3,rotlBL:y3,add:function(i,t,e,r){const n=(t>>>0)+(r>>>0);return{h:i+e+(n/2**32|0)|0,l:0|n}},add3L:(i,t,e)=>(i>>>0)+(t>>>0)+(e>>>0),add3H:(i,t,e,r)=>t+e+r+(i/2**32|0)|0,add4L:(i,t,e,r)=>(i>>>0)+(t>>>0)+(e>>>0)+(r>>>0),add4H:(i,t,e,r,n)=>t+e+r+n+(i/2**32|0)|0,add5H:(i,t,e,r,n,s)=>t+e+r+n+s+(i/2**32|0)|0,add5L:(i,t,e,r,n)=>(i>>>0)+(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)},[G5,q5]=$.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(i=>BigInt(i))),Ze=new Uint32Array(80),We=new Uint32Array(80);class g3 extends $i{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:e,Bh:r,Bl:n,Ch:s,Cl:a,Dh:o,Dl:c,Eh:u,El:h,Fh:f,Fl:y,Gh:g,Gl:A,Hh:d,Hl:w}=this;return[t,e,r,n,s,a,o,c,u,h,f,y,g,A,d,w]}set(t,e,r,n,s,a,o,c,u,h,f,y,g,A,d,w){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|n,this.Ch=0|s,this.Cl=0|a,this.Dh=0|o,this.Dl=0|c,this.Eh=0|u,this.El=0|h,this.Fh=0|f,this.Fl=0|y,this.Gh=0|g,this.Gl=0|A,this.Hh=0|d,this.Hl=0|w}process(t,e){for(let b=0;b<16;b++,e+=4)Ze[b]=t.getUint32(e),We[b]=t.getUint32(e+=4);for(let b=16;b<80;b++){const E=0|Ze[b-15],U=0|We[b-15],D=$.rotrSH(E,U,1)^$.rotrSH(E,U,8)^$.shrSH(E,U,7),x=$.rotrSL(E,U,1)^$.rotrSL(E,U,8)^$.shrSL(E,U,7),I=0|Ze[b-2],m=0|We[b-2],K=$.rotrSH(I,m,19)^$.rotrBH(I,m,61)^$.shrSH(I,m,6),C=$.rotrSL(I,m,19)^$.rotrBL(I,m,61)^$.shrSL(I,m,6),S=$.add4L(x,C,We[b-7],We[b-16]),B=$.add4H(S,D,K,Ze[b-7],Ze[b-16]);Ze[b]=0|B,We[b]=0|S}let{Ah:r,Al:n,Bh:s,Bl:a,Ch:o,Cl:c,Dh:u,Dl:h,Eh:f,El:y,Fh:g,Fl:A,Gh:d,Gl:w,Hh:k,Hl:v}=this;for(let b=0;b<80;b++){const E=$.rotrSH(f,y,14)^$.rotrSH(f,y,18)^$.rotrBH(f,y,41),U=$.rotrSL(f,y,14)^$.rotrSL(f,y,18)^$.rotrBL(f,y,41),D=f&g^~f&d,x=y&A^~y&w,I=$.add5L(v,U,x,q5[b],We[b]),m=$.add5H(I,k,E,D,G5[b],Ze[b]),K=0|I,C=$.rotrSH(r,n,28)^$.rotrBH(r,n,34)^$.rotrBH(r,n,39),S=$.rotrSL(r,n,28)^$.rotrBL(r,n,34)^$.rotrBL(r,n,39),B=r&s^r&o^s&o,P=n&a^n&c^a&c;k=0|d,v=0|w,d=0|g,w=0|A,g=0|f,A=0|y,{h:f,l:y}=$.add(0|u,0|h,0|m,0|K),u=0|o,h=0|c,o=0|s,c=0|a,s=0|r,a=0|n;const Q=$.add3L(K,S,P);r=$.add3H(Q,m,C,B),n=0|Q}({h:r,l:n}=$.add(0|this.Ah,0|this.Al,0|r,0|n)),{h:s,l:a}=$.add(0|this.Bh,0|this.Bl,0|s,0|a),{h:o,l:c}=$.add(0|this.Ch,0|this.Cl,0|o,0|c),{h:u,l:h}=$.add(0|this.Dh,0|this.Dl,0|u,0|h),{h:f,l:y}=$.add(0|this.Eh,0|this.El,0|f,0|y),{h:g,l:A}=$.add(0|this.Fh,0|this.Fl,0|g,0|A),{h:d,l:w}=$.add(0|this.Gh,0|this.Gl,0|d,0|w),{h:k,l:v}=$.add(0|this.Hh,0|this.Hl,0|k,0|v),this.set(r,n,s,a,o,c,u,h,f,y,g,A,d,w,k,v)}roundClean(){Ze.fill(0),We.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class _5 extends g3{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const Oa=De(()=>new g3),Ha=De(()=>new _5),r1=Pe(BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff")),j5=Lr({a:r1.create(BigInt("-3")),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Fp:r1,n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:BigInt(1),lowS:!1},Ha),p3=Pe(BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff")),Or={a:p3.create(BigInt("-3")),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:BigInt(1)},V5=Lr({a:Or.a,b:Or.b,Fp:p3,n:Or.n,Gx:Or.Gx,Gy:Or.Gy,h:Or.h,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},Oa),d3=[],A3=[],w3=[],J5=BigInt(0),wi=BigInt(1),Y5=BigInt(2),Z5=BigInt(7),W5=BigInt(256),$5=BigInt(113);for(let i=0,t=wi,e=1,r=0;i<24;i++){[e,r]=[r,(2*e+3*r)%5],d3.push(2*(5*r+e)),A3.push((i+1)*(i+2)/2%64);let n=J5;for(let s=0;s<7;s++)t=(t<<wi^(t>>Z5)*$5)%W5,t&Y5&&(n^=wi<<(wi<<BigInt(s))-wi);w3.push(n)}const[X5,t2]=u3(w3,!0),i1=(i,t,e)=>e>32?f3(i,t,e):h3(i,t,e),n1=(i,t,e)=>e>32?y3(i,t,e):l3(i,t,e);class is extends Ra{constructor(t,e,r,n=!1,s=24){if(super(),this.blockLen=t,this.suffix=e,this.outputLen=r,this.enableXOF=n,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Mn(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");var a;this.state=new Uint8Array(200),this.state32=(a=this.state,new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4)))}keccak(){_o||jo(this.state32),function(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const c=(o+8)%10,u=(o+2)%10,h=r[u],f=r[u+1],y=i1(h,f,1)^r[c],g=n1(h,f,1)^r[c+1];for(let A=0;A<50;A+=10)t[o+A]^=y,t[o+A+1]^=g}let s=t[2],a=t[3];for(let o=0;o<24;o++){const c=A3[o],u=i1(s,a,c),h=n1(s,a,c),f=d3[o];s=t[f],a=t[f+1],t[f]=u,t[f+1]=h}for(let o=0;o<50;o+=10){for(let c=0;c<10;c++)r[c]=t[o+c];for(let c=0;c<10;c++)t[o+c]^=~r[(c+2)%10]&r[(c+4)%10]}t[0]^=X5[n],t[1]^=t2[n]}r.fill(0)}(this.state32,this.rounds),_o||jo(this.state32),this.posOut=0,this.pos=0}update(t){oi(this);const{blockLen:e,state:r}=this,n=(t=Wi(t)).length;for(let s=0;s<n;){const a=Math.min(e-this.pos,n-s);for(let o=0;o<a;o++)r[this.pos++]^=t[s++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:e,pos:r,blockLen:n}=this;t[r]^=e,128&e&&r===n-1&&this.keccak(),t[n-1]^=128,this.keccak()}writeInto(t){oi(this,!1),Zi(t),this.finish();const e=this.state,{blockLen:r}=this;for(let n=0,s=t.length;n<s;){this.posOut>=r&&this.keccak();const a=Math.min(r-this.posOut,s-n);t.set(e.subarray(this.posOut,this.posOut+a),n),this.posOut+=a,n+=a}return t}xofInto(t){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return Mn(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Vc(t,this),this.finished)throw Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:e,suffix:r,outputLen:n,rounds:s,enableXOF:a}=this;return t||(t=new is(e,r,n,a,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=r,t.outputLen=n,t.enableXOF=a,t.destroyed=this.destroyed,t}}const m3=(i,t,e)=>De(()=>new is(t,i,e)),e2=m3(6,136,32),r2=m3(6,72,64),b3=((i,t,e)=>function(r){const n=(a,o)=>r(o).update(Wi(a)).digest(),s=r({});return n.outputLen=s.outputLen,n.blockLen=s.blockLen,n.create=a=>r(a),n}((r={})=>new is(t,i,r.dkLen===void 0?e:r.dkLen,!0)))(31,136,32),ce=BigInt(0),Ot=BigInt(1),cn=BigInt(2),i2=BigInt(8),n2={zip215:!0};function s2(i){const t=function(S){const B=Na(S);return Rr(S,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...B})}(i),{Fp:e,n:r,prehash:n,hash:s,randomBytes:a,nByteLength:o,h:c}=t,u=cn<<BigInt(8*o)-Ot,h=e.create,f=Pe(t.n,t.nBitLength),y=t.uvRatio||((S,B)=>{try{return{isValid:!0,value:e.sqrt(S*e.inv(B))}}catch{return{isValid:!1,value:ce}}}),g=t.adjustScalarBytes||(S=>S),A=t.domain||((S,B,P)=>{if(Ge("phflag",P),B.length||P)throw Error("Contexts/pre-hash are not supported");return S});function d(S,B){_t("coordinate "+S,B,ce,u)}function w(S){if(!(S instanceof b))throw Error("ExtendedPoint expected")}const k=Gi((S,B)=>{const{ex:P,ey:Q,ez:R}=S,L=S.is0();B==null&&(B=L?i2:e.inv(R));const q=h(P*B),G=h(Q*B),M=h(R*B);if(L)return{x:ce,y:Ot};if(M!==Ot)throw Error("invZ was invalid");return{x:q,y:G}}),v=Gi(S=>{const{a:B,d:P}=t;if(S.is0())throw Error("bad point: ZERO");const{ex:Q,ey:R,ez:L,et:q}=S,G=h(Q*Q),M=h(R*R),F=h(L*L),T=h(F*F),H=h(G*B);if(h(F*h(H+M))!==h(T+h(P*h(G*M))))throw Error("bad point: equation left != right (1)");if(h(Q*R)!==h(L*q))throw Error("bad point: equation left != right (2)");return!0});class b{constructor(B,P,Q,R){this.ex=B,this.ey=P,this.ez=Q,this.et=R,d("x",B),d("y",P),d("z",Q),d("t",R),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(B){if(B instanceof b)throw Error("extended point not allowed");const{x:P,y:Q}=B||{};return d("x",P),d("y",Q),new b(P,Q,Ot,h(P*Q))}static normalizeZ(B){const P=e.invertBatch(B.map(Q=>Q.ez));return B.map((Q,R)=>Q.toAffine(P[R])).map(b.fromAffine)}static msm(B,P){return o3(b,f,B,P)}_setWindowSize(B){D.setWindowSize(this,B)}assertValidity(){v(this)}equals(B){w(B);const{ex:P,ey:Q,ez:R}=this,{ex:L,ey:q,ez:G}=B,M=h(P*G),F=h(L*R),T=h(Q*G),H=h(q*R);return M===F&&T===H}is0(){return this.equals(b.ZERO)}negate(){return new b(h(-this.ex),this.ey,this.ez,h(-this.et))}double(){const{a:B}=t,{ex:P,ey:Q,ez:R}=this,L=h(P*P),q=h(Q*Q),G=h(cn*h(R*R)),M=h(B*L),F=P+Q,T=h(h(F*F)-L-q),H=M+q,N=H-G,_=M-q,z=h(T*N),Y=h(H*_),J=h(T*_),X=h(N*H);return new b(z,Y,X,J)}add(B){w(B);const{a:P,d:Q}=t,{ex:R,ey:L,ez:q,et:G}=this,{ex:M,ey:F,ez:T,et:H}=B;if(P===BigInt(-1)){const li=h((L-R)*(F+M)),Mr=h((L+R)*(F-M)),ns=h(Mr-li);if(ns===ce)return this.double();const qa=h(q*cn*H),_a=h(G*cn*T),ja=_a+qa,Va=Mr+li,Ja=_a-qa,D3=h(ja*ns),P3=h(Va*Ja),x3=h(ja*Ja),Q3=h(ns*Va);return new b(D3,P3,Q3,x3)}const N=h(R*M),_=h(L*F),z=h(G*Q*H),Y=h(q*T),J=h((R+L)*(M+F)-N-_),X=Y-z,W=Y+z,rt=h(_-P*N),st=h(J*X),dt=h(W*rt),wt=h(J*rt),mt=h(X*W);return new b(st,dt,mt,wt)}subtract(B){return this.add(B.negate())}wNAF(B){return D.wNAFCached(this,B,b.normalizeZ)}multiply(B){const P=B;_t("scalar",P,Ot,r);const{p:Q,f:R}=this.wNAF(P);return b.normalizeZ([Q,R])[0]}multiplyUnsafe(B){const P=B;return _t("scalar",P,ce,r),P===ce?U:this.equals(U)||P===Ot?this:this.equals(E)?this.wNAF(P).p:D.unsafeLadder(this,P)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return D.unsafeLadder(this,r).is0()}toAffine(B){return k(this,B)}clearCofactor(){const{h:B}=t;return B===Ot?this:this.multiplyUnsafe(B)}static fromHex(B,P=!1){const{d:Q,a:R}=t,L=e.BYTES;B=bt("pointHex",B,L),Ge("zip215",P);const q=B.slice(),G=B[L-1];q[L-1]=-129&G;const M=lr(q),F=P?u:e.ORDER;_t("pointHex.y",M,ce,F);const T=h(M*M),H=h(T-Ot),N=h(Q*T-R);let{isValid:_,value:z}=y(H,N);if(!_)throw Error("Point.fromHex: invalid y coordinate");const Y=(z&Ot)===Ot,J=!!(128&G);if(!P&&z===ce&&J)throw Error("Point.fromHex: x=0 and x_0=1");return J!==Y&&(z=h(-z)),b.fromAffine({x:z,y:M})}static fromPrivateKey(B){return m(B).point}toRawBytes(){const{x:B,y:P}=this.toAffine(),Q=ui(P,e.BYTES);return Q[Q.length-1]|=B&Ot?128:0,Q}toHex(){return xr(this.toRawBytes())}}b.BASE=new b(t.Gx,t.Gy,Ot,h(t.Gx*t.Gy)),b.ZERO=new b(ce,Ot,Ot,ce);const{BASE:E,ZERO:U}=b,D=a3(b,8*o);function x(S){return pt(S,r)}function I(S){return x(lr(S))}function m(S){const B=o;S=bt("private key",S,B);const P=bt("hashed private key",s(S),2*B),Q=g(P.slice(0,B)),R=P.slice(B,2*B),L=I(Q),q=E.multiply(L),G=q.toRawBytes();return{head:Q,prefix:R,scalar:L,point:q,pointBytes:G}}function K(S=new Uint8Array,...B){const P=Qr(...B);return I(s(A(P,bt("context",S),!!n)))}const C=n2;return E._setWindowSize(8),{CURVE:t,getPublicKey:function(S){return m(S).pointBytes},sign:function(S,B,P={}){S=bt("message",S),n&&(S=n(S));const{prefix:Q,scalar:R,pointBytes:L}=m(B),q=K(P.context,Q,S),G=E.multiply(q).toRawBytes(),M=x(q+K(P.context,G,L,S)*R);return _t("signature.s",M,ce,r),bt("result",Qr(G,ui(M,e.BYTES)),2*o)},verify:function(S,B,P,Q=C){const{context:R,zip215:L}=Q,q=e.BYTES;S=bt("signature",S,2*q),B=bt("message",B),L!==void 0&&Ge("zip215",L),n&&(B=n(B));const G=lr(S.slice(q,2*q));let M,F,T;try{M=b.fromHex(P,L),F=b.fromHex(S.slice(0,q),L),T=E.multiplyUnsafe(G)}catch{return!1}if(!L&&M.isSmallOrder())return!1;const H=K(R,F.toRawBytes(),M.toRawBytes(),B);return F.add(M.multiplyUnsafe(H)).subtract(T).clearCofactor().equals(b.ZERO)},ExtendedPoint:b,utils:{getExtendedPublicKey:m,randomPrivateKey:()=>a(e.BYTES),precompute:(S=8,B=b.BASE)=>(B._setWindowSize(S),B.multiply(BigInt(3)),B)}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Hr=BigInt(0),Ds=BigInt(1);function a2(i){const t=(Rr(e=i,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e}));var e;const{P:r}=t,n=w=>pt(w,r),s=t.montgomeryBits,a=Math.ceil(s/8),o=t.nByteLength,c=t.adjustScalarBytes||(w=>w),u=t.powPminus2||(w=>i3(w,r-BigInt(2),r));function h(w,k,v){const b=n(w*(k-v));return[k=n(k-b),v=n(v+b)]}const f=(t.a-BigInt(2))/BigInt(4);function y(w){return ui(n(w),a)}function g(w,k){const v=function(U){const D=bt("u coordinate",U,a);return o===32&&(D[31]&=127),lr(D)}(k),b=function(U){const D=bt("scalar",U),x=D.length;if(x!==a&&x!==o)throw Error(`Expected ${a} or ${o} bytes, got ${x}`);return lr(c(D))}(w),E=function(U,D){_t("u",U,Hr,r),_t("scalar",D,Hr,r);const x=D,I=U;let m,K=Ds,C=Hr,S=U,B=Ds,P=Hr;for(let R=BigInt(s-1);R>=Hr;R--){const L=x>>R&Ds;P^=L,m=h(P,K,S),K=m[0],S=m[1],m=h(P,C,B),C=m[0],B=m[1],P=L;const q=K+C,G=n(q*q),M=K-C,F=n(M*M),T=G-F,H=S+B,N=n((S-B)*q),_=n(H*M),z=N+_,Y=N-_;S=n(z*z),B=n(I*n(Y*Y)),K=n(G*F),C=n(T*(G+n(f*T)))}m=h(P,K,S),K=m[0],S=m[1],m=h(P,C,B),C=m[0],B=m[1];const Q=u(C);return n(K*Q)}(v,b);if(E===Hr)throw Error("Invalid private or public key received");return y(E)}const A=y(t.Gu);function d(w){return g(w,A)}return{scalarMult:g,scalarMultBase:d,getSharedSecret:(w,k)=>g(w,k),getPublicKey:w=>d(w),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:A}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const o2=De(()=>b3.create({dkLen:114})),qi=(De(()=>b3.create({dkLen:64})),BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439")),c2=BigInt(1),s1=BigInt(2),a1=BigInt(3);BigInt(4);const u2=BigInt(11),h2=BigInt(22),o1=BigInt(44),l2=BigInt(88),f2=BigInt(223);function k3(i){const t=qi,e=i*i*i%t,r=e*e*i%t,n=gt(r,a1,t)*r%t,s=gt(n,a1,t)*r%t,a=gt(s,s1,t)*e%t,o=gt(a,u2,t)*a%t,c=gt(o,h2,t)*o%t,u=gt(c,o1,t)*c%t,h=gt(u,l2,t)*u%t,f=gt(h,o1,t)*c%t,y=gt(f,s1,t)*e%t,g=gt(y,c2,t)*i%t;return gt(g,f2,t)*y%t}function E3(i){return i[0]&=252,i[55]|=128,i[56]=0,i}const v3=Pe(qi,456,!0),y2={a:BigInt(1),d:BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018326358"),Fp:v3,n:BigInt("181709681073901722637330951972001133588410340171829515070372549795146003961539585716195755291692375963310293709091662304773755859649779"),nBitLength:456,h:BigInt(4),Gx:BigInt("224580040295924300187604334099896036246789641632564134246125461686950415467406032909029192869357953282578032075146446173674602635247710"),Gy:BigInt("298819210078481492676017930443930673437544040154080242095928241372331506189835876003536878655418784733982303233503462500531545062832660"),hash:o2,randomBytes:Ta,adjustScalarBytes:E3,domain:(i,t,e)=>{if(t.length>255)throw Error("Context is too big: "+t.length);return Yc(Jc("SigEd448"),new Uint8Array([e?1:0,t.length]),t,i)},uvRatio:function(i,t){const e=qi,r=pt(i*i*t,e),n=pt(r*i,e),s=pt(n*r*t,e),a=pt(n*k3(s),e),o=pt(a*a,e);return{isValid:pt(o*t,e)===i,value:a}}},g2=s2(y2),p2=a2({a:BigInt(156326),montgomeryBits:448,nByteLength:56,P:qi,Gu:BigInt(5),powPminus2:i=>{const t=qi;return pt(gt(k3(i),BigInt(2),t)*i,t)},adjustScalarBytes:E3,randomBytes:Ta});v3.ORDER,BigInt(3),BigInt(4),BigInt(156326),BigInt("39082"),BigInt("78163"),BigInt("98944233647732219769177004876929019128417576295529901074099889598043702116001257856802131563896515373927712232092845883226922417596214"),BigInt("315019913931389607337177038330951043522456072897266928557328499619017160722351061360252776265186336876723201881398623946864393857820716"),BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const c1=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),u1=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),d2=BigInt(1),ya=BigInt(2),h1=(i,t)=>(i+t/ya)/t,ga=Pe(c1,void 0,void 0,{sqrt:function(i){const t=c1,e=BigInt(3),r=BigInt(6),n=BigInt(11),s=BigInt(22),a=BigInt(23),o=BigInt(44),c=BigInt(88),u=i*i*i%t,h=u*u*i%t,f=gt(h,e,t)*h%t,y=gt(f,e,t)*h%t,g=gt(y,ya,t)*u%t,A=gt(g,n,t)*g%t,d=gt(A,s,t)*A%t,w=gt(d,o,t)*d%t,k=gt(w,c,t)*w%t,v=gt(k,o,t)*d%t,b=gt(v,e,t)*h%t,E=gt(b,a,t)*A%t,U=gt(E,r,t)*u%t,D=gt(U,ya,t);if(!ga.eql(ga.sqr(D),i))throw Error("Cannot find square root");return D}}),B3=Lr({a:BigInt(0),b:BigInt(7),Fp:ga,n:u1,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:i=>{const t=u1,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-d2*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=e,a=BigInt("0x100000000000000000000000000000000"),o=h1(s*i,t),c=h1(-r*i,t);let u=pt(i-o*e-c*n,t),h=pt(-o*r-c*s,t);const f=u>a,y=h>a;if(f&&(u=t-u),y&&(h=t-h),u>a||h>a)throw Error("splitScalar: Endomorphism failed, k="+i);return{k1neg:f,k1:u,k2neg:y,k2:h}}}},es);BigInt(0),B3.ProjectivePoint;const l1=Pe(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),A2=Lr({a:l1.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:l1,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},es),f1=Pe(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),w2=Lr({a:f1.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:f1,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},Ha),y1=Pe(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),m2=Lr({a:y1.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:y1,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},Oa),b2=new Map(Object.entries({nistP256:z5,nistP384:j5,nistP521:V5,brainpoolP256r1:A2,brainpoolP384r1:w2,brainpoolP512r1:m2,secp256k1:B3,x448:p2,ed448:g2}));var k2=Object.freeze({__proto__:null,nobleCurves:b2});const mi=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]),$e=new Uint32Array(80);class E2 extends $i{constructor(){super(64,20,8,!1),this.A=0|mi[0],this.B=0|mi[1],this.C=0|mi[2],this.D=0|mi[3],this.E=0|mi[4]}get(){const{A:t,B:e,C:r,D:n,E:s}=this;return[t,e,r,n,s]}set(t,e,r,n,s){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|s}process(t,e){for(let c=0;c<16;c++,e+=4)$e[c]=t.getUint32(e,!1);for(let c=16;c<80;c++)$e[c]=or($e[c-3]^$e[c-8]^$e[c-14]^$e[c-16],1);let{A:r,B:n,C:s,D:a,E:o}=this;for(let c=0;c<80;c++){let u,h;c<20?(u=Zc(n,s,a),h=1518500249):c<40?(u=n^s^a,h=1859775393):c<60?(u=Wc(n,s,a),h=2400959708):(u=n^s^a,h=3395469782);const f=or(r,5)+u+o+h+$e[c]|0;o=a,a=s,s=or(n,30),n=r,r=f}r=r+this.A|0,n=n+this.B|0,s=s+this.C|0,a=a+this.D|0,o=o+this.E|0,this.set(r,n,s,a,o)}roundClean(){$e.fill(0)}destroy(){this.set(0,0,0,0,0),this.buffer.fill(0)}}const v2=De(()=>new E2),B2=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),I3=new Uint8Array(Array(16).fill(0).map((i,t)=>t)),I2=I3.map(i=>(9*i+5)%16);let za=[I3],Ga=[I2];for(let i=0;i<4;i++)for(let t of[za,Ga])t.push(t[i].map(e=>B2[e]));const S3=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(i=>new Uint8Array(i)),S2=za.map((i,t)=>i.map(e=>S3[t][e])),C2=Ga.map((i,t)=>i.map(e=>S3[t][e])),K2=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),U2=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]);function g1(i,t,e,r){return i===0?t^e^r:i===1?t&e|~t&r:i===2?(t|~e)^r:i===3?t&r|e&~r:t^(e|~r)}const un=new Uint32Array(16);class D2 extends $i{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:e,h2:r,h3:n,h4:s}=this;return[t,e,r,n,s]}set(t,e,r,n,s){this.h0=0|t,this.h1=0|e,this.h2=0|r,this.h3=0|n,this.h4=0|s}process(t,e){for(let g=0;g<16;g++,e+=4)un[g]=t.getUint32(e,!0);let r=0|this.h0,n=r,s=0|this.h1,a=s,o=0|this.h2,c=o,u=0|this.h3,h=u,f=0|this.h4,y=f;for(let g=0;g<5;g++){const A=4-g,d=K2[g],w=U2[g],k=za[g],v=Ga[g],b=S2[g],E=C2[g];for(let U=0;U<16;U++){const D=or(r+g1(g,s,o,u)+un[k[U]]+d,b[U])+f|0;r=f,f=u,u=0|or(o,10),o=s,s=D}for(let U=0;U<16;U++){const D=or(n+g1(A,a,c,h)+un[v[U]]+w,E[U])+y|0;n=y,y=h,h=0|or(c,10),c=a,a=D}}this.set(this.h1+o+h|0,this.h2+u+y|0,this.h3+f+n|0,this.h4+r+a|0,this.h0+s+c|0)}roundClean(){un.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const P2=De(()=>new D2),x2=Array.from({length:64},(i,t)=>Math.floor(2**32*Math.abs(Math.sin(t+1)))),p1=(i,t,e)=>i&t^~i&e,hn=new Uint32Array([1732584193,4023233417,2562383102,271733878]),Ps=new Uint32Array(16);class Q2 extends $i{constructor(){super(64,16,8,!0),this.A=0|hn[0],this.B=0|hn[1],this.C=0|hn[2],this.D=0|hn[3]}get(){const{A:t,B:e,C:r,D:n}=this;return[t,e,r,n]}set(t,e,r,n){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n}process(t,e){for(let o=0;o<16;o++,e+=4)Ps[o]=t.getUint32(e,!0);let{A:r,B:n,C:s,D:a}=this;for(let o=0;o<64;o++){let c,u,h;o<16?(c=p1(n,s,a),u=o,h=[7,12,17,22]):o<32?(c=p1(a,n,s),u=(5*o+1)%16,h=[5,9,14,20]):o<48?(c=n^s^a,u=(3*o+5)%16,h=[4,11,16,23]):(c=s^(n|~a),u=7*o%16,h=[6,10,15,21]),c=c+r+x2[o]+Ps[u],r=a,a=s,s=n,n+=or(c,h[o%4])}r=r+this.A|0,n=n+this.B|0,s=s+this.C|0,a=a+this.D|0,this.set(r,n,s,a)}roundClean(){Ps.fill(0)}destroy(){this.set(0,0,0,0),this.buffer.fill(0)}}const R2=new Map(Object.entries({md5:De(()=>new Q2),sha1:v2,sha224:K5,sha256:es,sha384:Ha,sha512:Oa,sha3_256:e2,sha3_512:r2,ripemd160:P2}));var T2=Object.freeze({__proto__:null,nobleHashes:R2});function xs(i,t,e,r,n,s){const a=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],c=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],u=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],h=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],f=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],y=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],g=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];let A,d,w,k,v,b,E,U,D,x,I=0,m=t.length;const K=i.length===32?3:9;U=K===3?e?[0,32,2]:[30,-2,-2]:e?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2],e&&(t=function(B){const P=8-B.length%8;let Q;if(!(P<8)){if(P===8)return B;throw Error("des: invalid padding")}Q=0;const R=new Uint8Array(B.length+P);for(let L=0;L<B.length;L++)R[L]=B[L];for(let L=0;L<P;L++)R[B.length+L]=Q;return R}(t),m=t.length);let C=new Uint8Array(m),S=0;for(;I<m;){for(b=t[I++]<<24|t[I++]<<16|t[I++]<<8|t[I++],E=t[I++]<<24|t[I++]<<16|t[I++]<<8|t[I++],w=252645135&(b>>>4^E),E^=w,b^=w<<4,w=65535&(b>>>16^E),E^=w,b^=w<<16,w=858993459&(E>>>2^b),b^=w,E^=w<<2,w=16711935&(E>>>8^b),b^=w,E^=w<<8,w=1431655765&(b>>>1^E),E^=w,b^=w<<1,b=b<<1|b>>>31,E=E<<1|E>>>31,d=0;d<K;d+=3){for(D=U[d+1],x=U[d+2],A=U[d];A!==D;A+=x)k=E^i[A],v=(E>>>4|E<<28)^i[A+1],w=b,b=E,E=w^(o[k>>>24&63]|u[k>>>16&63]|f[k>>>8&63]|g[63&k]|a[v>>>24&63]|c[v>>>16&63]|h[v>>>8&63]|y[63&v]);w=b,b=E,E=w}b=b>>>1|b<<31,E=E>>>1|E<<31,w=1431655765&(b>>>1^E),E^=w,b^=w<<1,w=16711935&(E>>>8^b),b^=w,E^=w<<8,w=858993459&(E>>>2^b),b^=w,E^=w<<2,w=65535&(b>>>16^E),E^=w,b^=w<<16,w=252645135&(b>>>4^E),E^=w,b^=w<<4,C[S++]=b>>>24,C[S++]=b>>>16&255,C[S++]=b>>>8&255,C[S++]=255&b,C[S++]=E>>>24,C[S++]=E>>>16&255,C[S++]=E>>>8&255,C[S++]=255&E}return e||(C=function(B){let P,Q=null;if(P=0,!Q){for(Q=1;B[B.length-Q]===P;)Q++;Q--}return B.subarray(0,B.length-Q)}(C)),C}function Qs(i){const t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],e=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],r=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],f=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],y=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],g=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],A=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],d=i.length>8?3:1,w=Array(32*d),k=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0];let v,b,E,U=0,D=0;for(let x=0;x<d;x++){let I=i[U++]<<24|i[U++]<<16|i[U++]<<8|i[U++],m=i[U++]<<24|i[U++]<<16|i[U++]<<8|i[U++];E=252645135&(I>>>4^m),m^=E,I^=E<<4,E=65535&(m>>>-16^I),I^=E,m^=E<<-16,E=858993459&(I>>>2^m),m^=E,I^=E<<2,E=65535&(m>>>-16^I),I^=E,m^=E<<-16,E=1431655765&(I>>>1^m),m^=E,I^=E<<1,E=16711935&(m>>>8^I),I^=E,m^=E<<8,E=1431655765&(I>>>1^m),m^=E,I^=E<<1,E=I<<8|m>>>20&240,I=m<<24|m<<8&16711680|m>>>8&65280|m>>>24&240,m=E;for(let K=0;K<16;K++)k[K]?(I=I<<2|I>>>26,m=m<<2|m>>>26):(I=I<<1|I>>>27,m=m<<1|m>>>27),I&=-15,m&=-15,v=t[I>>>28]|e[I>>>24&15]|r[I>>>20&15]|n[I>>>16&15]|s[I>>>12&15]|a[I>>>8&15]|o[I>>>4&15],b=c[m>>>28]|u[m>>>24&15]|h[m>>>20&15]|f[m>>>16&15]|y[m>>>12&15]|g[m>>>8&15]|A[m>>>4&15],E=65535&(b>>>16^v),w[D++]=v^E,w[D++]=b^E<<16}return w}function Ki(i){this.key=[];for(let t=0;t<3;t++)this.key.push(new Uint8Array(i.subarray(8*t,8*t+8)));this.encrypt=function(t){return xs(Qs(this.key[2]),xs(Qs(this.key[1]),xs(Qs(this.key[0]),t,!0),!1),!0)}}function L2(){this.BlockSize=8,this.KeySize=16,this.setKey=function(a){if(this.masking=Array(16),this.rotate=Array(16),this.reset(),a.length!==this.KeySize)throw Error("CAST-128: keys must be 16 bytes");return this.keySchedule(a),!0},this.reset=function(){for(let a=0;a<16;a++)this.masking[a]=0,this.rotate[a]=0},this.getBlockSize=function(){return this.BlockSize},this.encrypt=function(a){const o=Array(a.length);for(let c=0;c<a.length;c+=8){let u,h=a[c]<<24|a[c+1]<<16|a[c+2]<<8|a[c+3],f=a[c+4]<<24|a[c+5]<<16|a[c+6]<<8|a[c+7];u=f,f=h^e(f,this.masking[0],this.rotate[0]),h=u,u=f,f=h^r(f,this.masking[1],this.rotate[1]),h=u,u=f,f=h^n(f,this.masking[2],this.rotate[2]),h=u,u=f,f=h^e(f,this.masking[3],this.rotate[3]),h=u,u=f,f=h^r(f,this.masking[4],this.rotate[4]),h=u,u=f,f=h^n(f,this.masking[5],this.rotate[5]),h=u,u=f,f=h^e(f,this.masking[6],this.rotate[6]),h=u,u=f,f=h^r(f,this.masking[7],this.rotate[7]),h=u,u=f,f=h^n(f,this.masking[8],this.rotate[8]),h=u,u=f,f=h^e(f,this.masking[9],this.rotate[9]),h=u,u=f,f=h^r(f,this.masking[10],this.rotate[10]),h=u,u=f,f=h^n(f,this.masking[11],this.rotate[11]),h=u,u=f,f=h^e(f,this.masking[12],this.rotate[12]),h=u,u=f,f=h^r(f,this.masking[13],this.rotate[13]),h=u,u=f,f=h^n(f,this.masking[14],this.rotate[14]),h=u,u=f,f=h^e(f,this.masking[15],this.rotate[15]),h=u,o[c]=f>>>24&255,o[c+1]=f>>>16&255,o[c+2]=f>>>8&255,o[c+3]=255&f,o[c+4]=h>>>24&255,o[c+5]=h>>>16&255,o[c+6]=h>>>8&255,o[c+7]=255&h}return o},this.decrypt=function(a){const o=Array(a.length);for(let c=0;c<a.length;c+=8){let u,h=a[c]<<24|a[c+1]<<16|a[c+2]<<8|a[c+3],f=a[c+4]<<24|a[c+5]<<16|a[c+6]<<8|a[c+7];u=f,f=h^e(f,this.masking[15],this.rotate[15]),h=u,u=f,f=h^n(f,this.masking[14],this.rotate[14]),h=u,u=f,f=h^r(f,this.masking[13],this.rotate[13]),h=u,u=f,f=h^e(f,this.masking[12],this.rotate[12]),h=u,u=f,f=h^n(f,this.masking[11],this.rotate[11]),h=u,u=f,f=h^r(f,this.masking[10],this.rotate[10]),h=u,u=f,f=h^e(f,this.masking[9],this.rotate[9]),h=u,u=f,f=h^n(f,this.masking[8],this.rotate[8]),h=u,u=f,f=h^r(f,this.masking[7],this.rotate[7]),h=u,u=f,f=h^e(f,this.masking[6],this.rotate[6]),h=u,u=f,f=h^n(f,this.masking[5],this.rotate[5]),h=u,u=f,f=h^r(f,this.masking[4],this.rotate[4]),h=u,u=f,f=h^e(f,this.masking[3],this.rotate[3]),h=u,u=f,f=h^n(f,this.masking[2],this.rotate[2]),h=u,u=f,f=h^r(f,this.masking[1],this.rotate[1]),h=u,u=f,f=h^e(f,this.masking[0],this.rotate[0]),h=u,o[c]=f>>>24&255,o[c+1]=f>>>16&255,o[c+2]=f>>>8&255,o[c+3]=255&f,o[c+4]=h>>>24&255,o[c+5]=h>>16&255,o[c+6]=h>>8&255,o[c+7]=255&h}return o};const i=[,,,,];i[0]=[,,,,],i[0][0]=[4,0,13,15,12,14,8],i[0][1]=[5,2,16,18,17,19,10],i[0][2]=[6,3,23,22,21,20,9],i[0][3]=[7,1,26,25,27,24,11],i[1]=[,,,,],i[1][0]=[0,6,21,23,20,22,16],i[1][1]=[1,4,0,2,1,3,18],i[1][2]=[2,5,7,6,5,4,17],i[1][3]=[3,7,10,9,11,8,19],i[2]=[,,,,],i[2][0]=[4,0,13,15,12,14,8],i[2][1]=[5,2,16,18,17,19,10],i[2][2]=[6,3,23,22,21,20,9],i[2][3]=[7,1,26,25,27,24,11],i[3]=[,,,,],i[3][0]=[0,6,21,23,20,22,16],i[3][1]=[1,4,0,2,1,3,18],i[3][2]=[2,5,7,6,5,4,17],i[3][3]=[3,7,10,9,11,8,19];const t=[,,,,];function e(a,o,c){const u=o+a,h=u<<c|u>>>32-c;return(s[0][h>>>24]^s[1][h>>>16&255])-s[2][h>>>8&255]+s[3][255&h]}function r(a,o,c){const u=o^a,h=u<<c|u>>>32-c;return s[0][h>>>24]-s[1][h>>>16&255]+s[2][h>>>8&255]^s[3][255&h]}function n(a,o,c){const u=o-a,h=u<<c|u>>>32-c;return(s[0][h>>>24]+s[1][h>>>16&255]^s[2][h>>>8&255])-s[3][255&h]}t[0]=[,,,,],t[0][0]=[24,25,23,22,18],t[0][1]=[26,27,21,20,22],t[0][2]=[28,29,19,18,25],t[0][3]=[30,31,17,16,28],t[1]=[,,,,],t[1][0]=[3,2,12,13,8],t[1][1]=[1,0,14,15,13],t[1][2]=[7,6,8,9,3],t[1][3]=[5,4,10,11,7],t[2]=[,,,,],t[2][0]=[19,18,28,29,25],t[2][1]=[17,16,30,31,28],t[2][2]=[23,22,24,25,18],t[2][3]=[21,20,26,27,22],t[3]=[,,,,],t[3][0]=[8,9,7,6,3],t[3][1]=[10,11,5,4,7],t[3][2]=[12,13,3,2,8],t[3][3]=[14,15,1,0,13],this.keySchedule=function(a){const o=[,,,,,,,,],c=Array(32);let u;for(let g=0;g<4;g++)u=4*g,o[g]=a[u]<<24|a[u+1]<<16|a[u+2]<<8|a[u+3];const h=[6,7,4,5];let f,y=0;for(let g=0;g<2;g++)for(let A=0;A<4;A++){for(u=0;u<4;u++){const d=i[A][u];f=o[d[1]],f^=s[4][o[d[2]>>>2]>>>24-8*(3&d[2])&255],f^=s[5][o[d[3]>>>2]>>>24-8*(3&d[3])&255],f^=s[6][o[d[4]>>>2]>>>24-8*(3&d[4])&255],f^=s[7][o[d[5]>>>2]>>>24-8*(3&d[5])&255],f^=s[h[u]][o[d[6]>>>2]>>>24-8*(3&d[6])&255],o[d[0]]=f}for(u=0;u<4;u++){const d=t[A][u];f=s[4][o[d[0]>>>2]>>>24-8*(3&d[0])&255],f^=s[5][o[d[1]>>>2]>>>24-8*(3&d[1])&255],f^=s[6][o[d[2]>>>2]>>>24-8*(3&d[2])&255],f^=s[7][o[d[3]>>>2]>>>24-8*(3&d[3])&255],f^=s[4+u][o[d[4]>>>2]>>>24-8*(3&d[4])&255],c[y]=f,y++}}for(let g=0;g<16;g++)this.masking[g]=c[g],this.rotate[g]=31&c[16+g]};const s=[,,,,,,,,];s[0]=[821772500,2678128395,1810681135,1059425402,505495343,2617265619,1610868032,3483355465,3218386727,2294005173,3791863952,2563806837,1852023008,365126098,3269944861,584384398,677919599,3229601881,4280515016,2002735330,1136869587,3744433750,2289869850,2731719981,2714362070,879511577,1639411079,575934255,717107937,2857637483,576097850,2731753936,1725645e3,2810460463,5111599,767152862,2543075244,1251459544,1383482551,3052681127,3089939183,3612463449,1878520045,1510570527,2189125840,2431448366,582008916,3163445557,1265446783,1354458274,3529918736,3202711853,3073581712,3912963487,3029263377,1275016285,4249207360,2905708351,3304509486,1442611557,3585198765,2712415662,2731849581,3248163920,2283946226,208555832,2766454743,1331405426,1447828783,3315356441,3108627284,2957404670,2981538698,3339933917,1669711173,286233437,1465092821,1782121619,3862771680,710211251,980974943,1651941557,430374111,2051154026,704238805,4128970897,3144820574,2857402727,948965521,3333752299,2227686284,718756367,2269778983,2731643755,718440111,2857816721,3616097120,1113355533,2478022182,410092745,1811985197,1944238868,2696854588,1415722873,1682284203,1060277122,1998114690,1503841958,82706478,2315155686,1068173648,845149890,2167947013,1768146376,1993038550,3566826697,3390574031,940016341,3355073782,2328040721,904371731,1205506512,4094660742,2816623006,825647681,85914773,2857843460,1249926541,1417871568,3287612,3211054559,3126306446,1975924523,1353700161,2814456437,2438597621,1800716203,722146342,2873936343,1151126914,4160483941,2877670899,458611604,2866078500,3483680063,770352098,2652916994,3367839148,3940505011,3585973912,3809620402,718646636,2504206814,2914927912,3631288169,2857486607,2860018678,575749918,2857478043,718488780,2069512688,3548183469,453416197,1106044049,3032691430,52586708,3378514636,3459808877,3211506028,1785789304,218356169,3571399134,3759170522,1194783844,1523787992,3007827094,1975193539,2555452411,1341901877,3045838698,3776907964,3217423946,2802510864,2889438986,1057244207,1636348243,3761863214,1462225785,2632663439,481089165,718503062,24497053,3332243209,3344655856,3655024856,3960371065,1195698900,2971415156,3710176158,2115785917,4027663609,3525578417,2524296189,2745972565,3564906415,1372086093,1452307862,2780501478,1476592880,3389271281,18495466,2378148571,901398090,891748256,3279637769,3157290713,2560960102,1447622437,4284372637,216884176,2086908623,1879786977,3588903153,2242455666,2938092967,3559082096,2810645491,758861177,1121993112,215018983,642190776,4169236812,1196255959,2081185372,3508738393,941322904,4124243163,2877523539,1848581667,2205260958,3180453958,2589345134,3694731276,550028657,2519456284,3789985535,2973870856,2093648313,443148163,46942275,2734146937,1117713533,1115362972,1523183689,3717140224,1551984063],s[1]=[522195092,4010518363,1776537470,960447360,4267822970,4005896314,1435016340,1929119313,2913464185,1310552629,3579470798,3724818106,2579771631,1594623892,417127293,2715217907,2696228731,1508390405,3994398868,3925858569,3695444102,4019471449,3129199795,3770928635,3520741761,990456497,4187484609,2783367035,21106139,3840405339,631373633,3783325702,532942976,396095098,3548038825,4267192484,2564721535,2011709262,2039648873,620404603,3776170075,2898526339,3612357925,4159332703,1645490516,223693667,1567101217,3362177881,1029951347,3470931136,3570957959,1550265121,119497089,972513919,907948164,3840628539,1613718692,3594177948,465323573,2659255085,654439692,2575596212,2699288441,3127702412,277098644,624404830,4100943870,2717858591,546110314,2403699828,3655377447,1321679412,4236791657,1045293279,4010672264,895050893,2319792268,494945126,1914543101,2777056443,3894764339,2219737618,311263384,4275257268,3458730721,669096869,3584475730,3835122877,3319158237,3949359204,2005142349,2713102337,2228954793,3769984788,569394103,3855636576,1425027204,108000370,2736431443,3671869269,3043122623,1750473702,2211081108,762237499,3972989403,2798899386,3061857628,2943854345,867476300,964413654,1591880597,1594774276,2179821409,552026980,3026064248,3726140315,2283577634,3110545105,2152310760,582474363,1582640421,1383256631,2043843868,3322775884,1217180674,463797851,2763038571,480777679,2718707717,2289164131,3118346187,214354409,200212307,3810608407,3025414197,2674075964,3997296425,1847405948,1342460550,510035443,4080271814,815934613,833030224,1620250387,1945732119,2703661145,3966000196,1388869545,3456054182,2687178561,2092620194,562037615,1356438536,3409922145,3261847397,1688467115,2150901366,631725691,3840332284,549916902,3455104640,394546491,837744717,2114462948,751520235,2221554606,2415360136,3999097078,2063029875,803036379,2702586305,821456707,3019566164,360699898,4018502092,3511869016,3677355358,2402471449,812317050,49299192,2570164949,3259169295,2816732080,3331213574,3101303564,2156015656,3705598920,3546263921,143268808,3200304480,1638124008,3165189453,3341807610,578956953,2193977524,3638120073,2333881532,807278310,658237817,2969561766,1641658566,11683945,3086995007,148645947,1138423386,4158756760,1981396783,2401016740,3699783584,380097457,2680394679,2803068651,3334260286,441530178,4016580796,1375954390,761952171,891809099,2183123478,157052462,3683840763,1592404427,341349109,2438483839,1417898363,644327628,2233032776,2353769706,2201510100,220455161,1815641738,182899273,2995019788,3627381533,3702638151,2890684138,1052606899,588164016,1681439879,4038439418,2405343923,4229449282,167996282,1336969661,1688053129,2739224926,1543734051,1046297529,1138201970,2121126012,115334942,1819067631,1902159161,1941945968,2206692869,1159982321],s[2]=[2381300288,637164959,3952098751,3893414151,1197506559,916448331,2350892612,2932787856,3199334847,4009478890,3905886544,1373570990,2450425862,4037870920,3778841987,2456817877,286293407,124026297,3001279700,1028597854,3115296800,4208886496,2691114635,2188540206,1430237888,1218109995,3572471700,308166588,570424558,2187009021,2455094765,307733056,1310360322,3135275007,1384269543,2388071438,863238079,2359263624,2801553128,3380786597,2831162807,1470087780,1728663345,4072488799,1090516929,532123132,2389430977,1132193179,2578464191,3051079243,1670234342,1434557849,2711078940,1241591150,3314043432,3435360113,3091448339,1812415473,2198440252,267246943,796911696,3619716990,38830015,1526438404,2806502096,374413614,2943401790,1489179520,1603809326,1920779204,168801282,260042626,2358705581,1563175598,2397674057,1356499128,2217211040,514611088,2037363785,2186468373,4022173083,2792511869,2913485016,1173701892,4200428547,3896427269,1334932762,2455136706,602925377,2835607854,1613172210,41346230,2499634548,2457437618,2188827595,41386358,4172255629,1313404830,2405527007,3801973774,2217704835,873260488,2528884354,2478092616,4012915883,2555359016,2006953883,2463913485,575479328,2218240648,2099895446,660001756,2341502190,3038761536,3888151779,3848713377,3286851934,1022894237,1620365795,3449594689,1551255054,15374395,3570825345,4249311020,4151111129,3181912732,310226346,1133119310,530038928,136043402,2476768958,3107506709,2544909567,1036173560,2367337196,1681395281,1758231547,3641649032,306774401,1575354324,3716085866,1990386196,3114533736,2455606671,1262092282,3124342505,2768229131,4210529083,1833535011,423410938,660763973,2187129978,1639812e3,3508421329,3467445492,310289298,272797111,2188552562,2456863912,310240523,677093832,1013118031,901835429,3892695601,1116285435,3036471170,1337354835,243122523,520626091,277223598,4244441197,4194248841,1766575121,594173102,316590669,742362309,3536858622,4176435350,3838792410,2501204839,1229605004,3115755532,1552908988,2312334149,979407927,3959474601,1148277331,176638793,3614686272,2083809052,40992502,1340822838,2731552767,3535757508,3560899520,1354035053,122129617,7215240,2732932949,3118912700,2718203926,2539075635,3609230695,3725561661,1928887091,2882293555,1988674909,2063640240,2491088897,1459647954,4189817080,2302804382,1113892351,2237858528,1927010603,4002880361,1856122846,1594404395,2944033133,3855189863,3474975698,1643104450,4054590833,3431086530,1730235576,2984608721,3084664418,2131803598,4178205752,267404349,1617849798,1616132681,1462223176,736725533,2327058232,551665188,2945899023,1749386277,2575514597,1611482493,674206544,2201269090,3642560800,728599968,1680547377,2620414464,1388111496,453204106,4156223445,1094905244,2754698257,2201108165,3757000246,2704524545,3922940700,3996465027],s[3]=[2645754912,532081118,2814278639,3530793624,1246723035,1689095255,2236679235,4194438865,2116582143,3859789411,157234593,2045505824,4245003587,1687664561,4083425123,605965023,672431967,1336064205,3376611392,214114848,4258466608,3232053071,489488601,605322005,3998028058,264917351,1912574028,756637694,436560991,202637054,135989450,85393697,2152923392,3896401662,2895836408,2145855233,3535335007,115294817,3147733898,1922296357,3464822751,4117858305,1037454084,2725193275,2127856640,1417604070,1148013728,1827919605,642362335,2929772533,909348033,1346338451,3547799649,297154785,1917849091,4161712827,2883604526,3968694238,1469521537,3780077382,3375584256,1763717519,136166297,4290970789,1295325189,2134727907,2798151366,1566297257,3672928234,2677174161,2672173615,965822077,2780786062,289653839,1133871874,3491843819,35685304,1068898316,418943774,672553190,642281022,2346158704,1954014401,3037126780,4079815205,2030668546,3840588673,672283427,1776201016,359975446,3750173538,555499703,2769985273,1324923,69110472,152125443,3176785106,3822147285,1340634837,798073664,1434183902,15393959,216384236,1303690150,3881221631,3711134124,3960975413,106373927,2578434224,1455997841,1801814300,1578393881,1854262133,3188178946,3258078583,2302670060,1539295533,3505142565,3078625975,2372746020,549938159,3278284284,2620926080,181285381,2865321098,3970029511,68876850,488006234,1728155692,2608167508,836007927,2435231793,919367643,3339422534,3655756360,1457871481,40520939,1380155135,797931188,234455205,2255801827,3990488299,397000196,739833055,3077865373,2871719860,4022553888,772369276,390177364,3853951029,557662966,740064294,1640166671,1699928825,3535942136,622006121,3625353122,68743880,1742502,219489963,1664179233,1577743084,1236991741,410585305,2366487942,823226535,1050371084,3426619607,3586839478,212779912,4147118561,1819446015,1911218849,530248558,3486241071,3252585495,2886188651,3410272728,2342195030,20547779,2982490058,3032363469,3631753222,312714466,1870521650,1493008054,3491686656,615382978,4103671749,2534517445,1932181,2196105170,278426614,6369430,3274544417,2913018367,697336853,2143000447,2946413531,701099306,1558357093,2805003052,3500818408,2321334417,3567135975,216290473,3591032198,23009561,1996984579,3735042806,2024298078,3739440863,569400510,2339758983,3016033873,3097871343,3639523026,3844324983,3256173865,795471839,2951117563,4101031090,4091603803,3603732598,971261452,534414648,428311343,3389027175,2844869880,694888862,1227866773,2456207019,3043454569,2614353370,3749578031,3676663836,459166190,4132644070,1794958188,51825668,2252611902,3084671440,2036672799,3436641603,1099053433,2469121526,3059204941,1323291266,2061838604,1018778475,2233344254,2553501054,334295216,3556750194,1065731521,183467730],s[4]=[2127105028,745436345,2601412319,2788391185,3093987327,500390133,1155374404,389092991,150729210,3891597772,3523549952,1935325696,716645080,946045387,2901812282,1774124410,3869435775,4039581901,3293136918,3438657920,948246080,363898952,3867875531,1286266623,1598556673,68334250,630723836,1104211938,1312863373,613332731,2377784574,1101634306,441780740,3129959883,1917973735,2510624549,3238456535,2544211978,3308894634,1299840618,4076074851,1756332096,3977027158,297047435,3790297736,2265573040,3621810518,1311375015,1667687725,47300608,3299642885,2474112369,201668394,1468347890,576830978,3594690761,3742605952,1958042578,1747032512,3558991340,1408974056,3366841779,682131401,1033214337,1545599232,4265137049,206503691,103024618,2855227313,1337551222,2428998917,2963842932,4015366655,3852247746,2796956967,3865723491,3747938335,247794022,3755824572,702416469,2434691994,397379957,851939612,2314769512,218229120,1380406772,62274761,214451378,3170103466,2276210409,3845813286,28563499,446592073,1693330814,3453727194,29968656,3093872512,220656637,2470637031,77972100,1667708854,1358280214,4064765667,2395616961,325977563,4277240721,4220025399,3605526484,3355147721,811859167,3069544926,3962126810,652502677,3075892249,4132761541,3498924215,1217549313,3250244479,3858715919,3053989961,1538642152,2279026266,2875879137,574252750,3324769229,2651358713,1758150215,141295887,2719868960,3515574750,4093007735,4194485238,1082055363,3417560400,395511885,2966884026,179534037,3646028556,3738688086,1092926436,2496269142,257381841,3772900718,1636087230,1477059743,2499234752,3811018894,2675660129,3285975680,90732309,1684827095,1150307763,1723134115,3237045386,1769919919,1240018934,815675215,750138730,2239792499,1234303040,1995484674,138143821,675421338,1145607174,1936608440,3238603024,2345230278,2105974004,323969391,779555213,3004902369,2861610098,1017501463,2098600890,2628620304,2940611490,2682542546,1171473753,3656571411,3687208071,4091869518,393037935,159126506,1662887367,1147106178,391545844,3452332695,1891500680,3016609650,1851642611,546529401,1167818917,3194020571,2848076033,3953471836,575554290,475796850,4134673196,450035699,2351251534,844027695,1080539133,86184846,1554234488,3692025454,1972511363,2018339607,1491841390,1141460869,1061690759,4244549243,2008416118,2351104703,2868147542,1598468138,722020353,1027143159,212344630,1387219594,1725294528,3745187956,2500153616,458938280,4129215917,1828119673,544571780,3503225445,2297937496,1241802790,267843827,2694610800,1397140384,1558801448,3782667683,1806446719,929573330,2234912681,400817706,616011623,4121520928,3603768725,1761550015,1968522284,4053731006,4192232858,4005120285,872482584,3140537016,3894607381,2287405443,1963876937,3663887957,1584857e3,2975024454,1833426440,4025083860],s[5]=[4143615901,749497569,1285769319,3795025788,2514159847,23610292,3974978748,844452780,3214870880,3751928557,2213566365,1676510905,448177848,3730751033,4086298418,2307502392,871450977,3222878141,4110862042,3831651966,2735270553,1310974780,2043402188,1218528103,2736035353,4274605013,2702448458,3936360550,2693061421,162023535,2827510090,687910808,23484817,3784910947,3371371616,779677500,3503626546,3473927188,4157212626,3500679282,4248902014,2466621104,3899384794,1958663117,925738300,1283408968,3669349440,1840910019,137959847,2679828185,1239142320,1315376211,1547541505,1690155329,739140458,3128809933,3933172616,3876308834,905091803,1548541325,4040461708,3095483362,144808038,451078856,676114313,2861728291,2469707347,993665471,373509091,2599041286,4025009006,4170239449,2149739950,3275793571,3749616649,2794760199,1534877388,572371878,2590613551,1753320020,3467782511,1405125690,4270405205,633333386,3026356924,3475123903,632057672,2846462855,1404951397,3882875879,3915906424,195638627,2385783745,3902872553,1233155085,3355999740,2380578713,2702246304,2144565621,3663341248,3894384975,2502479241,4248018925,3094885567,1594115437,572884632,3385116731,767645374,1331858858,1475698373,3793881790,3532746431,1321687957,619889600,1121017241,3440213920,2070816767,2833025776,1933951238,4095615791,890643334,3874130214,859025556,360630002,925594799,1764062180,3920222280,4078305929,979562269,2810700344,4087740022,1949714515,546639971,1165388173,3069891591,1495988560,922170659,1291546247,2107952832,1813327274,3406010024,3306028637,4241950635,153207855,2313154747,1608695416,1150242611,1967526857,721801357,1220138373,3691287617,3356069787,2112743302,3281662835,1111556101,1778980689,250857638,2298507990,673216130,2846488510,3207751581,3562756981,3008625920,3417367384,2198807050,529510932,3547516680,3426503187,2364944742,102533054,2294910856,1617093527,1204784762,3066581635,1019391227,1069574518,1317995090,1691889997,3661132003,510022745,3238594800,1362108837,1817929911,2184153760,805817662,1953603311,3699844737,120799444,2118332377,207536705,2282301548,4120041617,145305846,2508124933,3086745533,3261524335,1877257368,2977164480,3160454186,2503252186,4221677074,759945014,254147243,2767453419,3801518371,629083197,2471014217,907280572,3900796746,940896768,2751021123,2625262786,3161476951,3661752313,3260732218,1425318020,2977912069,1496677566,3988592072,2140652971,3126511541,3069632175,977771578,1392695845,1698528874,1411812681,1369733098,1343739227,3620887944,1142123638,67414216,3102056737,3088749194,1626167401,2546293654,3941374235,697522451,33404913,143560186,2595682037,994885535,1247667115,3859094837,2699155541,3547024625,4114935275,2968073508,3199963069,2732024527,1237921620,951448369,1898488916,1211705605,2790989240,2233243581,3598044975],s[6]=[2246066201,858518887,1714274303,3485882003,713916271,2879113490,3730835617,539548191,36158695,1298409750,419087104,1358007170,749914897,2989680476,1261868530,2995193822,2690628854,3443622377,3780124940,3796824509,2976433025,4259637129,1551479e3,512490819,1296650241,951993153,2436689437,2460458047,144139966,3136204276,310820559,3068840729,643875328,1969602020,1680088954,2185813161,3283332454,672358534,198762408,896343282,276269502,3014846926,84060815,197145886,376173866,3943890818,3813173521,3545068822,1316698879,1598252827,2633424951,1233235075,859989710,2358460855,3503838400,3409603720,1203513385,1193654839,2792018475,2060853022,207403770,1144516871,3068631394,1121114134,177607304,3785736302,326409831,1929119770,2983279095,4183308101,3474579288,3200513878,3228482096,119610148,1170376745,3378393471,3163473169,951863017,3337026068,3135789130,2907618374,1183797387,2015970143,4045674555,2182986399,2952138740,3928772205,384012900,2454997643,10178499,2879818989,2596892536,111523738,2995089006,451689641,3196290696,235406569,1441906262,3890558523,3013735005,4158569349,1644036924,376726067,1006849064,3664579700,2041234796,1021632941,1374734338,2566452058,371631263,4007144233,490221539,206551450,3140638584,1053219195,1853335209,3412429660,3562156231,735133835,1623211703,3104214392,2738312436,4096837757,3366392578,3110964274,3956598718,3196820781,2038037254,3877786376,2339753847,300912036,3766732888,2372630639,1516443558,4200396704,1574567987,4069441456,4122592016,2699739776,146372218,2748961456,2043888151,35287437,2596680554,655490400,1132482787,110692520,1031794116,2188192751,1324057718,1217253157,919197030,686247489,3261139658,1028237775,3135486431,3059715558,2460921700,986174950,2661811465,4062904701,2752986992,3709736643,367056889,1353824391,731860949,1650113154,1778481506,784341916,357075625,3608602432,1074092588,2480052770,3811426202,92751289,877911070,3600361838,1231880047,480201094,3756190983,3094495953,434011822,87971354,363687820,1717726236,1901380172,3926403882,2481662265,400339184,1490350766,2661455099,1389319756,2558787174,784598401,1983468483,30828846,3550527752,2716276238,3841122214,1765724805,1955612312,1277890269,1333098070,1564029816,2704417615,1026694237,3287671188,1260819201,3349086767,1016692350,1582273796,1073413053,1995943182,694588404,1025494639,3323872702,3551898420,4146854327,453260480,1316140391,1435673405,3038941953,3486689407,1622062951,403978347,817677117,950059133,4246079218,3278066075,1486738320,1417279718,481875527,2549965225,3933690356,760697757,1452955855,3897451437,1177426808,1702951038,4085348628,2447005172,1084371187,3516436277,3068336338,1073369276,1027665953,3284188590,1230553676,1368340146,2226246512,267243139,2274220762,4070734279,2497715176,2423353163,2504755875],s[7]=[3793104909,3151888380,2817252029,895778965,2005530807,3871412763,237245952,86829237,296341424,3851759377,3974600970,2475086196,709006108,1994621201,2972577594,937287164,3734691505,168608556,3189338153,2225080640,3139713551,3033610191,3025041904,77524477,185966941,1208824168,2344345178,1721625922,3354191921,1066374631,1927223579,1971335949,2483503697,1551748602,2881383779,2856329572,3003241482,48746954,1398218158,2050065058,313056748,4255789917,393167848,1912293076,940740642,3465845460,3091687853,2522601570,2197016661,1727764327,364383054,492521376,1291706479,3264136376,1474851438,1685747964,2575719748,1619776915,1814040067,970743798,1561002147,2925768690,2123093554,1880132620,3151188041,697884420,2550985770,2607674513,2659114323,110200136,1489731079,997519150,1378877361,3527870668,478029773,2766872923,1022481122,431258168,1112503832,897933369,2635587303,669726182,3383752315,918222264,163866573,3246985393,3776823163,114105080,1903216136,761148244,3571337562,1690750982,3166750252,1037045171,1888456500,2010454850,642736655,616092351,365016990,1185228132,4174898510,1043824992,2023083429,2241598885,3863320456,3279669087,3674716684,108438443,2132974366,830746235,606445527,4173263986,2204105912,1844756978,2532684181,4245352700,2969441100,3796921661,1335562986,4061524517,2720232303,2679424040,634407289,885462008,3294724487,3933892248,2094100220,339117932,4048830727,3202280980,1458155303,2689246273,1022871705,2464987878,3714515309,353796843,2822958815,4256850100,4052777845,551748367,618185374,3778635579,4020649912,1904685140,3069366075,2670879810,3407193292,2954511620,4058283405,2219449317,3135758300,1120655984,3447565834,1474845562,3577699062,550456716,3466908712,2043752612,881257467,869518812,2005220179,938474677,3305539448,3850417126,1315485940,3318264702,226533026,965733244,321539988,1136104718,804158748,573969341,3708209826,937399083,3290727049,2901666755,1461057207,4013193437,4066861423,3242773476,2421326174,1581322155,3028952165,786071460,3900391652,3918438532,1485433313,4023619836,3708277595,3678951060,953673138,1467089153,1930354364,1533292819,2492563023,1346121658,1685000834,1965281866,3765933717,4190206607,2052792609,3515332758,690371149,3125873887,2180283551,2903598061,3933952357,436236910,289419410,14314871,1242357089,2904507907,1616633776,2666382180,585885352,3471299210,2699507360,1432659641,277164553,3354103607,770115018,2303809295,3741942315,3177781868,2853364978,2269453327,3774259834,987383833,1290892879,225909803,1741533526,890078084,1496906255,1111072499,916028167,243534141,1252605537,2204162171,531204876,290011180,3916834213,102027703,237315147,209093447,1486785922,220223953,2758195998,4175039106,82940208,3127791296,2569425252,518464269,1353887104,3941492737,2377294467,3935040926]}function Ui(i){this.cast5=new L2,this.cast5.setKey(i),this.encrypt=function(t){return this.cast5.encrypt(t)}}Ki.keySize=Ki.prototype.keySize=24,Ki.blockSize=Ki.prototype.blockSize=8,Ui.blockSize=Ui.prototype.blockSize=8,Ui.keySize=Ui.prototype.keySize=16;const te=4294967295;function pe(i,t){return(i<<t|i>>>32-t)&te}function Te(i,t){return i[t]|i[t+1]<<8|i[t+2]<<16|i[t+3]<<24}function Xe(i,t,e){i.splice(t,4,255&e,e>>>8&255,e>>>16&255,e>>>24&255)}function Z(i,t){return i>>>8*t&255}function Di(i){this.tf=function(){let t=null,e=null,r=-1,n=[],s=[[],[],[],[]];function a(h){return s[0][Z(h,0)]^s[1][Z(h,1)]^s[2][Z(h,2)]^s[3][Z(h,3)]}function o(h){return s[0][Z(h,3)]^s[1][Z(h,0)]^s[2][Z(h,1)]^s[3][Z(h,2)]}function c(h,f){let y=a(f[0]),g=o(f[1]);f[2]=pe(f[2]^y+g+n[4*h+8]&te,31),f[3]=pe(f[3],1)^y+2*g+n[4*h+9]&te,y=a(f[2]),g=o(f[3]),f[0]=pe(f[0]^y+g+n[4*h+10]&te,31),f[1]=pe(f[1],1)^y+2*g+n[4*h+11]&te}function u(h,f){let y=a(f[0]),g=o(f[1]);f[2]=pe(f[2],1)^y+g+n[4*h+10]&te,f[3]=pe(f[3]^y+2*g+n[4*h+11]&te,31),y=a(f[2]),g=o(f[3]),f[0]=pe(f[0],1)^y+g+n[4*h+8]&te,f[1]=pe(f[1]^y+2*g+n[4*h+9]&te,31)}return{name:"twofish",blocksize:16,open:function(h){let f,y,g,A,d;t=h;const w=[],k=[],v=[];let b;const E=[];let U,D,x;const I=[[8,1,7,13,6,15,3,2,0,11,5,9,14,12,10,4],[2,8,11,13,15,7,6,14,3,1,9,4,0,10,12,5]],m=[[14,12,11,8,1,2,3,5,15,4,10,6,7,0,9,13],[1,14,2,11,4,12,3,7,6,13,10,5,15,9,0,8]],K=[[11,10,5,14,6,13,9,0,12,8,15,3,2,4,7,1],[4,12,7,5,1,6,9,10,0,14,13,8,2,11,3,15]],C=[[13,7,15,4,1,2,6,14,9,11,3,0,8,5,12,10],[11,9,5,1,12,3,13,14,6,4,7,15,2,0,8,10]],S=[0,8,1,9,2,10,3,11,4,12,5,13,6,14,7,15],B=[0,9,2,11,4,13,6,15,8,1,10,3,12,5,14,7],P=[[],[]],Q=[[],[],[],[]];function R(F){return F^F>>2^[0,90,180,238][3&F]}function L(F){return F^F>>1^F>>2^[0,238,180,90][3&F]}function q(F,T){let H,N,_;for(H=0;H<8;H++)N=T>>>24,T=T<<8&te|F>>>24,F=F<<8&te,_=N<<1,128&N&&(_^=333),T^=N^_<<16,_^=N>>>1,1&N&&(_^=166),T^=_<<24|_<<8;return T}function G(F,T){const H=T>>4,N=15&T,_=I[F][H^N],z=m[F][S[N]^B[H]];return C[F][S[z]^B[_]]<<4|K[F][_^z]}function M(F,T){let H=Z(F,0),N=Z(F,1),_=Z(F,2),z=Z(F,3);switch(b){case 4:H=P[1][H]^Z(T[3],0),N=P[0][N]^Z(T[3],1),_=P[0][_]^Z(T[3],2),z=P[1][z]^Z(T[3],3);case 3:H=P[1][H]^Z(T[2],0),N=P[1][N]^Z(T[2],1),_=P[0][_]^Z(T[2],2),z=P[0][z]^Z(T[2],3);case 2:H=P[0][P[0][H]^Z(T[1],0)]^Z(T[0],0),N=P[0][P[1][N]^Z(T[1],1)]^Z(T[0],1),_=P[1][P[0][_]^Z(T[1],2)]^Z(T[0],2),z=P[1][P[1][z]^Z(T[1],3)]^Z(T[0],3)}return Q[0][H]^Q[1][N]^Q[2][_]^Q[3][z]}for(t=t.slice(0,32),f=t.length;f!==16&&f!==24&&f!==32;)t[f++]=0;for(f=0;f<t.length;f+=4)v[f>>2]=Te(t,f);for(f=0;f<256;f++)P[0][f]=G(0,f),P[1][f]=G(1,f);for(f=0;f<256;f++)U=P[1][f],D=R(U),x=L(U),Q[0][f]=U+(D<<8)+(x<<16)+(x<<24),Q[2][f]=D+(x<<8)+(U<<16)+(x<<24),U=P[0][f],D=R(U),x=L(U),Q[1][f]=x+(x<<8)+(D<<16)+(U<<24),Q[3][f]=D+(U<<8)+(x<<16)+(D<<24);for(b=v.length/2,f=0;f<b;f++)y=v[f+f],w[f]=y,g=v[f+f+1],k[f]=g,E[b-f-1]=q(y,g);for(f=0;f<40;f+=2)y=16843009*f,g=y+16843009,y=M(y,w),g=pe(M(g,k),8),n[f]=y+g&te,n[f+1]=pe(y+2*g,9);for(f=0;f<256;f++)switch(y=g=A=d=f,b){case 4:y=P[1][y]^Z(E[3],0),g=P[0][g]^Z(E[3],1),A=P[0][A]^Z(E[3],2),d=P[1][d]^Z(E[3],3);case 3:y=P[1][y]^Z(E[2],0),g=P[1][g]^Z(E[2],1),A=P[0][A]^Z(E[2],2),d=P[0][d]^Z(E[2],3);case 2:s[0][f]=Q[0][P[0][P[0][y]^Z(E[1],0)]^Z(E[0],0)],s[1][f]=Q[1][P[0][P[1][g]^Z(E[1],1)]^Z(E[0],1)],s[2][f]=Q[2][P[1][P[0][A]^Z(E[1],2)]^Z(E[0],2)],s[3][f]=Q[3][P[1][P[1][d]^Z(E[1],3)]^Z(E[0],3)]}},close:function(){n=[],s=[[],[],[],[]]},encrypt:function(h,f){e=h,r=f;const y=[Te(e,r)^n[0],Te(e,r+4)^n[1],Te(e,r+8)^n[2],Te(e,r+12)^n[3]];for(let g=0;g<8;g++)c(g,y);return Xe(e,r,y[2]^n[4]),Xe(e,r+4,y[3]^n[5]),Xe(e,r+8,y[0]^n[6]),Xe(e,r+12,y[1]^n[7]),r+=16,e},decrypt:function(h,f){e=h,r=f;const y=[Te(e,r)^n[4],Te(e,r+4)^n[5],Te(e,r+8)^n[6],Te(e,r+12)^n[7]];for(let g=7;g>=0;g--)u(g,y);Xe(e,r,y[2]^n[0]),Xe(e,r+4,y[3]^n[1]),Xe(e,r+8,y[0]^n[2]),Xe(e,r+12,y[1]^n[3]),r+=16},finalize:function(){return e}}}(),this.tf.open(Array.from(i),0),this.encrypt=function(t){return this.tf.encrypt(Array.from(t),0)}}function ue(){}function Pi(i){this.bf=new ue,this.bf.init(i),this.encrypt=function(t){return this.bf.encryptBlock(t)}}Di.keySize=Di.prototype.keySize=32,Di.blockSize=Di.prototype.blockSize=16,ue.prototype.BLOCKSIZE=8,ue.prototype.SBOXES=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]],ue.prototype.PARRAY=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],ue.prototype.NN=16,ue.prototype._clean=function(i){return i<0&&(i=(2147483647&i)+2147483648),i},ue.prototype._F=function(i){let t;const e=255&i,r=255&(i>>>=8),n=255&(i>>>=8),s=255&(i>>>=8);return t=this.sboxes[0][s]+this.sboxes[1][n],t^=this.sboxes[2][r],t+=this.sboxes[3][e],t},ue.prototype._encryptBlock=function(i){let t,e=i[0],r=i[1];for(t=0;t<this.NN;++t){e^=this.parray[t],r=this._F(e)^r;const n=e;e=r,r=n}e^=this.parray[this.NN+0],r^=this.parray[this.NN+1],i[0]=this._clean(r),i[1]=this._clean(e)},ue.prototype.encryptBlock=function(i){let t;const e=[0,0],r=this.BLOCKSIZE/2;for(t=0;t<this.BLOCKSIZE/2;++t)e[0]=e[0]<<8|255&i[t+0],e[1]=e[1]<<8|255&i[t+r];this._encryptBlock(e);const n=[];for(t=0;t<this.BLOCKSIZE/2;++t)n[t+0]=e[0]>>>24-8*t&255,n[t+r]=e[1]>>>24-8*t&255;return n},ue.prototype._decryptBlock=function(i){let t,e=i[0],r=i[1];for(t=this.NN+1;t>1;--t){e^=this.parray[t],r=this._F(e)^r;const n=e;e=r,r=n}e^=this.parray[1],r^=this.parray[0],i[0]=this._clean(r),i[1]=this._clean(e)},ue.prototype.init=function(i){let t,e=0;for(this.parray=[],t=0;t<this.NN+2;++t){let n=0;for(let s=0;s<4;++s)n=n<<8|255&i[e],++e>=i.length&&(e=0);this.parray[t]=this.PARRAY[t]^n}for(this.sboxes=[],t=0;t<4;++t)for(this.sboxes[t]=[],e=0;e<256;++e)this.sboxes[t][e]=this.SBOXES[t][e];const r=[0,0];for(t=0;t<this.NN+2;t+=2)this._encryptBlock(r),this.parray[t+0]=r[0],this.parray[t+1]=r[1];for(t=0;t<4;++t)for(e=0;e<256;e+=2)this._encryptBlock(r),this.sboxes[t][e+0]=r[0],this.sboxes[t][e+1]=r[1]},Pi.keySize=Pi.prototype.keySize=16,Pi.blockSize=Pi.prototype.blockSize=8;const M2=new Map(Object.entries({tripledes:Ki,cast5:Ui,twofish:Di,blowfish:Pi}));var F2=Object.freeze({__proto__:null,legacyCiphers:M2});function zr(i,t,e,r){i[t]+=e[r],i[t+1]+=e[r+1]+(i[t]<e[r])}function d1(i,t){i[0]+=t,i[1]+=i[0]<t}function tr(i,t,e,r,n,s,a,o){zr(i,e,i,r),zr(i,e,t,a);let c=i[s]^i[e],u=i[s+1]^i[e+1];i[s]=u,i[s+1]=c,zr(i,n,i,s),c=i[r]^i[n],u=i[r+1]^i[n+1],i[r]=c>>>24^u<<8,i[r+1]=u>>>24^c<<8,zr(i,e,i,r),zr(i,e,t,o),c=i[s]^i[e],u=i[s+1]^i[e+1],i[s]=c>>>16^u<<16,i[s+1]=u>>>16^c<<16,zr(i,n,i,s),c=i[r]^i[n],u=i[r+1]^i[n+1],i[r]=u>>>31^c<<1,i[r+1]=c>>>31^u<<1}const C3=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Tt=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map(i=>2*i));function A1(i,t){const e=new Uint32Array(32),r=new Uint32Array(i.b.buffer,i.b.byteOffset,32);for(let s=0;s<16;s++)e[s]=i.h[s],e[s+16]=C3[s];e[24]^=i.t0[0],e[25]^=i.t0[1];const n=t?4294967295:0;e[28]^=n,e[29]^=n;for(let s=0;s<12;s++){const a=s<<4;tr(e,r,0,8,16,24,Tt[a+0],Tt[a+1]),tr(e,r,2,10,18,26,Tt[a+2],Tt[a+3]),tr(e,r,4,12,20,28,Tt[a+4],Tt[a+5]),tr(e,r,6,14,22,30,Tt[a+6],Tt[a+7]),tr(e,r,0,10,20,30,Tt[a+8],Tt[a+9]),tr(e,r,2,12,22,24,Tt[a+10],Tt[a+11]),tr(e,r,4,14,16,26,Tt[a+12],Tt[a+13]),tr(e,r,6,8,18,28,Tt[a+14],Tt[a+15])}for(let s=0;s<16;s++)i.h[s]^=e[s]^e[s+16]}class N2{constructor(t,e,r,n){const s=new Uint8Array(64);this.S={b:new Uint8Array(bi),h:new Uint32Array(pa/4),t0:new Uint32Array(2),c:0,outlen:t},s[0]=t,e&&(s[1]=e.length),s[2]=1,s[3]=1,r&&s.set(r,32),n&&s.set(n,48);const a=new Uint32Array(s.buffer,s.byteOffset,s.length/Uint32Array.BYTES_PER_ELEMENT);for(let o=0;o<16;o++)this.S.h[o]=C3[o]^a[o];if(e){const o=new Uint8Array(bi);o.set(e),this.update(o)}}update(t){if(!(t instanceof Uint8Array))throw Error("Input must be Uint8Array or Buffer");let e=0;for(;e<t.length;){this.S.c===bi&&(d1(this.S.t0,this.S.c),A1(this.S,!1),this.S.c=0);let r=bi-this.S.c;this.S.b.set(t.subarray(e,e+r),this.S.c);const n=Math.min(r,t.length-e);this.S.c+=n,e+=n}return this}digest(t){d1(this.S.t0,this.S.c),this.S.b.fill(0,this.S.c),this.S.c=bi,A1(this.S,!0);const e=t||new Uint8Array(this.S.outlen);for(let r=0;r<this.S.outlen;r++)e[r]=this.S.h[r>>2]>>8*(3&r);return this.S.h=null,e.buffer}}function mn(i,t,e,r){if(i>pa)throw Error(`outlen must be at most ${pa} (given: ${i})`);return new N2(i,t,e,r)}const pa=64,bi=128,da=2,w1=19,O2=4294967295,H2=4,z2=4294967295,G2=8,q2=4294967295,_2=8,j2=4294967295,V2=4294967295,J2=32,Le=1024,Y2=64,Z2=new Uint8Array(new Uint16Array([43981]).buffer)[0]===205;function zt(i,t,e){return i[e+0]=t,i[e+1]=t>>8,i[e+2]=t>>16,i[e+3]=t>>24,i}function vr(i,t,e){if(t>Number.MAX_SAFE_INTEGER)throw Error("LE64: large numbers unsupported");let r=t;for(let n=e;n<e+7;n++)i[n]=r,r=(r-i[n])/256;return i}function Rs(i,t,e){const r=new Uint8Array(64),n=new Uint8Array(4+t.length);if(zt(n,i,0),n.set(t,4),i<=64)return mn(i).update(n).digest(e),e;const s=Math.ceil(i/32)-2;for(let o=0;o<s;o++)mn(64).update(o===0?n:r).digest(r),e.set(r.subarray(0,32),32*o);const a=new Uint8Array(mn(i-32*s).update(r).digest());return e.set(a,32*s),e}function m1(i,t,e,r){return i.fn.XOR(t.byteOffset,e.byteOffset,r.byteOffset),t}function W2(i,t,e,r){return i.fn.G(t.byteOffset,e.byteOffset,r.byteOffset,i.refs.gZ.byteOffset),r}function $2(i,t,e,r){return i.fn.G2(t.byteOffset,e.byteOffset,r.byteOffset,i.refs.gZ.byteOffset),r}function*X2(i,t,e,r,n,s,a,o){i.refs.prngTmp.fill(0);const c=i.refs.prngTmp.subarray(0,48);vr(c,t,0),vr(c,e,8),vr(c,r,16),vr(c,n,24),vr(c,s,32),vr(c,da,40);for(let u=1;u<=a;u++){vr(i.refs.prngTmp,u,c.length);const h=$2(i,i.refs.ZERO1024,i.refs.prngTmp,i.refs.prngR);for(let f=u===1?8*o:0;f<h.length;f+=8)yield h.subarray(f,f+8)}return[]}const K3=1024,tu=64*K3;function eu(i,{memory:t,instance:e}){if(!Z2)throw Error("BigEndian system not supported");const r=function({type:m,version:K,tagLength:C,password:S,salt:B,ad:P,secret:Q,parallelism:R,memorySize:L,passes:q}){const G=(M,F,T,H)=>{if(F<T||F>H)throw Error(`${M} size should be between ${T} and ${H} bytes`)};if(m!==da||K!==w1)throw Error("Unsupported type or version");return G("password",S,_2,q2),G("salt",B,G2,z2),G("tag",C,H2,O2),G("memory",L,8*R,j2),P&&G("associated data",P,0,V2),Q&&G("secret",Q,0,J2),{type:m,version:K,tagLength:C,password:S,salt:B,ad:P,secret:Q,lanes:R,memorySize:L,passes:q}}({type:da,version:w1,...i}),{G:n,G2:s,xor:a,getLZ:o}=e.exports,c={},u={};u.G=n,u.G2=s,u.XOR=a;const h=4*r.lanes*Math.floor(r.memorySize/(4*r.lanes)),f=h*Le+10*K3;if(t.buffer.byteLength<f){const m=Math.ceil((f-t.buffer.byteLength)/tu);t.grow(m)}let y=0;c.gZ=new Uint8Array(t.buffer,y,Le),y+=c.gZ.length,c.prngR=new Uint8Array(t.buffer,y,Le),y+=c.prngR.length,c.prngTmp=new Uint8Array(t.buffer,y,Le),y+=c.prngTmp.length,c.ZERO1024=new Uint8Array(t.buffer,y,1024),y+=c.ZERO1024.length;const g=new Uint32Array(t.buffer,y,2);y+=g.length*Uint32Array.BYTES_PER_ELEMENT;const A={fn:u,refs:c},d=new Uint8Array(t.buffer,y,Le);y+=d.length;const w=new Uint8Array(t.buffer,y,r.memorySize*Le),k=new Uint8Array(t.buffer,0,y),v=function(m){const K=mn(Y2),C=new Uint8Array(4),S=new Uint8Array(24);zt(S,m.lanes,0),zt(S,m.tagLength,4),zt(S,m.memorySize,8),zt(S,m.passes,12),zt(S,m.version,16),zt(S,m.type,20);const B=[S];m.password?(B.push(zt(new Uint8Array(4),m.password.length,0)),B.push(m.password)):B.push(C),m.salt?(B.push(zt(new Uint8Array(4),m.salt.length,0)),B.push(m.salt)):B.push(C),m.secret?(B.push(zt(new Uint8Array(4),m.secret.length,0)),B.push(m.secret)):B.push(C),m.ad?(B.push(zt(new Uint8Array(4),m.ad.length,0)),B.push(m.ad)):B.push(C),K.update(function(Q){if(Q.length===1)return Q[0];let R=0;for(let G=0;G<Q.length;G++){if(!(Q[G]instanceof Uint8Array))throw Error("concatArrays: Data must be in the form of a Uint8Array");R+=Q[G].length}const L=new Uint8Array(R);let q=0;return Q.forEach(G=>{L.set(G,q),q+=G.length}),L}(B));const P=K.digest();return new Uint8Array(P)}(r),b=h/r.lanes,E=Array(r.lanes).fill(null).map(()=>Array(b)),U=(m,K)=>(E[m][K]=w.subarray(m*b*1024+1024*K,m*b*1024+1024*K+Le),E[m][K]);for(let m=0;m<r.lanes;m++){const K=new Uint8Array(v.length+8);K.set(v),zt(K,0,v.length),zt(K,m,v.length+4),Rs(Le,K,U(m,0)),zt(K,1,v.length),Rs(Le,K,U(m,1))}const D=b/4;for(let m=0;m<r.passes;m++)for(let K=0;K<4;K++){const C=m===0&&K<=1;for(let S=0;S<r.lanes;S++){let B=K===0&&m===0?2:0;const P=C?X2(A,m,S,K,h,r.passes,D,B):null;for(;B<D;B++){const Q=K*D+B,R=Q>0?E[S][Q-1]:E[S][b-1],L=C?P.next().value:R;o(g.byteOffset,L.byteOffset,S,r.lanes,m,K,B,4,D);const q=g[0],G=g[1];m===0&&U(S,Q),W2(A,R,E[q][G],m>0?d:E[S][Q]),m>0&&m1(A,E[S][Q],d,E[S][Q])}}}const x=E[0][b-1];for(let m=1;m<r.lanes;m++)m1(A,x,x,E[m][b-1]);const I=Rs(r.tagLength,x,new Uint8Array(r.tagLength));return k.fill(0),t.grow(0),I}let ln;async function ru(i,t){const e=new WebAssembly.Memory({initial:1040,maximum:65536}),r=await async function(n,s,a){const o={env:{memory:n}};if(ln===void 0)try{const c=await s(o);return ln=!0,c}catch{ln=!1}return(ln?s:a)(o)}(e,i,t);return n=>eu(n,{instance:r.instance,memory:e})}function b1(i,t,e,r){var n=null,s=Lt.atob(e),a=s.length;n=new Uint8Array(new ArrayBuffer(a));for(var o=0;o<a;o++)n[o]=s.charCodeAt(o);return function(c,u){var h=WebAssembly.instantiate,f=WebAssembly.compile;return u?h(c,u):f(c)}(n,r)}var iu=Object.freeze({__proto__:null,default:async()=>ru(i=>b1(0,0,"AGFzbQEAAAABKwdgBH9/f38AYAABf2AAAGADf39/AGAJf39/f39/f39/AX9gAX8AYAF/AX8CEwEDZW52Bm1lbW9yeQIBkAiAgAQDCgkCAwAABAEFBgEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwACAkcyAAMFZ2V0TFoABBlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAgJc3RhY2tTYXZlAAUMc3RhY2tSZXN0b3JlAAYKc3RhY2tBbGxvYwAHCQcBAEEBCwEACs0gCQMAAQtYAQJ/A0AgACAEQQR0IgNqIAIgA2r9AAQAIAEgA2r9AAQA/VH9CwQAIAAgA0EQciIDaiACIANq/QAEACABIANq/QAEAP1R/QsEACAEQQJqIgRBwABHDQALC7ceAgt7A38DQCADIBFBBHQiD2ogASAPav0ABAAgACAPav0ABAD9USIF/QsEACACIA9qIAX9CwQAIAMgD0EQciIPaiABIA9q/QAEACAAIA9q/QAEAP1RIgX9CwQAIAIgD2ogBf0LBAAgEUECaiIRQcAARw0ACwNAIAMgEEEHdGoiAEEQaiAA/QAEcCAA/QAEMCIFIAD9AAQQIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEUCIG/c4BIAkgCf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAX9USIFQSj9ywEgBUEY/c0B/VAiCCAE/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAEIAT9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAogCf1RIgVBMP3LASAFQRD9zQH9UCIFIAb9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCP1RIgRBAf3LASAEQT/9zQH9UCIMIAD9AARgIAD9AAQgIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIABBQGsiAf0ABAAiB/3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiByAE/VEiBEEo/csBIARBGP3NAf1QIgsgBv3OASALIAv9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAI/VEiBEEw/csBIARBEP3NAf1QIgQgB/3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAL/VEiB0EB/csBIAdBP/3NAf1QIg0gDf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eHyIH/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/VEiC0Eg/csBIAtBIP3NAf1QIgsgCP3OASALIAv9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAH/VEiB0Eo/csBIAdBGP3NAf1QIgcgCv3OASAHIAf9DQABAgMICQoLAAECAwgJCgsgCiAK/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiDv0LBAAgACAGIA0gDCAM/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgr9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgYgBSAEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USIFQSD9ywEgBUEg/c0B/VAiBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAr9USIEQSj9ywEgBEEY/c0B/VAiCiAG/c4BIAogCv0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAQgBf1RIgVBMP3LASAFQRD9zQH9UCIFIA4gC/1RIgRBMP3LASAEQRD9zQH9UCIEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRgIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRwIAEgBCAI/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAUgCf3OASAFIAX9DQABAgMICQoLAAECAwgJCgsgCSAJ/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCf0LBFAgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEICAAIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEMCAQQQFqIhBBCEcNAAtBACEQA0AgAyAQQQR0aiIAQYABaiAA/QAEgAcgAP0ABIADIgUgAP0ABIABIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEgAUiBv3OASAJIAn9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAF/VEiBUEo/csBIAVBGP3NAf1QIgggBP3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgBCAE/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCiAKIAn9USIFQTD9ywEgBUEQ/c0B/VAiBSAG/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAj9USIEQQH9ywEgBEE//c0B/VAiDCAA/QAEgAYgAP0ABIACIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIAD9AASABCIH/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIHIAT9USIEQSj9ywEgBEEY/c0B/VAiCyAG/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAj9USIEQTD9ywEgBEEQ/c0B/VAiBCAH/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAv9USIHQQH9ywEgB0E//c0B/VAiDSAN/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgf9zgEgByAH/Q0AAQIDCAkKCwABAgMICQoLIAogCv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgogBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USILQSD9ywEgC0Eg/c0B/VAiCyAI/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAf9USIHQSj9ywEgB0EY/c0B/VAiByAK/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIO/QsEACAAIAYgDSAMIAz9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh8iCv3OASAKIAr9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAFIAQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/1RIgVBIP3LASAFQSD9zQH9UCIFIAn9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAkgCf0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCv1RIgRBKP3LASAEQRj9zQH9UCIKIAb9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9CwQAIAAgBCAF/VEiBUEw/csBIAVBEP3NAf1QIgUgDiAL/VEiBEEw/csBIARBEP3NAf1QIgQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIAGIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwSAByAAIAQgCP3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBP0LBIAEIAAgBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJ/QsEgAUgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEgAIgACAEIAUgBf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIADIBBBAWoiEEEIRw0AC0EAIRADQCACIBBBBHQiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACACIABBEHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBIHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBMHIiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACAQQQRqIhBBwABHDQALCxYAIAAgASACIAMQAiAAIAIgAiADEAILewIBfwF+IAIhCSABNQIAIQogBCAFcgRAIAEoAgQgA3AhCQsgACAJNgIAIAAgB0EBayAFIAQbIAhsIAZBAWtBAEF/IAYbIAIgCUYbaiIBIAVBAWogCGxBACAEG2ogAa0gCiAKfkIgiH5CIIinQX9zaiAHIAhscDYCBCAACwQAIwALBgAgACQACxAAIwAgAGtBcHEiACQAIAALBQBBgAgL",i),i=>b1(0,0,"AGFzbQEAAAABPwhgBH9/f38AYAABf2AAAGADf39/AGARf39/f39/f39/f39/f39/f38AYAl/f39/f39/f38Bf2ABfwBgAX8BfwITAQNlbnYGbWVtb3J5AgGQCICABAMLCgIDBAAABQEGBwEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwADAkcyAAQFZ2V0TFoABRlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAkJc3RhY2tTYXZlAAYMc3RhY2tSZXN0b3JlAAcKc3RhY2tBbGxvYwAICQcBAEEBCwEACssaCgMAAQtQAQJ/A0AgACAEQQN0IgNqIAIgA2opAwAgASADaikDAIU3AwAgACADQQhyIgNqIAIgA2opAwAgASADaikDAIU3AwAgBEECaiIEQYABRw0ACwveDwICfgF/IAAgAUEDdGoiEyATKQMAIhEgACAFQQN0aiIBKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA1BA3RqIgUgESAFKQMAhUIgiSIRNwMAIAAgCUEDdGoiCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIoiSIRNwMAIBMgESATKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAFIBEgBSkDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgASARIAEpAwCFQgGJNwMAIAAgAkEDdGoiDSANKQMAIhEgACAGQQN0aiICKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA5BA3RqIgYgESAGKQMAhUIgiSIRNwMAIAAgCkEDdGoiCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIoiSIRNwMAIA0gESANKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAKIBEgCikDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAiARIAIpAwCFQgGJNwMAIAAgA0EDdGoiDiAOKQMAIhEgACAHQQN0aiIDKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA9BA3RqIgcgESAHKQMAhUIgiSIRNwMAIAAgC0EDdGoiCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAMgESADKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAHIBEgBykDAIVCMIkiETcDACALIBEgCykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQgGJNwMAIAAgBEEDdGoiDyAPKQMAIhEgACAIQQN0aiIEKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIBBBA3RqIgggESAIKQMAhUIgiSIRNwMAIAAgDEEDdGoiACARIAApAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA8gESAPKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAIIBEgCCkDAIVCMIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIBMgEykDACIRIAIpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAggESAIKQMAhUIgiSIRNwMAIAsgESALKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACACIBEgAikDAIVCKIkiETcDACATIBEgEykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgCCARIAgpAwCFQjCJIhE3AwAgCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIBiTcDACANIA0pAwAiESADKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAFIBEgBSkDAIVCIIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQiiJIhE3AwAgDSARIA0pAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAUgESAFKQMAhUIwiSIRNwMAIAAgESAAKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACADIBEgAykDAIVCAYk3AwAgDiAOKQMAIhEgBCkDACISfCARQgGGQv7///8fgyASQv////8Pg358IhE3AwAgBiARIAYpAwCFQiCJIhE3AwAgCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIA8gDykDACIRIAEpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAcgESAHKQMAhUIgiSIRNwMAIAogESAKKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACABIBEgASkDAIVCKIkiETcDACAPIBEgDykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgByARIAcpAwCFQjCJIhE3AwAgCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIBiTcDAAvdCAEPfwNAIAIgBUEDdCIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAIgBkEIciIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAVBAmoiBUGAAUcNAAsDQCADIARBA3QiAGogACACaikDADcDACADIARBAXIiAEEDdCIBaiABIAJqKQMANwMAIAMgBEECciIBQQN0IgVqIAIgBWopAwA3AwAgAyAEQQNyIgVBA3QiBmogAiAGaikDADcDACADIARBBHIiBkEDdCIHaiACIAdqKQMANwMAIAMgBEEFciIHQQN0IghqIAIgCGopAwA3AwAgAyAEQQZyIghBA3QiCWogAiAJaikDADcDACADIARBB3IiCUEDdCIKaiACIApqKQMANwMAIAMgBEEIciIKQQN0IgtqIAIgC2opAwA3AwAgAyAEQQlyIgtBA3QiDGogAiAMaikDADcDACADIARBCnIiDEEDdCINaiACIA1qKQMANwMAIAMgBEELciINQQN0Ig5qIAIgDmopAwA3AwAgAyAEQQxyIg5BA3QiD2ogAiAPaikDADcDACADIARBDXIiD0EDdCIQaiACIBBqKQMANwMAIAMgBEEOciIQQQN0IhFqIAIgEWopAwA3AwAgAyAEQQ9yIhFBA3QiEmogAiASaikDADcDACADIARB//8DcSAAQf//A3EgAUH//wNxIAVB//8DcSAGQf//A3EgB0H//wNxIAhB//8DcSAJQf//A3EgCkH//wNxIAtB//8DcSAMQf//A3EgDUH//wNxIA5B//8DcSAPQf//A3EgEEH//wNxIBFB//8DcRACIARB8ABJIQAgBEEQaiEEIAANAAtBACEBIANBAEEBQRBBEUEgQSFBMEExQcAAQcEAQdAAQdEAQeAAQeEAQfAAQfEAEAIgA0ECQQNBEkETQSJBI0EyQTNBwgBBwwBB0gBB0wBB4gBB4wBB8gBB8wAQAiADQQRBBUEUQRVBJEElQTRBNUHEAEHFAEHUAEHVAEHkAEHlAEH0AEH1ABACIANBBkEHQRZBF0EmQSdBNkE3QcYAQccAQdYAQdcAQeYAQecAQfYAQfcAEAIgA0EIQQlBGEEZQShBKUE4QTlByABByQBB2ABB2QBB6ABB6QBB+ABB+QAQAiADQQpBC0EaQRtBKkErQTpBO0HKAEHLAEHaAEHbAEHqAEHrAEH6AEH7ABACIANBDEENQRxBHUEsQS1BPEE9QcwAQc0AQdwAQd0AQewAQe0AQfwAQf0AEAIgA0EOQQ9BHkEfQS5BL0E+QT9BzgBBzwBB3gBB3wBB7gBB7wBB/gBB/wAQAgNAIAIgAUEDdCIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAiAAQQhyIgRqIgUgAyAEaikDACAFKQMAhTcDACACIABBEHIiBGoiBSADIARqKQMAIAUpAwCFNwMAIAIgAEEYciIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAUEEaiIBQYABRw0ACwsWACAAIAEgAiADEAMgACACIAIgAxADC3sCAX8BfiACIQkgATUCACEKIAQgBXIEQCABKAIEIANwIQkLIAAgCTYCACAAIAdBAWsgBSAEGyAIbCAGQQFrQQBBfyAGGyACIAlGG2oiASAFQQFqIAhsQQAgBBtqIAGtIAogCn5CIIh+QiCIp0F/c2ogByAIbHA2AgQgAAsEACMACwYAIAAkAAsQACMAIABrQXBxIgAkACAACwUAQYAICw==",i))}),k1=[0,1,3,7,15,31,63,127,255],xi=function(i){this.stream=i,this.bitOffset=0,this.curByte=0,this.hasByte=!1};xi.prototype._ensureByte=function(){this.hasByte||(this.curByte=this.stream.readByte(),this.hasByte=!0)},xi.prototype.read=function(i){for(var t=0;i>0;){this._ensureByte();var e=8-this.bitOffset;if(i>=e)t<<=e,t|=k1[e]&this.curByte,this.hasByte=!1,this.bitOffset=0,i-=e;else{t<<=i;var r=e-i;t|=(this.curByte&k1[i]<<r)>>r,this.bitOffset+=i,i=0}}return t},xi.prototype.seek=function(i){var t=i%8,e=(i-t)/8;this.bitOffset=t,this.stream.seek(e),this.hasByte=!1},xi.prototype.pi=function(){var i,t=new Uint8Array(6);for(i=0;i<t.length;i++)t[i]=this.read(8);return function(e){return Array.prototype.map.call(e,r=>("00"+r.toString(16)).slice(-2)).join("")}(t)};var nu=xi,Br=function(){};Br.prototype.readByte=function(){throw Error("abstract method readByte() not implemented")},Br.prototype.read=function(i,t,e){for(var r=0;r<e;){var n=this.readByte();if(n<0)return r===0?-1:r;i[t++]=n,r++}return r},Br.prototype.seek=function(i){throw Error("abstract method seek() not implemented")},Br.prototype.writeByte=function(i){throw Error("abstract method readByte() not implemented")},Br.prototype.write=function(i,t,e){var r;for(r=0;r<e;r++)this.writeByte(i[t++]);return e},Br.prototype.flush=function(){};var Ts,su=Br,au=(Ts=new Uint32Array([0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188]),function(){var i=4294967295;this.getCRC=function(){return~i>>>0},this.updateCRC=function(t){i=i<<8^Ts[255&(i>>>24^t)]},this.updateCRCRun=function(t,e){for(;e-- >0;)i=i<<8^Ts[255&(i>>>24^t)]}}),ou=nu,Ti=su,U3=au,E1=function(i,t){var e,r=i[t];for(e=t;e>0;e--)i[e]=i[e-1];return i[0]=r,r},lt={OK:0,LAST_BLOCK:-1,NOT_BZIP_DATA:-2,UNEXPECTED_INPUT_EOF:-3,UNEXPECTED_OUTPUT_EOF:-4,DATA_ERROR:-5,OUT_OF_MEMORY:-6,OBSOLETE_INPUT:-7,END_OF_BLOCK:-8},er={};er[lt.LAST_BLOCK]="Bad file checksum",er[lt.NOT_BZIP_DATA]="Not bzip data",er[lt.UNEXPECTED_INPUT_EOF]="Unexpected input EOF",er[lt.UNEXPECTED_OUTPUT_EOF]="Unexpected output EOF",er[lt.DATA_ERROR]="Data error",er[lt.OUT_OF_MEMORY]="Out of memory",er[lt.OBSOLETE_INPUT]="Obsolete (pre 0.9.5) bzip format not supported.";var Pt=function(i,t){var e=er[i]||"unknown error";t&&(e+=": "+t);var r=new TypeError(e);throw r.errorCode=i,r},cr=function(i,t){this.writePos=this.writeCurrent=this.writeCount=0,this._start_bunzip(i,t)};cr.prototype._init_block=function(){return this._get_next_block()?(this.blockCRC=new U3,!0):(this.writeCount=-1,!1)},cr.prototype._start_bunzip=function(i,t){var e=new Uint8Array(4);i.read(e,0,4)===4&&String.fromCharCode(e[0],e[1],e[2])==="BZh"||Pt(lt.NOT_BZIP_DATA,"bad magic");var r=e[3]-48;(r<1||r>9)&&Pt(lt.NOT_BZIP_DATA,"level out of range"),this.reader=new ou(i),this.dbufSize=1e5*r,this.nextoutput=0,this.outputStream=t,this.streamCRC=0},cr.prototype._get_next_block=function(){var i,t,e,r=this.reader,n=r.pi();if(n==="177245385090")return!1;n!=="314159265359"&&Pt(lt.NOT_BZIP_DATA),this.targetBlockCRC=r.read(32)>>>0,this.streamCRC=(this.targetBlockCRC^(this.streamCRC<<1|this.streamCRC>>>31))>>>0,r.read(1)&&Pt(lt.OBSOLETE_INPUT);var s=r.read(24);s>this.dbufSize&&Pt(lt.DATA_ERROR,"initial position out of bounds");var a=r.read(16),o=new Uint8Array(256),c=0;for(i=0;i<16;i++)if(a&1<<15-i){var u=16*i;for(e=r.read(16),t=0;t<16;t++)e&1<<15-t&&(o[c++]=u+t)}var h=r.read(3);(h<2||h>6)&&Pt(lt.DATA_ERROR);var f=r.read(15);f===0&&Pt(lt.DATA_ERROR);var y=new Uint8Array(256);for(i=0;i<h;i++)y[i]=i;var g=new Uint8Array(f);for(i=0;i<f;i++){for(t=0;r.read(1);t++)t>=h&&Pt(lt.DATA_ERROR);g[i]=E1(y,t)}var A,d=c+2,w=[];for(t=0;t<h;t++){var k,v,b=new Uint8Array(d),E=new Uint16Array(21);for(a=r.read(5),i=0;i<d;i++){for(;(a<1||a>20)&&Pt(lt.DATA_ERROR),r.read(1);)r.read(1)?a--:a++;b[i]=a}for(k=v=b[0],i=1;i<d;i++)b[i]>v?v=b[i]:b[i]<k&&(k=b[i]);A={},w.push(A),A.permute=new Uint16Array(258),A.limit=new Uint32Array(22),A.base=new Uint32Array(21),A.minLen=k,A.maxLen=v;var U=0;for(i=k;i<=v;i++)for(E[i]=A.limit[i]=0,a=0;a<d;a++)b[a]===i&&(A.permute[U++]=a);for(i=0;i<d;i++)E[b[i]]++;for(U=a=0,i=k;i<v;i++)U+=E[i],A.limit[i]=U-1,U<<=1,a+=E[i],A.base[i+1]=U-a;A.limit[v+1]=Number.MAX_VALUE,A.limit[v]=U+E[v]-1,A.base[k]=0}var D=new Uint32Array(256);for(i=0;i<256;i++)y[i]=i;var x,I=0,m=0,K=0,C=this.dbuf=new Uint32Array(this.dbufSize);for(d=0;;){for(d--||(d=49,K>=f&&Pt(lt.DATA_ERROR),A=w[g[K++]]),i=A.minLen,t=r.read(i);i>A.maxLen&&Pt(lt.DATA_ERROR),!(t<=A.limit[i]);i++)t=t<<1|r.read(1);((t-=A.base[i])<0||t>=258)&&Pt(lt.DATA_ERROR);var S=A.permute[t];if(S!==0&&S!==1){if(I)for(I=0,m+a>this.dbufSize&&Pt(lt.DATA_ERROR),D[x=o[y[0]]]+=a;a--;)C[m++]=x;if(S>c)break;m>=this.dbufSize&&Pt(lt.DATA_ERROR),D[x=o[x=E1(y,i=S-1)]]++,C[m++]=x}else I||(I=1,a=0),a+=S===0?I:2*I,I<<=1}for((s<0||s>=m)&&Pt(lt.DATA_ERROR),t=0,i=0;i<256;i++)e=t+D[i],D[i]=t,t=e;for(i=0;i<m;i++)C[D[x=255&C[i]]]|=i<<8,D[x]++;var B=0,P=0,Q=0;return m&&(P=255&(B=C[s]),B>>=8,Q=-1),this.writePos=B,this.writeCurrent=P,this.writeCount=m,this.writeRun=Q,!0},cr.prototype._read_bunzip=function(i,t){var e,r,n;if(this.writeCount<0)return 0;var s=this.dbuf,a=this.writePos,o=this.writeCurrent,c=this.writeCount;this.outputsize;for(var u=this.writeRun;c;){for(c--,r=o,o=255&(a=s[a]),a>>=8,u++==3?(e=o,n=r,o=-1):(e=1,n=o),this.blockCRC.updateCRCRun(n,e);e--;)this.outputStream.writeByte(n),this.nextoutput++;o!=r&&(u=0)}return this.writeCount=c,this.blockCRC.getCRC()!==this.targetBlockCRC&&Pt(lt.DATA_ERROR,"Bad block CRC (got "+this.blockCRC.getCRC().toString(16)+" expected "+this.targetBlockCRC.toString(16)+")"),this.nextoutput};var Ls=function(i){if("readByte"in i)return i;var t=new Ti;return t.pos=0,t.readByte=function(){return i[this.pos++]},t.seek=function(e){this.pos=e},t.eof=function(){return this.pos>=i.length},t},v1=function(i){var t=new Ti,e=!0;if(i)if(typeof i=="number")t.buffer=new Uint8Array(i),e=!1;else{if("writeByte"in i)return i;t.buffer=i,e=!1}else t.buffer=new Uint8Array(16384);return t.pos=0,t.writeByte=function(r){if(e&&this.pos>=this.buffer.length){var n=new Uint8Array(2*this.buffer.length);n.set(this.buffer),this.buffer=n}this.buffer[this.pos++]=r},t.getBuffer=function(){if(this.pos!==this.buffer.length){if(!e)throw new TypeError("outputsize does not match decoded input");var r=new Uint8Array(this.pos);r.set(this.buffer.subarray(0,this.pos)),this.buffer=r}return this.buffer},t._coerced=!0,t},cu={Bunzip:cr,Stream:Ti,Err:lt,decode:function(i,t,e){for(var r=Ls(i),n=v1(t),s=new cr(r,n);!("eof"in r)||!r.eof();)if(s._init_block())s._read_bunzip();else{var a=s.reader.read(32)>>>0;if(a!==s.streamCRC&&Pt(lt.DATA_ERROR,"Bad stream CRC (got "+s.streamCRC.toString(16)+" expected "+a.toString(16)+")"),!e||!("eof"in r)||r.eof())break;s._start_bunzip(r,n)}if("getBuffer"in n)return n.getBuffer()},decodeBlock:function(i,t,e){var r=Ls(i),n=v1(e),s=new cr(r,n);if(s.reader.seek(t),s._get_next_block()&&(s.blockCRC=new U3,s.writeCopies=0,s._read_bunzip()),"getBuffer"in n)return n.getBuffer()},table:function(i,t,e){var r=new Ti;r.delegate=Ls(i),r.pos=0,r.readByte=function(){return this.pos++,this.delegate.readByte()},r.delegate.eof&&(r.eof=r.delegate.eof.bind(r.delegate));var n=new Ti;n.pos=0,n.writeByte=function(){this.pos++};for(var s=new cr(r,n),a=s.dbufSize;!("eof"in r)||!r.eof();){var o=8*r.pos+s.reader.bitOffset;if(s.reader.hasByte&&(o-=8),s._init_block()){var c=n.pos;s._read_bunzip(),t(o,n.pos-c)}else{if(s.reader.read(32),!e||!("eof"in r)||r.eof())break;s._start_bunzip(r,n),console.assert(s.dbufSize===a,"shouldn't change block size within multistream file")}}}},uu=R3({__proto__:null},[cu]);const hu=async(i,t)=>{const{privateKey:e,publicKey:r,revocationCertificate:n}=await b5({type:"curve25519",userIDs:[{email:i}],passphrase:t});return{privateKey:e,publicKey:r,revocationCertificate:n,fingerprint:"TO IMPLEMENT"}},lu=async(i,t)=>{const e=await zc({armoredKey:t});return await qc({message:await Gc({text:i}),encryptionKeys:e})},fu=async(i,t,e)=>{const r=await m5({armoredMessage:i}),n=await k5({privateKey:await p5({armoredKey:t}),passphrase:e}),{data:s,signatures:a}=await E5({message:r,decryptionKeys:n});return{decrypted_message:s,signatures:a}},yu=async(i,t)=>{const e=await zc({armoredKey:t});return await qc({message:await Gc({binary:i}),encryptionKeys:e})};export{lu as a,fu as b,yu as e,hu as g};
